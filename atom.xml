<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[@znz blog]]></title>
  <link href="http://blog.n-z.jp/atom.xml" rel="self"/>
  <link href="http://blog.n-z.jp/"/>
  <updated>2014-05-04T21:27:47+09:00</updated>
  <id>http://blog.n-z.jp/</id>
  <author>
    <name><![CDATA[Kazuhiro NISHIYAMA]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[LILO ï¼† æ±æµ·é“ã‚‰ãã®ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ã—ã¾ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-05-03-lilo-event.html"/>
    <updated>2014-05-03T23:00:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/lilo-event</id>
    <content type="html"><![CDATA[<p><a href="http://lilo.doorkeeper.jp/events/10790">LILO ï¼† æ±æµ·é“ã‚‰ããƒ»ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆ2014/05/03ï¼‰</a> ã«å‚åŠ ã—ã¾ã—ãŸã€‚</p>

<p>ã‚¢ãƒ³ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å½¢å¼ã§ç™ºè¡¨ã—ãŸã„äººãŒé †ç•ªã«å‰ã«å‡ºã¦è©±ã‚’ã™ã‚‹ã¨ã„ã†å½¢å¼ã§ã—ãŸã€‚</p>

<!--more-->


<h2>å†…å®¹</h2>

<p>å¤§éƒ¨åˆ†ã¯è³‡æ–™ã‚’ç”¨æ„ã—ã¦ã®ç™ºè¡¨ã¨ã„ã†å½¢å¼ã§ã¯ãªãã¦ã€
ç™ºè¡¨ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚‚ã¡ã‚ƒã‚“ã¨ã‚ã‚‹ã‚ã‘ã§ã¯ãªã‹ã£ãŸã®ã§ã€
å¤§é›‘æŠŠã«ã“ã†ã„ã†è©±ã§ã—ãŸã¨ã„ã†ãƒ¡ãƒ¢ã ã‘ã§ã™ã€‚</p>

<ul>
<li>è‡ªå·±ç´¹ä»‹1</li>
<li>ã—ã¾ã ã•ã‚“ã®æ±æµ·é“ã‚‰ãã®ç´¹ä»‹</li>
<li>è‡ªåˆ†ã® <code>libpam-google-authenticator</code> ã®è©±</li>
<li>è‡ªå·±ç´¹ä»‹2 (å¾Œã‹ã‚‰æ¥ãŸäººã®è‡ªå·±ç´¹ä»‹)</li>
<li>ãˆã®ãã•ã‚“ã® LibreOffice ã® QA ãªã©ã®ç›¸è«‡ (ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³)</li>
<li>ã•ã¨ã†ã•ã‚“ã® Raspberry Pi ã®è©±</li>
<li>çŸ¢å¹ã•ã‚“ã® LXC ãªã©ã®è©±</li>
<li>è‡ªå·±ç´¹ä»‹3 (ã•ã‚‰ã«å¾Œã‹ã‚‰æ¥ãŸäººã®è‡ªå·±ç´¹ä»‹)

<ul>
<li>pandoc ãŒã‚ªã‚¹ã‚¹ãƒ¡</li>
</ul>
</li>
<li>ã¨ã—ã²ã•ã•ã‚“ã® Raspberry Pi ã§ NTP Stratum 1 Server ã®è©±

<ul>
<li><a href="http://tosihisa.postach.io/raspberry-pi-de-ntp-stratum-1-server-wozuo-ru">Raspberry Pi ã§ NTP Stratum-1 Server ã‚’ä½œã‚‹ï¼ | tosihisa&rsquo;s public notebook</a></li>
<li><a href="http://www.pool.ntp.org/scores/60.56.214.78">http://www.pool.ntp.org/scores/60.56.214.78</a></li>
<li><code>ntpdate -quv ntp.netfort.gr.jp</code> ã§ç¢ºèªã§ãã¾ã—ãŸã€‚</li>
</ul>
</li>
<li>å®ˆå±‹ã•ã‚“ã® Linux ã®æ˜”è©±ã¨ã‹ã®è©±</li>
<li>ã“ã‚“ã©ã†ã•ã‚“ã® Flightgear ã®è©±</li>
<li>å¤§æµ¦ã•ã‚“ã® æ–‡å­—æ›¸ãèµ·ã“ã—ãƒ„ãƒ¼ãƒ« <a href="http://sourceforge.jp/projects/smart-gs/">SMART-GS</a> ã®è©±</li>
<li>ã•ã‹ã‚‚ã¨ã•ã‚“ã®ã‚«ãƒ¼ãƒãƒ«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è©±

<ul>
<li><a href="http://netcat.bandcamp.com/">http://netcat.bandcamp.com/</a></li>
<li><a href="https://github.com/usrbinnc/netcat-cpi-kernel-module">https://github.com/usrbinnc/netcat-cpi-kernel-module</a></li>
</ul>
</li>
</ul>


<h2>æ„Ÿæƒ³</h2>

<p>ã„ã‚ã„ã‚ãªå†…å®¹ã®è©±ãŒèã‘ã¦é¢ç™½ã‹ã£ãŸã§ã™ã€‚</p>

<p>è‡ªåˆ†ãŒè©±ã‚’ã™ã‚‹ã®ã¯ã€ LILO ã®ã‚µãƒ¼ãƒãƒ¼ç§»è¡Œã®è©±ã¨ã„ã†æ¡ˆã‚‚ã‚ã£ãŸã®ã§ã™ãŒã€
ãã‚Œã¯ã¡ã‚ƒã‚“ã¨ã¾ã¨ã‚ã‚‹æ™‚é–“ã‚’ã¨ã£ã¦ã‹ã‚‰ã®æ–¹ãŒè‰¯ã•ãã†ã¨æ€ã£ã¦ã€
äº‹å‰ã«ä¸€åº¦è©¦ã—ã¦ã„ãŸã“ã¨ã®ã‚ã£ãŸ <code>libpam-google-authenticator</code> ã‚’å‰ã®æ™©ã«è©¦ã—ç›´ã—ãªãŒã‚‰ãƒ‡ãƒ¢ã®é †ç•ªã‚’è€ƒãˆã¦ã€
ãã®è©±ã‚’ã—ã¾ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mac OS X ã§ owncloudcmd ã‚’ä½¿ã†]]></title>
    <link href="http://blog.n-z.jp/blog/2014-05-02-owncloudcmd.html"/>
    <updated>2014-05-02T22:18:39+09:00</updated>
    <id>http://blog.n-z.jp/blog/owncloudcmd</id>
    <content type="html"><![CDATA[<p>ownCloud ã®ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã¯ <code>owncloudcmd</code> ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
æ˜”ã¯ <code>ocsync</code> ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãŒåˆ¥é€”ã‚ã£ãŸã‚ˆã†ã§ã™ãŒã€ä»Šã¯åŒæ¢±ã•ã‚Œã¦ã„ã‚‹ <code>owncloudcmd</code> ã‚’ä½¿ã†ã®ãŒä¸»æµã®ã‚ˆã†ã§ã™ã€‚</p>

<!--more-->


<h2>å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³</h2>

<ul>
<li>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ : ownCloud client for Mac 1.5.4 ã«åŒæ¢±ã® <code>owncloudcmd</code> ã§è©¦ã—ã¾ã—ãŸã€‚</li>
<li>ã‚µãƒ¼ãƒãƒ¼ : è‡ªå‰ã‚µãƒ¼ãƒãƒ¼ãªã‚‰ ownCloud 6.0.3 ã§ã€ä»Šå›ã®ä¾‹ã§ã¯ <a href="https://teracloud.jp/">Teraã‚¯ãƒ©ã‚¦ãƒ‰</a> ã‚’ä½¿ã£ã¦ã¿ã¾ã—ãŸã€‚</li>
</ul>


<h2>æ¦‚è¦</h2>

<p><code>path/to/owncloudcmd path/to/localdir ownclouds://example.jp/remote.php/webdav</code>
ã®ã‚ˆã†ã«ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ <code>owncloud</code> ã® WebDAV ç”¨ã® URL ã®å…ˆé ­ã® <code>http</code> ã‚’ <code>owncloud</code> ã«ç½®ãæ›ãˆãŸã‚‚ã® (<code>https</code> ãªã‚‰ <code>ownclouds</code>) ã‚’æŒ‡å®šã™ã‚‹ã¨åŒæœŸã§ãã¾ã™ã€‚</p>

<p>å¼•æ•°ãªã—ã§å®Ÿè¡Œã™ã‚‹ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®èª¬æ˜ãŒå‡ºã¾ã™ã€‚</p>

<h2>Mac OS X ç‰ˆã§ã®ä¿®æ­£</h2>

<h3><code>owncloudcmd</code> ã®ãƒªãƒ³ã‚¯ãƒŸã‚¹?</h3>

<p>æ™®é€šã«ä½¿ãŠã†ã¨ã™ã‚‹ã¨ <code>dyld: Library not loaded: libowncloudsync.0.dylib</code> ã§èµ·å‹•ã§ãã¾ã›ã‚“ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> /Applications/owncloud.app/Contents/MacOS/owncloudcmd <span class="nv">$HOME</span>/teracloud ownclouds://teracloud.jp/remote.php/webdav
</span><span class='line'><span class="go">dyld: Library not loaded: libowncloudsync.0.dylib</span>
</span><span class='line'><span class="go">  Referenced from: /Applications/owncloud.app/Contents/MacOS/owncloudcmd</span>
</span><span class='line'><span class="go">  Reason: image not found</span>
</span><span class='line'><span class="go">zsh: trace trap  /Applications/owncloud.app/Contents/MacOS/owncloudcmd</span>
</span></code></pre></td></tr></table></div></figure>


<h3>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ‘ã‚¹ä¿®æ­£</h3>

<p><code>otool -L</code> ã§ç¢ºèªã™ã‚‹ã¨ç›¸å¯¾ãƒ‘ã‚¹ãŒã¾ãšã„ã¨ã‚ã‹ã‚Šã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> otool -L /Applications/owncloud.app/Contents/MacOS/owncloudcmd
</span><span class='line'><span class="go">/Applications/owncloud.app/Contents/MacOS/owncloudcmd:</span>
</span><span class='line'><span class="go"> libowncloudsync.0.dylib (compatibility version 0.0.0, current version 1.5.4)</span>
</span><span class='line'><span class="go"> QtWebKit.framework/Versions/4/QtWebKit (compatibility version 4.9.0, current version 4.9.3)</span>
</span><span class='line'><span class="go"> QtXmlPatterns.framework/Versions/4/QtXmlPatterns (compatibility version 4.8.0, current version 4.8.4)</span>
</span><span class='line'><span class="go"> QtGui.framework/Versions/4/QtGui (compatibility version 4.8.0, current version 4.8.4)</span>
</span><span class='line'><span class="go"> QtDBus.framework/Versions/4/QtDBus (compatibility version 4.8.0, current version 4.8.4)</span>
</span><span class='line'><span class="go"> QtXml.framework/Versions/4/QtXml (compatibility version 4.8.0, current version 4.8.4)</span>
</span><span class='line'><span class="go"> QtSql.framework/Versions/4/QtSql (compatibility version 4.8.0, current version 4.8.4)</span>
</span><span class='line'><span class="go"> QtNetwork.framework/Versions/4/QtNetwork (compatibility version 4.8.0, current version 4.8.4)</span>
</span><span class='line'><span class="go"> QtCore.framework/Versions/4/QtCore (compatibility version 4.8.0, current version 4.8.4)</span>
</span><span class='line'><span class="go"> libocsync.0.dylib (compatibility version 0.0.0, current version 0.2.1)</span>
</span><span class='line'><span class="go"> /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.11)</span>
</span><span class='line'><span class="go"> /usr/local/opt/sqlite/lib/libsqlite3.0.dylib (compatibility version 9.0.0, current version 9.6.0)</span>
</span><span class='line'><span class="go"> /usr/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)</span>
</span><span class='line'><span class="go"> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices (compatibility version 1.0.0, current version 44.0.0)</span>
</span><span class='line'><span class="go"> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation (compatibility version 300.0.0, current version 751.63.0)</span>
</span><span class='line'><span class="go"> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit (compatibility version 45.0.0, current version 1038.36.0)</span>
</span><span class='line'><span class="go"> @loader_path/../Frameworks/Sparkle.framework/Versions/A/Sparkle (compatibility version 1.5.0, current version 1.5.0)</span>
</span><span class='line'><span class="go"> /usr/local/lib/libqtkeychain.0.3.0.dylib (compatibility version 0.0.0, current version 0.3.0)</span>
</span><span class='line'><span class="go"> /usr/local/opt/neon/lib/libneon.27.dylib (compatibility version 31.0.0, current version 31.0.0)</span>
</span><span class='line'><span class="go"> /usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.9.0)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>install_name_tool -add_rpath</code> ã‚„ <code>install_name_tool -delete_rpath</code> ã§è©¦è¡ŒéŒ¯èª¤ã—ãŸã®ã§ã™ãŒã€
<code>otool -l /Applications/owncloud.app/Contents/MacOS/owncloudcmd</code> ã§ç¢ºèªã—ã¦ã‚‚
<code>rpath</code> ãŒå¾Œã‚ã«è¿½åŠ ã•ã‚Œã¦ãã„ã¦ã„ãªã„ã‚ˆã†ã ã£ãŸã®ã§ã€
<code>install_name_tool -change</code> ã§å¯¾å¿œã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p>

<p>ã¾ãšç›¸å¯¾ãƒ‘ã‚¹ã‚’ä¿®æ­£ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span>  otool -L /Applications/owncloud.app/Contents/MacOS/owncloudcmd | awk <span class="s1">&#39;$1~&quot;^lib&quot;{print &quot;install_name_tool -change &quot; $1 &quot; @executable_path/../MacOS/&quot; $1 &quot; /Applications/owncloud.app/Contents/MacOS/owncloudcmd&quot; }&#39;</span> | sh -e
</span><span class='line'><span class="gp">%</span>  otool -L /Applications/owncloud.app/Contents/MacOS/owncloudcmd | awk <span class="s1">&#39;$1~&quot;^Qt&quot;{print &quot;install_name_tool -change &quot; $1 &quot; @executable_path/../Frameworks/&quot; $1 &quot; /Applications/owncloud.app/Contents/MacOS/owncloudcmd&quot; }&#39;</span> | sh -e
</span></code></pre></td></tr></table></div></figure>


<p>ã•ã‚‰ã« <code>/usr/local/lib</code> ã‚’ã•ã—ã¦ã„ã‚‹ã‚‚ã®ãŒã‚ã£ãŸã®ã‚’ä¿®æ­£ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span>  /Applications/owncloud.app/Contents/MacOS/owncloudcmd
</span><span class='line'><span class="go">dyld: Library not loaded: /usr/local/lib/libqtkeychain.0.3.0.dylib</span>
</span><span class='line'><span class="go">  Referenced from: /Applications/owncloud.app/Contents/MacOS/owncloudcmd</span>
</span><span class='line'><span class="go">  Reason: image not found</span>
</span><span class='line'><span class="go">zsh: trace trap  /Applications/owncloud.app/Contents/MacOS/owncloudcmd</span>
</span><span class='line'><span class="gp">%</span>  find /Applications/owncloud.app -name libqtkeychain.0.3.0.dylib
</span><span class='line'><span class="go">/Applications/owncloud.app/Contents/MacOS/libqtkeychain.0.3.0.dylib</span>
</span><span class='line'><span class="gp">%</span>  install_name_tool -change /usr/local/lib/libqtkeychain.0.3.0.dylib /Applications/owncloud.app/Contents/MacOS/libqtkeychain.0.3.0.dylib /Applications/owncloud.app/Contents/MacOS/owncloudcmd
</span><span class='line'><span class="gp">%</span>  /Applications/owncloud.app/Contents/MacOS/owncloudcmd
</span><span class='line'><span class="go">dyld: Library not loaded: /usr/local/opt/neon/lib/libneon.27.dylib</span>
</span><span class='line'><span class="go">  Referenced from: /Applications/owncloud.app/Contents/MacOS/owncloudcmd</span>
</span><span class='line'><span class="go">  Reason: image not found</span>
</span><span class='line'><span class="go">zsh: trace trap  /Applications/owncloud.app/Contents/MacOS/owncloudcmd</span>
</span><span class='line'><span class="gp">%</span>  find /Applications/owncloud.app -name libneon.27.dylib
</span><span class='line'><span class="go">/Applications/owncloud.app/Contents/MacOS/libneon.27.dylib</span>
</span><span class='line'><span class="gp">%</span>  install_name_tool -change /usr/local/opt/neon/lib/libneon.27.dylib /Applications/owncloud.app/Contents/MacOS/libneon.27.dylib /Applications/owncloud.app/Contents/MacOS/owncloudcmd
</span></code></pre></td></tr></table></div></figure>


<p>ã“ã‚Œã§ä½™è¨ˆãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å‡ºã¾ã™ãŒã€ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span>  /Applications/owncloud.app/Contents/MacOS/owncloudcmd
</span><span class='line'><span class="go">objc[40210]: Class WebCoreMovieObserver is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">objc[40210]: Class WebCoreSharedBufferData is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">objc[40210]: Class WebVideoFullscreenWindow is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">objc[40210]: Class WebVideoFullscreenController is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">objc[40210]: Class WebVideoFullscreenHUDWindowController is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">objc[40210]: Class WebVideoFullscreenHUDWindow is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">objc[40210]: Class WebWindowFadeAnimation is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">objc[40210]: Class WebWindowScaleAnimation is implemented in both /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore and /Applications/owncloud.app/Contents/Frameworks/QtWebKit.framework/Versions/4/QtWebKit. One of the two will be used. Which one is undefined.</span>
</span><span class='line'><span class="go">owncloudcmd - command line ownCloud client tool.</span>
</span><span class='line'>
</span><span class='line'><span class="go">Usage: owncloudcmd &lt;sourcedir&gt; &lt;owncloudurl&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">A proxy can either be set manually using --httpproxy or it</span>
</span><span class='line'><span class="go">uses the setting from a configured sync client.</span>
</span><span class='line'>
</span><span class='line'><span class="go">Options:</span>
</span><span class='line'><span class="go">  --confdir = configdir: Read config from there.</span>
</span><span class='line'><span class="go">  --httpproxy = proxy:   Specify a http proxy to use.</span>
</span><span class='line'><span class="go">                         Proxy is http://server:port</span>
</span><span class='line'>
</span><span class='line'><span class="go">zsh: exit 1     /Applications/owncloud.app/Contents/MacOS/owncloudcmd</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ä½¿ã„æ–¹</h2>

<p>æ¦‚è¦ã®ã¨ã“ã‚ã«æ›¸ã„ãŸã‚ˆã†ã«ã€
æ™®é€šã« <code>owncloudcmd sourcedir owncloudurl</code> ã§å®Ÿè¡Œã™ã‚‹ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’èã‹ã‚Œã¾ã™ã€‚
URL ã« <code>ownclouds://user:password@example.jp/remote.php/webdav</code> ã®ã‚ˆã†ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ã‚‚å‡ºæ¥ã¾ã™ãŒã€ã‚ã¾ã‚Šã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯æ›¸ããŸããªã„ã“ã¨ãŒå¤šã„ã¨æ€ã„ã¾ã™ã€‚</p>

<p>ã—ã‹ã—ã€
<a href="https://github.com/owncloud/mirall/blob/f72e1cc8375b72c97d6566c6875f7214415cea9c/src/owncloudcmd/owncloudcmd.cpp">owncloudcmd ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³å‡¦ç†éƒ¨åˆ†ã®ã‚½ãƒ¼ã‚¹</a>
ã‚’ã¿ã¦ã‚‚ <code>"--confdir"</code> ã¯èª­ã¿è¾¼ã‚€ã ã‘ã§ä½¿ã‚ã‚Œã¦ã„ãªã„ã‚ˆã†ãªã®ã§ã€
ä»–ã®æ–¹æ³•ã§æŒ‡å®šã™ã‚‹ã“ã¨ã¯å‡ºæ¥ãªã•ãã†ã§ã—ãŸã€‚</p>

<h2>ã¾ã¨ã‚</h2>

<p><code>owncloudcmd</code> ã‚’ä½¿ãˆã° GUI ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§è¨­å®šã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ä»¥å¤–ã®ã‚µãƒ¼ãƒãƒ¼ã¨åŒæœŸã—ãŸã‚Šã€
ã‚µãƒ¼ãƒãƒ¼ãªã©ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®ã¿ã®ç’°å¢ƒã§ã‚‚ <code>owncloud</code> ã¨ã®åŒæœŸãŒå‡ºæ¥ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</p>

<p>ã—ã‹ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å‡ºæ¥ãŒã¾ã ã‚ã¾ã‚Šã‚ˆããªã„ã®ã§ã€ä½¿ã„å‹æ‰‹ã¯è‰¯ããªã„ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‹ã‚Šã¾ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç¬¬ 10 å› RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka ã«å‚åŠ ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-23-rubymotion-mokumoku.html"/>
    <updated>2014-04-23T19:16:51+09:00</updated>
    <id>http://blog.n-z.jp/blog/rubymotion-mokumoku</id>
    <content type="html"><![CDATA[<p>ç¬¬ 1 å›ã‹ã‚‰ç¬¬ 9 å›ã«ã‚‚å‚åŠ ã—ãŸ RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka ã®
<a href="http://connpass.com/event/5674/">ç¬¬ 10 å› RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka</a>
ã«å‚åŠ ã—ã¦ãã¾ã—ãŸã€‚</p>

<p>æ¬¡å›ã®
<a href="http://connpass.com/event/6116/">ç¬¬ 11 å› RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka &ndash; connpass</a>
ã¯ 05/28(æ°´) ã«ãªã‚Šã¾ã—ãŸã€‚</p>

<!--more-->


<h2>ãƒ¡ãƒ¢</h2>

<ul>
<li><a href="https://itunes.apple.com/jp/app/bokosuka!mogurando/id845835380?mt=8">ãƒœã‚³ã‚¹ã‚«ï¼ãƒ¢ã‚°ãƒ©ãƒ³ãƒ‰</a></li>
<li><a href="http://www.amazon.co.jp/gp/product/4873116678/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=4873116678&amp;linkCode=as2&amp;tag=znz-22">AngularJSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã‚¬ã‚¤ãƒ‰</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=znz-22&amp;l=as2&amp;o=9&amp;a=4873116678" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /> ãŒç™ºå£²ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†è©±</li>
<li><a href="http://www.pixate.com/">Pixate</a></li>
<li>MacFace</li>
<li><a href="https://github.com/HipByte/RubyMotionSamples/issues/31">osx/Tweets app crashes on launch</a></li>
<li><a href="http://www.impress-plus.co.jp/">http://www.impress-plus.co.jp/</a></li>
</ul>


<h2>èª¿æŸ»ç¶šã</h2>

<p>å¼•ãç¶šãåˆå›èµ·å‹•æ™‚ã® URL ã®å—ã‘å–ã‚Šæ–¹ã‚’èª¿ã¹ã¦ã„ã¾ã—ãŸã€‚</p>

<ul>
<li><a href="http://questbeat.hatenablog.jp/entry/2014/04/19/123207">ã€Œãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«èµ·å‹•ã€ã‚’å®Ÿè£…ã™ã‚‹</a> ã¯ã‚ã‚“ã¾ã‚Šé–¢ä¿‚ãªã‹ã£ãŸã€‚</li>
<li>GitHub ã§ <code>LSSetDefaultHandlerForURLScheme</code> ã‚’æ¤œç´¢

<ul>
<li><a href="https://github.com/s-faychatelard/Helm/blob/2c85b303781fa430432c17ed9848a0b252c82eae/sources/others/mac/mac.mm">https://github.com/s-faychatelard/Helm/blob/2c85b303781fa430432c17ed9848a0b252c82eae/sources/others/mac/mac.mm</a> : Qt ã§å®Ÿè£…ã—ã¦ã„ã¦ URL ã‚’å—ã‘å–ã£ã¦ã„ã‚‹éƒ¨åˆ†ãŒã‚ã‹ã‚‰ãš (Qt ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å¤‰æ›ã•ã‚ŒãŸã‚‚ã®ã‚’å—ã‘å–ã£ã¦ã„ã‚‹?)</li>
<li><a href="https://github.com/bigbearlabs/MotionKit/blob/51f46c14b52819b709c57d6e1c954d84c852e48b/lib/motion-kit/misc/osx/osx_browsers.rb">https://github.com/bigbearlabs/MotionKit/blob/51f46c14b52819b709c57d6e1c954d84c852e48b/lib/motion-kit/misc/osx/osx_browsers.rb</a> : ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®ä¸€è¦§ã®å–å¾—ãªã©</li>
<li><a href="https://github.com/bigbearlabs/MotionKit/blob/51f46c14b52819b709c57d6e1c954d84c852e48b/lib/motion-kit/app/osx/app.rb">https://github.com/bigbearlabs/MotionKit/blob/51f46c14b52819b709c57d6e1c954d84c852e48b/lib/motion-kit/app/osx/app.rb</a> : <code>application:openFile:</code> ã‚„ <code>application:openFiles:</code> ã§å—ã‘å–ã£ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ãŒè©¦ã—ã¦ã¿ã¦ã‚‚å‘¼ã°ã‚Œãªã„ã€‚</li>
<li><a href="https://github.com/gnyrd/WebEx/blob/0ea21241591e496d1d702c45768400fa14d75662/URLHandler.m">https://github.com/gnyrd/WebEx/blob/0ea21241591e496d1d702c45768400fa14d75662/URLHandler.m</a> : <code>kAEGetURL</code> ã®ç™»éŒ²ã« <code>handleGetURLEvent:withReplyEvent:</code> (2å¼•æ•°) ã§ã¯ãªã <code>getURL:</code> (1å¼•æ•°) ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚</li>
</ul>
</li>
</ul>


<p>å‰å›ã¾ã§ã®è©¦è¡ŒéŒ¯èª¤ã®é€”ä¸­ã§ <code>setEventHandler</code> ã®å‘¼ã³å‡ºã—ã‚’ <code>applicationDidFinishLaunching:</code> ã‹ã‚‰ <code>initialize</code> ã«ç§»å‹•ã—ã¦ã„ãŸã®ã¨ <code>getURL:</code> ã¸ã®å¤‰æ›´ã®çµ„ã¿åˆã‚ã›ã§ã€ã‚„ã£ã¨åˆå›èµ·å‹•æ™‚ã«ã‚‚ URL ãŒå—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã€
ã•ã‚‰ã« <code>rake clean</code> ã—ãŸã‚Šä¸€åº¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‚’ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã«è¨­å®šã—ç›´ã—ãŸã‚Šã—ã¦ã„ãŸã‚‰ã€
<code>handleGetURLEvent:withReplyEvent:</code> ã«æˆ»ã—ã¦ã‚‚åˆå›èµ·å‹•æ™‚ã«å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚</p>

<p>åŸå› ãŒã¯ã£ãã‚Šã—ãªã„ã®ãŒå«Œãªæ„Ÿã˜ã§ã™ãŒã€ä½•ã‹è¨­å®šãŒä¸­é€”åŠç«¯ã«æ®‹ã£ã¦ã„ã‚‹ã¨ã†ã¾ãå‹•ã‹ãªã‹ã£ãŸã‚ˆã†ã§ã™ã€‚</p>

<h2>RubyMine</h2>

<p>å‰å›ã®ã‚‚ãã‚‚ãä¼šã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€ä»–ã§ã¯ä½¿ã£ã¦ã„ãªã‹ã£ãŸã®ã§ã€
ã»ã¼ä½¿ã£ã¦ã„ãªã„ã¾ã¾ç™»éŒ²ã›ãšè©¦ç”¨æœŸé™ãŒåˆ‡ã‚Œã¦ã—ã¾ã£ã¦ã€
30åˆ†ã”ã¨ã«çµ‚äº†ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[homebrew cask ã§ sylpheed test1 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-21-brew-cask-sylpheed.html"/>
    <updated>2014-04-21T23:00:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/brew-cask-sylpheed</id>
    <content type="html"><![CDATA[<p><a href="http://sylpheed.sraoss.jp/ja/news.html">Sylpheed 3.4.1-test1 for Mac OS X (ãƒ†ã‚¹ãƒˆç‰ˆ)</a>
ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãŸã®ã§ã€
homebrew cask ã‚’ä½¿ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã¾ã—ãŸã€‚</p>

<p>dmg ã§é…å¸ƒã•ã‚Œã¦ã„ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ homebrew cask ã«å¯¾å¿œã•ã›ã‚‹ä¾‹ã¨ã—ã¦ã‚‚å‚è€ƒã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>

<!--more-->


<h2>homebrew cask ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>

<p><a href="http://brew.sh/">Homebre</a>
ã¨
<a href="https://github.com/phinze/homebrew-cask">homebrew-cask</a>
ã‚’ã‚ã‚‰ã‹ã˜ã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¾ã™ã€‚</p>

<h2>cask ä½œæˆ</h2>

<p><code>brew cask create sylpheed-test</code> ã§ä½œæˆã—ã¦ã€
å†…å®¹ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">SylpheedTest</span> <span class="o">&lt;</span> <span class="no">Cask</span>
</span><span class='line'>  <span class="n">url</span> <span class="s1">&#39;http://sylpheed.sraoss.jp/sylpheed/macosx/Sylpheed_3.4.1-test1.dmg&#39;</span>
</span><span class='line'>  <span class="n">homepage</span> <span class="s1">&#39;http://sylpheed.sraoss.jp/&#39;</span>
</span><span class='line'>  <span class="n">version</span> <span class="s1">&#39;3.4.1-test1&#39;</span>
</span><span class='line'>  <span class="n">sha256</span> <span class="s1">&#39;52505ab7913fd58fa921a9c8b574286f08073321b440b7aa23dba3896b4b2ddc&#39;</span>
</span><span class='line'>  <span class="n">link</span> <span class="s1">&#39;Sylpheed.app&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>sha256</code> ã¯
<a href="https://github.com/phinze/homebrew-cask/blob/master/CONTRIBUTING.md#cask-stanzas">Cask Stanzas</a>
ã®èª¬æ˜ã«ã‚ã‚‹ã‚ˆã†ã«åˆ¥é€” <code>url</code> ã«æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ <code>shasum -a 256 &lt;file&gt;</code> ã§èª¿ã¹ã¾ã—ãŸã€‚
ã‚‚ã— upstream ã®ãƒªãƒªãƒ¼ã‚¹ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ã«æ›¸ã„ã¦ã‚ã‚Œã°ã€ãã‚Œã‚’ãã®ã¾ã¾ä½¿ãˆã°è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</p>

<p>ç·¨é›†é€”ä¸­ã§é–‰ã˜ã¦ã—ã¾ã£ãŸå ´åˆã¯
<code>brew cask edit sylpheed-test</code>
ã§å†ç·¨é›†ã§ãã¾ã™ã€‚</p>

<p>å®Ÿä½“ã¯ <code>$(brew --prefix)/Library/Taps/phinze-cask/Casks/sylpheed-test.rb</code> ã«ã‚ã‚Šã¾ã™ã€‚</p>

<h2>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>

<p><code>sylpheed-test.rb</code> ãŒä½œæˆã§ããŸã‚‰ <code>brew cask install sylpheed-test</code> ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> brew cask install sylpheed-test
</span><span class='line'><span class="go">==&gt; Downloading http://sylpheed.sraoss.jp/sylpheed/macosx/Sylpheed_3.4.1-test1.dmg</span>
</span><span class='line'><span class="gp">#</span><span class="c">####################################################################### 100.0%</span>
</span><span class='line'><span class="go">==&gt; Symlinking App &#39;Sylpheed.app&#39; to &#39;/Users/kazu/Applications/Sylpheed.app&#39;</span>
</span><span class='line'><span class="go">ğŸº  sylpheed-test installed to &#39;/opt/homebrew-cask/Caskroom/sylpheed-test/3.4.1-test1&#39; (314 files, 32M)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>èµ·å‹•</h2>

<p>Launchpad ã‹ã‚‰èµ·å‹•ã—ãŸã‚Šã€Spotlight ã§æ¤œç´¢ã—ãŸã‚Šã—ã¦æ™®é€šã«èµ·å‹•ã—ã¾ã™ã€‚</p>

<p>åˆå›èµ·å‹•ã§
<code>~/Library/Application Support/Sylpheed/Mailboxes/Mail</code>
ã‚’ä½œã‚‹ã‹ãã‹ã‚Œã¾ã—ãŸãŒã€ãã®æ™‚ç‚¹ã§æ—¢ã«
<code>~/Library/Application Support/Sylpheed</code>
ã¯ä½œæˆã•ã‚Œã¦ã„ã¾ã—ãŸã€‚</p>

<h2>ã¾ã¨ã‚</h2>

<p>ãƒ†ã‚¹ãƒˆç‰ˆãªã®ã§ã€ã¾ã å¤‰ãªã¨ã“ã‚ã¯ã‚ã‚‹ã‚ˆã†ã§ã™ãŒ (Command+V ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ã®ãƒˆã‚°ãƒ«ã«ãªã£ã¦ãƒšãƒ¼ã‚¹ãƒˆã§ããªã„ã¨ã‹)
Mac OS X ç‰ˆç‰¹æœ‰ã®å•é¡ŒãŒã‚ã‚‹ã ã‘ã®ã‚ˆã†ãªã®ã§ã€ä»Šå¾Œã®æ­£å¼ç‰ˆã«æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚</p>

<p>ã¾ã  test ç‰ˆãªã®ã§ pull request ã¯ã—ã¦ã„ãªã„ã®ã§ã™ãŒã€
æ­£å¼ç‰ˆãŒå‡ºãŸã‚‰ homebrew cask ã« pull request ã‚’é€ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
beta ç‰ˆãªã©ã‚‚å¯¾å¿œã™ã‚‹ãªã‚‰
<a href="https://github.com/caskroom/homebrew-versions">homebrew-cask-versions</a>
ã« pull request ã‚’é€ã‚‹ã¨è‰¯ã•ãã†ã§ã™ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ubuntu 14.04 ã§ dokku ã‚’ä½¿ã†]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-18-ubuntu-1404-dokku.html"/>
    <updated>2014-04-18T23:00:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/ubuntu-1404-dokku</id>
    <content type="html"><![CDATA[<p>Ubuntu 14.04 ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã®ã§ã€
<a href="https://github.com/progrium/dokku">dokku</a>
ã‚’ Ubuntu 14.04 ã§è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚</p>

<!--more-->


<h2>dokku ã® Vagrantfile ã‚’ç¢ºèªã™ã‚‹</h2>

<p>ã¾ãš dokku ã‚’ clone ã—ã¦ä¸­ã® Vagrantfile ã‚’ã¿ã¦ã€
ç’°å¢ƒå¤‰æ•°ã§è¨­å®šã§ãã‚‹é …ç›®ãŒã‚ã‚‹ã®ã‚’ç¢ºèªã—ã¦ãŠãã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> git clone https://github.com/progrium/dokku
</span><span class='line'><span class="gp">%</span> <span class="nb">cd </span>dokku
</span><span class='line'><span class="gp">%</span> vi Vagrantfile
</span></code></pre></td></tr></table></div></figure>


<h2>Vagantfile ã‚’å¤‰æ›´ã™ã‚‹</h2>

<p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® apt-line ã®ã¾ã¾ã ã¨ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒé…ã„ã®ã§ã€
<a href="http://mirrors.ubuntu.com/mirrors.txt">http://mirrors.ubuntu.com/mirrors.txt</a>
ã‹ã‚‰ãƒŸãƒ©ãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚’é¸ã‚“ã§ (ä»Šå›ã¯ jaist ã‚’é¸æŠ)ã€
shell provision ã®ã¨ã“ã‚ã§æ›¸ãæ›ãˆã¦ãŠãã¾ã™ã€‚
(é–¢ä¿‚ãªã„ã¨ã“ã‚ã«ãƒãƒƒãƒã—ã¦å•é¡ŒãŒèµ·ãã‚‹å¯èƒ½æ€§ã¯ã»ã¼ãªã„ã®ã§ã€ç½®æ›å…ƒã® URL ã® <code>.</code> ã¯ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ã¦ã„ã¾ã›ã‚“ã€‚)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gh">diff --git a/Vagrantfile b/Vagrantfile</span>
</span><span class='line'><span class="gh">index a310f6b..7c1a133 100644</span>
</span><span class='line'><span class="gd">--- a/Vagrantfile</span>
</span><span class='line'><span class="gi">+++ b/Vagrantfile</span>
</span><span class='line'><span class="gu">@@ -29,5 +29,10 @@ Vagrant::configure(&quot;2&quot;) do |config|</span>
</span><span class='line'>     vb.customize [&quot;modifyvm&quot;, :id, &quot;--memory&quot;, BOX_MEMORY]
</span><span class='line'>   end
</span><span class='line'>
</span><span class='line'><span class="gd">-  config.vm.provision :shell, :inline =&gt; &quot;apt-get -y install git &amp;&amp; cd /root/dokku &amp;&amp; #{make_cmd}&quot;</span>
</span><span class='line'><span class="gi">+  config.vm.provision :shell, :inline =&gt; &lt;&lt;-SHELL</span>
</span><span class='line'><span class="gi">+    sed -i~ -e &#39;s;http://archive.ubuntu.com/ubuntu;http://ftp.jaist.ac.jp/pub/Linux/ubuntu;&#39; /etc/apt/sources.list &amp;&amp;</span>
</span><span class='line'><span class="gi">+    apt-get update &amp;&amp;</span>
</span><span class='line'><span class="gi">+    apt-get -y install git &amp;&amp;</span>
</span><span class='line'><span class="gi">+    cd /root/dokku &amp;&amp; #{make_cmd}</span>
</span><span class='line'><span class="gi">+  SHELL</span>
</span><span class='line'> end
</span></code></pre></td></tr></table></div></figure>


<h2>åˆå›èµ·å‹•</h2>

<p><code>BOX_NAME</code>, <code>BOX_URI</code> ã« trusty ã‚’æŒ‡å®šã—ã¦ã€
<code>BOX_MEMORY</code> ã‚‚ 512 ã‹ã‚‰ 2048 ã«å¢—ã‚„ã—ãŸå€¤ã‚’æŒ‡å®šã—ã¦èµ·å‹•ã—ã¾ã™ã€‚</p>

<p><code>node-js-sample</code> ã ã¨ 512 ãƒ¡ã‚¬ã§ã‚‚å•é¡Œãªã„ã®ã§ã™ãŒã€
Rails ã‚¢ãƒ—ãƒªã‚’å‹•ã‹ãã†ã¨ã™ã‚‹ã¨ãƒ¡ãƒ¢ãƒªä¸è¶³ã§ <code>bundle install</code> ã®é€”ä¸­ã§å¤±æ•—ã—ã¦
deploy ã§ããªã‹ã£ãŸã®ã§å¢—ã‚„ã—ã¦ã„ã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> <span class="nv">BOX_NAME</span><span class="o">=</span>trusty-amd64-20140418 <span class="nv">BOX_URI</span><span class="o">=</span>https://cloud-images.ubuntu.com/vagrant/trusty/20140418/trusty-server-cloudimg-amd64-vagrant-disk1.box <span class="nv">BOX_MEMORY</span><span class="o">=</span>2048 vagrant up
</span></code></pre></td></tr></table></div></figure>


<p>box ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€
VM ã®ä½œæˆãªã©ã«ã¯æ™‚é–“ãŒã‹ã‹ã‚‹ã®ã§ã€
ä»–ã®ã“ã¨ã‚’ã—ãªãŒã‚‰ã‚†ã£ãã‚Šå¾…ã¡ã¾ã™ã€‚</p>

<h2>äºŒåº¦ç›®ä»¥é™ã®èµ·å‹•</h2>

<p>VM ã®ä½œæˆãŒã§ãã¦ã„ã‚‹çŠ¶æ…‹ãªã‚‰ã€
box ã®è¨­å®šã¯å‚ç…§ã•ã‚Œãªã„ã®ã§çœç•¥ã§ãã¾ã™ã€‚
<code>vagrant destroy</code> ã—ãŸå¾Œã« <code>vagrant up</code> ã—ç›´ã—ãŸã¨ãã¯å‚ç…§ã•ã‚Œã‚‹ã®ã§ã€
æ¯å›è¨­å®šã—ã¦ã„ã¦ã‚‚ã‹ã¾ã„ã¾ã›ã‚“ã€‚</p>

<p><code>BOX_MEMORY</code> ã¯æ¯å›è¨­å®šã•ã‚Œã‚‹ã®ã§ã€æŒ‡å®šã‚’å¿˜ã‚Œã‚‹ã¨ 512 ã«æˆ»ã£ã¦ã—ã¾ã„ã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> <span class="nv">BOX_MEMORY</span><span class="o">=</span>2048 vagrant up
</span></code></pre></td></tr></table></div></figure>


<h2>dokku ã®åˆæœŸè¨­å®š</h2>

<p>ssh ã®éµã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> vagrant ssh
</span><span class='line'><span class="gp">vagrant@dokku:~$</span> egrep <span class="s1">&#39;^ssh&#39;</span> ~/.ssh/authorized_keys | sudo sshcommand acl-add dokku vagrant
</span><span class='line'><span class="go">dd:3b:b8:2e:85:04:06:e9:ab:ff:a8:0a:c0:04:6e:d6</span>
</span><span class='line'><span class="gp">vagrant@dokku:~$</span> cat ~/.ssh/authorized_keys
</span><span class='line'><span class="gp">#</span> CLOUD_IMG: This file was created/modified by the Cloud Image build process
</span><span class='line'><span class="go">ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key</span>
</span><span class='line'><span class="gp">vagrant@dokku:~$</span> cat /home/dokku/.ssh/authorized_keys
</span><span class='line'><span class="go">command=&quot;FINGERPRINT=dd:3b:b8:2e:85:04:06:e9:ab:ff:a8:0a:c0:04:6e:d6 NAME=vagrant `cat /home/dokku/.sshcommand` $SSH_ORIGINAL_COMMAND&quot;,no-agent-forwarding,no-user-rc,no-X11-forwarding,no-port-forwarding ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key</span>
</span></code></pre></td></tr></table></div></figure>


<h2>dokku ã®éµè¿½åŠ å¤±æ•—ä¾‹</h2>

<p><code>cat ~/.ssh/authorized_keys | sudo sshcommand acl-add dokku vagrant</code>
ã§è¿½åŠ ã—ã¦ã—ã¾ã†ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>vagrant@dokku:~$ cat /home/dokku/.ssh/authorized_keys
</span><span class='line'>command=&quot;FINGERPRINT=is NAME=vagrant `cat /home/dokku/.sshcommand` $SSH_ORIGINAL_COMMAND&quot;,no-agent-forwarding,no-user-rc,no-X11-forwarding,no-port-forwarding # CLOUD_IMG: This file was created/modified by the Cloud Image build process
</span><span class='line'>ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">KEY</span><span class="o">=</span><span class="k">$(</span>cat<span class="k">)</span>
</span><span class='line'><span class="nv">FINGERPRINT</span><span class="o">=</span><span class="k">$(</span>ssh-keygen -lf /dev/stdin <span class="o">&lt;&lt;&lt;</span> <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$KEY</span><span class="k">)</span> | awk <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
</span><span class='line'><span class="nv">KEY_PREFIX</span><span class="o">=</span><span class="s2">&quot;command=\&quot;FINGERPRINT=$FINGERPRINT NAME=$NAME \`cat $USERHOME/.sshcommand\` \$SSH_ORIGINAL_COMMAND\&quot;,no-agent-forwarding,no-user-rc,no-X11-forwarding,no-port-forwarding&quot;</span>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;$KEY_PREFIX $KEY&quot;</span> &gt;&gt; <span class="s2">&quot;$USERHOME/.ssh/authorized_keys&quot;</span>
</span><span class='line'><span class="nb">echo</span> <span class="nv">$FINGERPRINT</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã®éƒ¨åˆ†ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã« <code>while read</code> ãƒ«ãƒ¼ãƒ—ã«å¤‰ãˆãŸæ–¹ãŒè‰¯ã„ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="k">while </span><span class="nb">read </span>KEY; <span class="k">do</span>
</span><span class='line'><span class="k">  </span><span class="nv">FINGERPRINT</span><span class="o">=</span><span class="k">$(</span>ssh-keygen -lf /dev/stdin <span class="o">&lt;&lt;&lt;</span> <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$KEY</span><span class="k">)</span> | awk <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
</span><span class='line'>  <span class="nv">KEY_PREFIX</span><span class="o">=</span><span class="s2">&quot;command=\&quot;FINGERPRINT=$FINGERPRINT NAME=$NAME \`cat $USERHOME/.sshcommand\` \$SSH_ORIGINAL_COMMAND\&quot;,no-agent-forwarding,no-user-rc,no-X11-forwarding,no-port-forwarding&quot;</span>
</span><span class='line'>  <span class="nb">echo</span> <span class="s2">&quot;$KEY_PREFIX $KEY&quot;</span> &gt;&gt; <span class="s2">&quot;$USERHOME/.ssh/authorized_keys&quot;</span>
</span><span class='line'>  <span class="nb">echo</span> <span class="nv">$FINGERPRINT</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<h2>node-js-sample ã® deploy</h2>

<p><code>node-js-sample</code> ã‚’ <code>deploy</code> ã—ã¦å‹•ä½œç¢ºèªã—ã¾ã™ã€‚
ä»¥ä¸‹ã®ä¾‹ã§ã¯ <code>ssh dokku</code> ã§ VM ã«æ¥ç¶šã§ãã‚‹ã‚ˆã†ã« <code>~/.ssh/config</code> ã«è¨­å®šæ¸ˆã¿ã§ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> git clone https://github.com/heroku/node-js-sample
</span><span class='line'><span class="go">Cloning into &#39;node-js-sample&#39;...</span>
</span><span class='line'><span class="go">remote: Reusing existing pack: 319, done.</span>
</span><span class='line'><span class="go">remote: Total 319 (delta 0), reused 0 (delta 0)</span>
</span><span class='line'><span class="go">Receiving objects: 100% (319/319), 201.92 KiB | 210.00 KiB/s, done.</span>
</span><span class='line'><span class="go">Resolving deltas: 100% (17/17), done.</span>
</span><span class='line'><span class="go">Checking connectivity... done.</span>
</span><span class='line'><span class="gp">%</span> <span class="nb">cd </span>node-js-sample
</span><span class='line'><span class="gp">%</span> git remote add dokku dokku:node-js-app
</span><span class='line'><span class="gp">%</span>  git push --set-upstream dokku master
</span><span class='line'><span class="go">Counting objects: 319, done.</span>
</span><span class='line'><span class="go">Delta compression using up to 4 threads.</span>
</span><span class='line'><span class="go">Compressing objects: 100% (274/274), done.</span>
</span><span class='line'><span class="go">Writing objects: 100% (319/319), 201.92 KiB | 0 bytes/s, done.</span>
</span><span class='line'><span class="go">Total 319 (delta 17), reused 319 (delta 17)</span>
</span><span class='line'><span class="go">-----&gt; Cleaning up ...</span>
</span><span class='line'><span class="go">remote: Cloning into &#39;/tmp/tmp.ChNvZEb5S9&#39;...</span>
</span><span class='line'><span class="go">-----&gt; Building node-js-app ...</span>
</span><span class='line'><span class="go">remote: warning: You appear to have cloned an empty repository.</span>
</span><span class='line'><span class="go">remote: done.</span>
</span><span class='line'><span class="go">remote: HEAD is now at 2e52ce7... Update documentation links</span>
</span><span class='line'><span class="go">       Node.js app detected</span>
</span><span class='line'><span class="go">-----&gt; Requested node range:  0.10.x</span>
</span><span class='line'><span class="go">-----&gt; Resolved node version: 0.10.26</span>
</span><span class='line'><span class="go">-----&gt; Downloading and installing node</span>
</span><span class='line'><span class="go">(çœç•¥)</span>
</span><span class='line'><span class="go">-----&gt; Discovering process types</span>
</span><span class='line'><span class="go">       Procfile declares types -&gt; web</span>
</span><span class='line'><span class="go">-----&gt; Releasing node-js-app ...</span>
</span><span class='line'><span class="go">-----&gt; Deploying node-js-app ...</span>
</span><span class='line'><span class="go">=====&gt; Application deployed:</span>
</span><span class='line'><span class="go">       http://node-js-app.dokku.me</span>
</span><span class='line'>
</span><span class='line'><span class="go">To dokku:node-js-app</span>
</span><span class='line'><span class="go"> * [new branch]      master -&gt; master</span>
</span><span class='line'><span class="go">Branch master set up to track remote branch master from dokku.</span>
</span></code></pre></td></tr></table></div></figure>


<p>Vagrantfile ã§ guest ã® 80 ç•ªãƒãƒ¼ãƒˆã‚’ host ã® 8080 ç•ªãƒãƒ¼ãƒˆã§è¦‹ãˆã‚‹ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã§
<code>http://node-js-app.dokku.me:8080/</code>
ã§é–‹ãã¨ <code>Hello World!</code> ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vagrant ã§ Ubuntu 14.04 ã‚’è©¦ã™]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-18-ubuntu-1404-vagrant.html"/>
    <updated>2014-04-18T13:00:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/ubuntu-1404-vagrant</id>
    <content type="html"><![CDATA[<p>Vagrant ã§ Ubuntu 14.04 LTS (trusty) ã‚’è©¦ã—ã¾ã—ãŸã€‚</p>

<!--more-->


<h2>Vagrantfile ä½œæˆ</h2>

<p>ã¾ãš <code>Vagrantfile</code> ã‚’ä½œæˆã—ã¾ã™ã€‚
box ãƒ•ã‚¡ã‚¤ãƒ«ã® URL ã¯
<a href="https://cloud-images.ubuntu.com/vagrant/trusty/">https://cloud-images.ubuntu.com/vagrant/trusty/</a>
ã‹ã‚‰æ¢ã—ã¾ã™ã€‚
current ã«ã™ã‚‹ã¨ã„ã¤ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚ã‹ã‚Šã«ãã„ã®ã§ã€
æ—¥ä»˜ã® URL ã¨ box åã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚</p>

<p><a href="https://cloud-images.ubuntu.com/vagrant/">https://cloud-images.ubuntu.com/vagrant/</a>
ã«ã¯
<code>Ubuntu Server 14.04 LTS (Trusty Tahr) daily builds</code>
ã¨æ›¸ã„ã¦ã‚ã‚‹ã®ã« 20140417 ã¨ 20140418 ã®å‰ãŒ 20140221 ã¨ 20140222 ã«ãªã£ã¦ã„ã¦
daily ã§ã¯ãªã•ãã†ã«è¦‹ãˆã‚‹ã®ã§ã™ãŒã€
ãƒªãƒªãƒ¼ã‚¹å‰ã¯æ›´æ–°ã‚’æ­¢ã‚ã¦ã„ãŸã ã‘ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> mkdir trusty
</span><span class='line'><span class="gp">%</span> <span class="nb">cd </span>trusty
</span><span class='line'><span class="gp">%</span> vagrant init
</span><span class='line'><span class="go">A `Vagrantfile` has been placed in this directory. You are now</span>
</span><span class='line'><span class="go">ready to `vagrant up` your first virtual environment! Please read</span>
</span><span class='line'><span class="go">the comments in the Vagrantfile as well as documentation on</span>
</span><span class='line'><span class="go">`vagrantup.com` for more information on using Vagrant.</span>
</span><span class='line'><span class="gp">%</span> vi Vagrantfile
</span><span class='line'><span class="go">(config.vm.box ã¨ config.vm.box_url ã‚’è¨­å®š)</span>
</span><span class='line'><span class="gp">%</span> egrep <span class="s1">&#39;^ *[^ #]&#39;</span> Vagrantfile
</span><span class='line'><span class="go">VAGRANTFILE_API_VERSION = &quot;2&quot;</span>
</span><span class='line'><span class="go">Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|</span>
</span><span class='line'><span class="go">  config.vm.box = &quot;trusty-amd64-20140418&quot;</span>
</span><span class='line'><span class="go">  config.vm.box_url = &quot;https://cloud-images.ubuntu.com/vagrant/trusty/20140418/trusty-server-cloudimg-amd64-vagrant-disk1.box&quot;</span>
</span><span class='line'><span class="go">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã“ã®æ®µéšã§ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ã™ã‚Œã°å…ƒã«æˆ»ã›ã¾ã™ã€‚</p>

<h2>box ã®è¿½åŠ ã¨èµ·å‹•</h2>

<p>åˆå›ã® <code>vagrant up</code> ã¯ box ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚‚ã™ã‚‹ã®ã§
æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> vagrant up
</span><span class='line'><span class="go">Bringing machine &#39;default&#39; up with &#39;virtualbox&#39; provider...</span>
</span><span class='line'><span class="go">==&gt; default: Box &#39;trusty-amd64-20140418&#39; could not be found. Attempting to find and install...</span>
</span><span class='line'><span class="go">    default: Box Provider: virtualbox</span>
</span><span class='line'><span class="go">    default: Box Version: &gt;= 0</span>
</span><span class='line'><span class="go">==&gt; default: Adding box &#39;trusty-amd64-20140418&#39; (v0) for provider: virtualbox</span>
</span><span class='line'><span class="go">    default: Downloading: https://cloud-images.ubuntu.com/vagrant/trusty/20140418/trusty-server-cloudimg-amd64-vagrant-disk1.box</span>
</span><span class='line'><span class="go">==&gt; default: Box download is resuming from prior download progress</span>
</span><span class='line'><span class="go">==&gt; default: Successfully added box &#39;trusty-amd64-20140418&#39; (v0) for &#39;virtualbox&#39;!</span>
</span><span class='line'><span class="go">==&gt; default: Importing base box &#39;trusty-amd64-20140418&#39;...</span>
</span><span class='line'><span class="go">==&gt; default: Matching MAC address for NAT networking...</span>
</span><span class='line'><span class="go">==&gt; default: Setting the name of the VM: trusty_default_1397790655665_45006</span>
</span><span class='line'><span class="go">==&gt; default: Clearing any previously set forwarded ports...</span>
</span><span class='line'><span class="go">==&gt; default: Fixed port collision for 22 =&gt; 2222. Now on port 2200.</span>
</span><span class='line'><span class="go">==&gt; default: Clearing any previously set network interfaces...</span>
</span><span class='line'><span class="go">==&gt; default: Preparing network interfaces based on configuration...</span>
</span><span class='line'><span class="go">    default: Adapter 1: nat</span>
</span><span class='line'><span class="go">==&gt; default: Forwarding ports...</span>
</span><span class='line'><span class="go">    default: 22 =&gt; 2200 (adapter 1)</span>
</span><span class='line'><span class="go">==&gt; default: Booting VM...</span>
</span><span class='line'><span class="go">==&gt; default: Waiting for machine to boot. This may take a few minutes...</span>
</span><span class='line'><span class="go">    default: SSH address: 127.0.0.1:2200</span>
</span><span class='line'><span class="go">    default: SSH username: vagrant</span>
</span><span class='line'><span class="go">    default: SSH auth method: private key</span>
</span><span class='line'><span class="go">    default: Warning: Connection timeout. Retrying...</span>
</span><span class='line'><span class="go">    default: Warning: Remote connection disconnect. Retrying...</span>
</span><span class='line'><span class="go">==&gt; default: Machine booted and ready!</span>
</span><span class='line'><span class="go">GuestAdditions 4.3.10 running --- OK.</span>
</span><span class='line'><span class="go">==&gt; default: Checking for guest additions in VM...</span>
</span><span class='line'><span class="go">==&gt; default: Mounting shared folders...</span>
</span><span class='line'><span class="go">    default: /vagrant =&gt; /path/to/trusty</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã“ã®æ®µéšã§ã¯ vagrant box ãŒè¿½åŠ ã•ã‚Œã¦ VM ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã€
å…ƒã«æˆ»ã™ã«ã¯ <code>vagrant destroy</code> ã§ VM ã‚’å‰Šé™¤ã—ã¦ã€
<code>vagrant box remove boxå</code> ã§ box ã‚’å‰Šé™¤ã—ã¾ã™ã€‚</p>

<p>æ™®é€šã¯ <code>vagrant destroy</code> ã§ VM ã‚’ç ´æ£„ã™ã‚‹ã ã‘ã§
box ã¯ä½¿ã„å›ã™ã¨æ€ã„ã¾ã™ã€‚</p>

<p>box ã‚’å…ˆã«å‰Šé™¤ã—ã¦ã—ã¾ã†ã¨ VM ã®å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã‚ˆã†ãªã®ã§ã€
ãã®å ´åˆã¯ GUI ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ã‚‹ãƒ‡ã‚£ã‚¹ã‚¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç„¡è¦–ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ãªã©
ãŒã‚“ã°ã£ã¦å‰Šé™¤ã—ã¾ã™ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OpenSSL/GnuTLS ã§ã® CSR ã®ä½œã‚Šæ–¹]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-16-new-csr.html"/>
    <updated>2014-04-16T10:09:24+09:00</updated>
    <id>http://blog.n-z.jp/blog/new-csr</id>
    <content type="html"><![CDATA[<p>ã‚µãƒ¼ãƒãƒ¼è¨¼æ˜æ›¸ã‚’ç™ºè¡Œã—ã¦ã‚‚ã‚‰ã†æ™‚ãªã©ã«æ¯å›èª¿ã¹ã¤ã¤ CSR ã‚’ä½œæˆã—ã¦ã„ã‚‹ã®ã§ã€
GnuTLS ã¨ OpenSSL ã‚’ä½¿ã£ãŸæ–¹æ³•ã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚</p>

<!--more-->


<h2>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>

<p>OpenSSL ã®æ–¹ã¯å…¥ã£ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ã¨æ€ã„ã¾ã™ãŒã€å…¥ã£ã¦ã„ãªã‘ã‚Œã° <code>openssl</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã„ã‚Œã¦ãŠãã¾ã™ã€‚</p>

<p>GnuTLS ã®æ–¹ã¯ Debian ã‚„ Ubuntu ã®å ´åˆã¯ <code>gnutls-bin</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã« <code>gnutls-cli</code> ã‚³ãƒãƒ³ãƒ‰ãªã©ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚
RHEL ãªã©ã§ã¯ <code>gnutls-utils</code> ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å…¥ã£ã¦ã„ã‚‹ã‚‰ã—ã„ã§ã™ã€‚</p>

<h2>certtool ã‚³ãƒãƒ³ãƒ‰</h2>

<p><code>certtool</code> ã‚³ãƒãƒ³ãƒ‰ã¯ Mac OS X ã«ã‚‚ã‚ã‚Šã¾ã™ãŒã€ GnuTLS ã®ã‚‚ã®ã¨ã¯åˆ¥ç‰©ã§ã™ã€‚
ã“ã“ã§èª¬æ˜ã—ã¦ã„ã‚‹ã®ã¯ GnuTLS ã® <code>certtool</code> ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚</p>

<h2>ç§˜å¯†éµä½œæˆ</h2>

<p>ç§˜å¯†éµã®ç”Ÿæˆã¯ãƒ©ãƒ³ãƒ€ãƒ ãªæƒ…å ±ã‚’å…ƒã«ç”Ÿæˆã™ã‚‹ã®ã§ã€ãƒ“ãƒƒãƒˆæ•°ã‚„ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®é‡ã«å¿œã˜ã¦æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚
ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒã‚·ãƒ³ãªã©ã§ã¯ãƒã‚¦ã‚¹ã‚’å‹•ã‹ã™ãªã©ã®æ–¹æ³•ã§ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’å¢—ã‚„ã™ã“ã¨ãŒå‡ºæ¥ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>

<p>ä½œæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãªã©ã‚’è€ƒãˆã‚‹ã¨æš—å·åŒ–ã—ãªã„ãªã‚‰ GnuTLS ã®
<code>certtool --generate-privkey --bits 4096 --outfile example.key</code>
ã®æ–¹æ³•ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚</p>

<h3>GnuTLS</h3>

<p>GnuTLS ã® <code>certtool</code> ã‚³ãƒãƒ³ãƒ‰ã§ã¯ <code>--generate-privkey</code> ã§ç§˜å¯†éµã‚’ä½œæˆã§ãã¾ã™ã€‚
<code>--bits</code> ã§éµã®ãƒ“ãƒƒãƒˆæ•°ã‚’æŒ‡å®šã—ãªã„ã¨ squeeze ã ã¨ 2048 ãƒ“ãƒƒãƒˆã€ precise ã‚„ wheezy ã ã¨ 2432 ãƒ“ãƒƒãƒˆã«ãªã‚Šã¾ã—ãŸã€‚
ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚‚ <code>-rw-------</code> (600) ã§ä½œæˆã•ã‚Œã‚‹ã®ã§ã€ãã®ã¾ã¾ä½¿ãˆã¾ã™ã€‚</p>

<figure class='code'><figcaption><span>gnutls</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> certtool --generate-privkey --outfile example-tls.key
</span><span class='line'><span class="go">Generating a 2432 bit RSA private key...</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>gnutls</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> certtool --generate-privkey --bits 4096 --outfile example-tls.key
</span><span class='line'><span class="go">Generating a 4096 bit RSA private key...</span>
</span></code></pre></td></tr></table></div></figure>


<h3>OpenSSL</h3>

<p>OpenSSL ã§ã¯ <code>genrsa</code> ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã§ç”Ÿæˆã—ã¾ã™ã€‚
OpenSSL 1.0.0 ã§ã¯ <code>genpkey</code> ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ãŒã€
<code>genrsa</code> ã‚‚ã¾ã ä½¿ãˆã‚‹ã®ã§ã€ä»¥ä¸‹ã¯ <code>genrsa</code> ã ã‘æ›¸ã„ã¦ã„ã¾ã™ã€‚</p>

<p>ãƒ“ãƒƒãƒˆæ•°ã‚’æŒ‡å®šã—ãªã„ã¨ squeeze ã ã¨ 1024 ãƒ“ãƒƒãƒˆã€ precise ã‚„ wheezy ã ã¨ 512 ãƒ“ãƒƒãƒˆã«ãªã‚Šã¾ã—ãŸã€‚
ã¾ãŸã€ãã®ã¾ã¾ã ã¨ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒ <code>-rw-rw-r--</code> (664) ã§ç”Ÿæˆã•ã‚Œã‚‹ã®ã§ã€ã‚ã‚‰ã‹ã˜ã‚ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¦ãŠã„ã¦ä¸Šæ›¸ãã•ã›ã‚‹ã‹ã€ã™ãã« <code>chmod</code> ã§å¤‰æ›´ã—ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚</p>

<figure class='code'><figcaption><span>openssl</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> touch example-ssl.key
</span><span class='line'><span class="gp">$</span> chmod 600 example-ssl.key
</span><span class='line'><span class="gp">$</span> openssl genrsa -out example-ssl.key
</span><span class='line'><span class="go">Generating RSA private key, 512 bit long modulus</span>
</span><span class='line'><span class="go">....++++++++++++</span>
</span><span class='line'><span class="go">.........................++++++++++++</span>
</span><span class='line'><span class="go">e is 65537 (0x10001)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>openssl</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> touch example-ssl.key
</span><span class='line'><span class="gp">$</span> chmod 600 example-ssl.key
</span><span class='line'><span class="gp">$</span> openssl genrsa -out example-ssl.key 4096
</span><span class='line'><span class="go">Generating RSA private key, 4096 bit long modulus</span>
</span><span class='line'><span class="go">......................................................++</span>
</span><span class='line'><span class="go">...........++</span>
</span><span class='line'><span class="go">e is 65537 (0x10001)</span>
</span></code></pre></td></tr></table></div></figure>


<p>ãƒãƒƒãƒˆä¸Šè¦‹ã¤ã‹ã‚‹æƒ…å ±ã§ã¯ <code>-des3</code> ãªã©ã§ç”Ÿæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€åº¦æš—å·åŒ–ã—ã¦ã€
ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•æ™‚ã«ä¸è¦ã«ãªã‚‹ã‚ˆã†ã«ã™ãã«å¤–ã™ã‚ˆã†ãªä¾‹ã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€
ãã‚“ãªã“ã¨ã‚’ã™ã‚‹ãã‚‰ã„ãªã‚‰æœ€åˆã‹ã‚‰æš—å·åŒ–ã›ãšã«ç”Ÿæˆã™ã‚Œã°è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</p>

<p>æš—å·åŒ–ã—ãŸçŠ¶æ…‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¥é€”ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹ãªã©ã®ç›®çš„ãŒã‚ã‚‹ã®ãªã‚‰ã€
æ„å‘³ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ãŒã€
æš—å·åŒ–ã—ãŸçŠ¶æ…‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®‹ã•ãªã„ã®ãªã‚‰å˜ãªã‚‹ç„¡é§„ã ã¨æ€ã„ã¾ã™ã€‚</p>

<h2>ç§˜å¯†éµã®å†…å®¹ç¢ºèª</h2>

<p>ç§˜å¯†éµã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã¯ã‚ã¾ã‚Šãªã„ã¨æ€ã„ã¾ã™ãŒã€
<code>openssl rsa -in example.key -text -noout</code>
ã®æ–¹æ³•ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚</p>

<h3>OpenSSL</h3>

<p>OpenSSL ã§ç§˜å¯†éµã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã«ã¯ <code>rsa</code> ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã„ã¾ã™ã€‚
<code>-text</code> ã§å†…å®¹å…¨ä½“ã®è¡¨ç¤ºã§ <code>-noout</code> ã¯ <code>-----BEGIN RSA PRIVATE KEY-----</code> ã‹ã‚‰ <code>-----END RSA PRIVATE KEY-----</code> ã‚’è¡¨ç¤ºã—ãªã„ã¨ã„ã†æ„å‘³ã§ã™ã€‚
ç§˜å¯†éµæœ¬ä½“ã®å‰ã«ãƒ†ã‚­ã‚¹ãƒˆã®èª¬æ˜ãŒã¤ã„ãŸã‚‚ã®ã‚‚å…ƒã®ç§˜å¯†éµã¨åŒæ§˜ã«æ‰±ãˆã‚‹ã‚ˆã†ãªã®ã§ã€
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯å…ƒã®å†…å®¹ã‚‚å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã ã¨æ€ã„ã¾ã™ã€‚</p>

<figure class='code'><figcaption><span>openssl</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> openssl rsa -in example-ssl.key -text -noout
</span><span class='line'><span class="go">Private-Key: (4096 bit)</span>
</span><span class='line'><span class="go">modulus:</span>
</span><span class='line'><span class="go">    00:cb:35:ec:f6:00:5a:75:d7:55:14:f8:55:91:1a:</span>
</span><span class='line'><span class="go"> (ç•¥)</span>
</span><span class='line'><span class="go">publicExponent: 65537 (0x10001)</span>
</span><span class='line'><span class="go">privateExponent:</span>
</span><span class='line'><span class="go">    4d:86:de:47:a0:2c:e2:e6:6b:2c:5b:ed:f1:35:10:</span>
</span><span class='line'><span class="go"> (ç•¥)</span>
</span><span class='line'><span class="go">prime1:</span>
</span><span class='line'><span class="go">    00:ef:49:b3:f8:4c:1e:a9:13:a9:fb:86:7e:80:7a:</span>
</span><span class='line'><span class="go"> (ç•¥)</span>
</span><span class='line'><span class="go">prime2:</span>
</span><span class='line'><span class="go">    00:d9:67:2f:e1:4c:13:78:fa:dd:2b:7a:3e:f5:68:</span>
</span><span class='line'><span class="go"> (ç•¥)</span>
</span><span class='line'><span class="go">exponent1:</span>
</span><span class='line'><span class="go">    00:ba:18:ee:ff:a7:6b:9d:01:2f:0c:f0:0f:88:29:</span>
</span><span class='line'><span class="go"> (ç•¥)</span>
</span><span class='line'><span class="go">exponent2:</span>
</span><span class='line'><span class="go">    52:93:94:27:32:5b:4f:1f:92:74:9a:39:61:c3:ae:</span>
</span><span class='line'><span class="go"> (ç•¥)</span>
</span><span class='line'><span class="go">coefficient:</span>
</span><span class='line'><span class="go">    44:e9:a2:de:87:e7:2d:f0:57:58:d6:fc:85:20:df:</span>
</span><span class='line'><span class="go"> (ç•¥)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>GnuTLS</h3>

<p>GnuTLS ã® <code>certtool</code> ã§ç§˜å¯†éµã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã«ã¯ <code>-k</code> (<code>--key-info</code>) ã‚’ä½¿ã„ã¾ã™ã€‚
<code>openssl</code> ã® <code>-noout</code> ç›¸å½“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯è¦‹ã¤ã‘ã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>gnutls</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> certtool -k --infile example-tls.key
</span><span class='line'><span class="go">Public Key Info:</span>
</span><span class='line'><span class="go">        Public Key Algorithm: RSA</span>
</span><span class='line'><span class="go">        Key Security Level: High</span>
</span><span class='line'><span class="go">modulus:</span>
</span><span class='line'><span class="go">        00:da:45:da:ca:13:ac:59:43:55:87:68:04:16:1a:</span>
</span><span class='line'><span class="go">     (ç•¥)</span>
</span><span class='line'><span class="go">public exponent:</span>
</span><span class='line'><span class="go">        01:00:01:</span>
</span><span class='line'><span class="go">private exponent:</span>
</span><span class='line'><span class="go">        3c:5b:18:96:cc:3d:da:28:fe:5b:84:ed:ac:56:e2:</span>
</span><span class='line'><span class="go">     (ç•¥)</span>
</span><span class='line'><span class="go">prime1:</span>
</span><span class='line'><span class="go">        00:dc:f3:92:13:d5:c7:cf:bc:9f:76:b3:f6:a2:60:</span>
</span><span class='line'><span class="go">     (ç•¥)</span>
</span><span class='line'><span class="go">prime2:</span>
</span><span class='line'><span class="go">        00:fc:e5:83:0e:2e:d4:a1:be:37:bf:05:6e:c3:d3:</span>
</span><span class='line'><span class="go">     (ç•¥)</span>
</span><span class='line'><span class="go">coefficient:</span>
</span><span class='line'><span class="go">        63:74:e3:95:9e:d6:6c:7d:d9:2d:ad:45:f8:0b:1a:</span>
</span><span class='line'><span class="go">     (ç•¥)</span>
</span><span class='line'><span class="go">exp1:</span>
</span><span class='line'><span class="go">        00:a1:1d:a7:9e:79:1c:2b:da:42:79:bf:7f:10:26:</span>
</span><span class='line'><span class="go">     (ç•¥)</span>
</span><span class='line'><span class="go">exp2:</span>
</span><span class='line'><span class="go">        00:b3:be:9c:ab:53:f5:a5:10:01:a7:2f:41:4e:c5:</span>
</span><span class='line'><span class="go">     (ç•¥)</span>
</span><span class='line'><span class="go">        c4:31:</span>
</span><span class='line'>
</span><span class='line'><span class="go">Public Key ID: 45:44:BC:C4:BB:95:24:97:5D:C2:95:BF:27:95:02:2C:50:09:9E:35</span>
</span><span class='line'>
</span><span class='line'><span class="go">-----BEGIN RSA PRIVATE KEY-----</span>
</span><span class='line'><span class="go">(ç•¥)</span>
</span><span class='line'><span class="go">-----END RSA PRIVATE KEY-----</span>
</span></code></pre></td></tr></table></div></figure>


<h2>CSR ä½œæˆã¨å†…å®¹ç¢ºèª</h2>

<p>OpenSSL ã¯ <code>openssl req</code> ã§ä½œæˆã‚‚å†…å®¹ã®ç¢ºèªã‚‚å‡ºæ¥ã¾ã™ã€‚
GnuTLS ã® <code>certtool</code> ã¯ <code>-q</code> (<code>--generate-request</code>) ã§ä½œæˆã—ã¦
<code>--crq-info</code> ã§å†…å®¹ã‚’ç¢ºèªã§ãã¾ã™ã€‚</p>

<p>ä»¥ä¸‹ã®ä¾‹ã§ã¯ãã‚Œãã‚Œã§ä½œæˆã—ã¦ã€ä¸¡æ–¹ã§å†…å®¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚</p>

<h3>OpenSSL</h3>

<p>OpenSSL ã§ã¯ <code>C</code> ã¨ <code>ST</code> ã¨ <code>O</code> ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒå…¥ã£ã¦ã„ã¦ã€
å¯¾è©±çš„ã«ä½œæˆã—ã¤ã¤ç©ºæ¬„ã«ã—ãŸã„æ™‚ã¯
åˆ¥é€” <code>openssl.cnf</code> ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚</p>

<figure class='code'><figcaption><span>openssl</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> openssl req -new -key example-ssl.key -out example-ssl.csr
</span><span class='line'><span class="go">You are about to be asked to enter information that will be incorporated</span>
</span><span class='line'><span class="go">into your certificate request.</span>
</span><span class='line'><span class="go">What you are about to enter is what is called a Distinguished Name or a DN.</span>
</span><span class='line'><span class="go">There are quite a few fields but you can leave some blank</span>
</span><span class='line'><span class="go">For some fields there will be a default value,</span>
</span><span class='line'><span class="go">If you enter &#39;.&#39;, the field will be left blank.</span>
</span><span class='line'><span class="go">-----</span>
</span><span class='line'><span class="go">Country Name (2 letter code) [AU]:JP</span>
</span><span class='line'><span class="go">State or Province Name (full name) [Some-State]:Osaka</span>
</span><span class='line'><span class="go">Locality Name (eg, city) []:</span>
</span><span class='line'><span class="go">Organization Name (eg, company) [Internet Widgits Pty Ltd]:</span>
</span><span class='line'><span class="go">Organizational Unit Name (eg, section) []:</span>
</span><span class='line'><span class="go">Common Name (e.g. server FQDN or YOUR name) []:ssl.example.jp</span>
</span><span class='line'><span class="go">Email Address []:</span>
</span><span class='line'>
</span><span class='line'><span class="go">Please enter the following &#39;extra&#39; attributes</span>
</span><span class='line'><span class="go">to be sent with your certificate request</span>
</span><span class='line'><span class="go">A challenge password []:</span>
</span><span class='line'><span class="go">An optional company name []:</span>
</span><span class='line'><span class="gp">$</span> openssl req -in example-ssl.csr -text -noout
</span><span class='line'><span class="go">Certificate Request:</span>
</span><span class='line'><span class="go">    Data:</span>
</span><span class='line'><span class="go">        Version: 0 (0x0)</span>
</span><span class='line'><span class="go">        Subject: C=JP, ST=Osaka, O=Internet Widgits Pty Ltd, CN=ssl.example.jp</span>
</span><span class='line'><span class="go">        Subject Public Key Info:</span>
</span><span class='line'><span class="go">            Public Key Algorithm: rsaEncryption</span>
</span><span class='line'><span class="go">                Public-Key: (4096 bit)</span>
</span><span class='line'><span class="go">                Modulus:</span>
</span><span class='line'><span class="go">                    00:cb:35:ec:f6:00:5a:75:d7:55:14:f8:55:91:1a:</span>
</span><span class='line'><span class="go">                 (ç•¥)</span>
</span><span class='line'><span class="go">                Exponent: 65537 (0x10001)</span>
</span><span class='line'><span class="go">        Attributes:</span>
</span><span class='line'><span class="go">            a0:00</span>
</span><span class='line'><span class="go">    Signature Algorithm: sha1WithRSAEncryption</span>
</span><span class='line'><span class="go">         4f:1a:a7:57:9f:88:f3:17:23:aa:51:12:11:ff:c0:24:31:4c:</span>
</span><span class='line'><span class="go">      (ç•¥)</span>
</span><span class='line'><span class="gp">$</span> certtool --crq-info --infile example-ssl.csr
</span><span class='line'><span class="go">PKCS #10 Certificate Request Information:</span>
</span><span class='line'><span class="go">        Version: 1</span>
</span><span class='line'><span class="go">        Subject: C=JP,ST=Osaka,O=Internet Widgits Pty Ltd,CN=ssl.example.jp</span>
</span><span class='line'><span class="go">        Subject Public Key Algorithm: RSA</span>
</span><span class='line'><span class="go">                Modulus (bits 4096):</span>
</span><span class='line'><span class="go">                        cb:35:ec:f6:00:5a:75:d7:55:14:f8:55:91:1a:9b:83</span>
</span><span class='line'><span class="go">                     (ç•¥)</span>
</span><span class='line'><span class="go">                Exponent:</span>
</span><span class='line'><span class="go">                        01:00:01</span>
</span><span class='line'><span class="go">Other Information:</span>
</span><span class='line'><span class="go">        Public Key Id:</span>
</span><span class='line'><span class="go">                c14459bdb79e6b71e6303e4ffd9c7ab43dc9b9df</span>
</span><span class='line'>
</span><span class='line'><span class="go">-----BEGIN NEW CERTIFICATE REQUEST-----</span>
</span><span class='line'><span class="go">(ç•¥)</span>
</span><span class='line'><span class="go">-----END NEW CERTIFICATE REQUEST-----</span>
</span></code></pre></td></tr></table></div></figure>


<h3>GnuTLS</h3>

<p>GnuTLS ã§ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãŠã„ã¦ <code>--template</code> ã§æŒ‡å®šã™ã‚‹æ–¹æ³•ãŒå¤šã„ã‚ˆã†ã§ã™ãŒã€
å¯¾è©±çš„ã«ã‚‚ä½œæˆã§ãã¾ã—ãŸã€‚
<code>Subject</code> ã‚’ <code>CN</code> ã ã‘ã«ã™ã‚‹ã®ã¯ OpenSSL ã‚ˆã‚Šç°¡å˜ã«å‡ºæ¥ãŸã®ã§ã™ãŒã€
<code>Requested Extensions</code> ãŒè¨­å®šã•ã‚Œã‚‹ã‚ˆã†ãªã®ã§ã€
ä¸è¦ãªå ´åˆã«ã¯å›°ã‚Šãã†ã§ã™ã€‚</p>

<figure class='code'><figcaption><span>gnutls</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> certtool -q --load-privkey example-tls.key --outfile example-tls.csr
</span><span class='line'><span class="go">Generating a PKCS #10 certificate request...</span>
</span><span class='line'><span class="go">Country name (2 chars):</span>
</span><span class='line'><span class="go">Organization name:</span>
</span><span class='line'><span class="go">Organizational unit name:</span>
</span><span class='line'><span class="go">Locality name:</span>
</span><span class='line'><span class="go">State or province name:</span>
</span><span class='line'><span class="go">Common name: tls.example.jp</span>
</span><span class='line'><span class="go">UID:</span>
</span><span class='line'><span class="go">Enter a dnsName of the subject of the certificate:</span>
</span><span class='line'><span class="go">Enter the IP address of the subject of the certificate:</span>
</span><span class='line'><span class="go">Enter the e-mail of the subject of the certificate:</span>
</span><span class='line'><span class="go">Enter a challenge password:</span>
</span><span class='line'><span class="go">Does the certificate belong to an authority? (y/N):</span>
</span><span class='line'><span class="go">Will the certificate be used for signing (DHE and RSA-EXPORT ciphersuites)? (y/N):</span>
</span><span class='line'><span class="go">Will the certificate be used for encryption (RSA ciphersuites)? (y/N):</span>
</span><span class='line'><span class="go">Is this a TLS web client certificate? (y/N):</span>
</span><span class='line'><span class="go">Is this also a TLS web server certificate? (y/N):</span>
</span><span class='line'><span class="gp">$</span> openssl req -in example-tls.csr -text -noout
</span><span class='line'><span class="go">Certificate Request:</span>
</span><span class='line'><span class="go">    Data:</span>
</span><span class='line'><span class="go">        Version: 0 (0x0)</span>
</span><span class='line'><span class="go">        Subject: CN=tls.example.jp</span>
</span><span class='line'><span class="go">        Subject Public Key Info:</span>
</span><span class='line'><span class="go">            Public Key Algorithm: rsaEncryption</span>
</span><span class='line'><span class="go">                Public-Key: (4096 bit)</span>
</span><span class='line'><span class="go">                Modulus:</span>
</span><span class='line'><span class="go">                    00:da:45:da:ca:13:ac:59:43:55:87:68:04:16:1a:</span>
</span><span class='line'><span class="go">                 (ç•¥)</span>
</span><span class='line'><span class="go">                Exponent: 65537 (0x10001)</span>
</span><span class='line'><span class="go">        Attributes:</span>
</span><span class='line'><span class="go">        Requested Extensions:</span>
</span><span class='line'><span class="go">            X509v3 Basic Constraints: critical</span>
</span><span class='line'><span class="go">                CA:FALSE</span>
</span><span class='line'><span class="go">            X509v3 Key Usage: critical</span>
</span><span class='line'><span class="go">                Digital Signature</span>
</span><span class='line'><span class="go">    Signature Algorithm: sha1WithRSAEncryption</span>
</span><span class='line'><span class="go">         cb:71:d2:c9:a2:97:14:74:f0:63:69:6b:36:31:ff:ce:f2:a0:</span>
</span><span class='line'><span class="go">      (ç•¥)</span>
</span><span class='line'><span class="gp">$</span> certtool --crq-info --infile example-tls.csr
</span><span class='line'><span class="go">PKCS #10 Certificate Request Information:</span>
</span><span class='line'><span class="go">        Version: 1</span>
</span><span class='line'><span class="go">        Subject: CN=tls.example.jp</span>
</span><span class='line'><span class="go">        Subject Public Key Algorithm: RSA</span>
</span><span class='line'><span class="go">                Modulus (bits 4096):</span>
</span><span class='line'><span class="go">                        da:45:da:ca:13:ac:59:43:55:87:68:04:16:1a:09:41</span>
</span><span class='line'><span class="go">                     (ç•¥)</span>
</span><span class='line'><span class="go">                Exponent:</span>
</span><span class='line'><span class="go">                        01:00:01</span>
</span><span class='line'><span class="go">        Attributes:</span>
</span><span class='line'><span class="go">                Extensions:</span>
</span><span class='line'><span class="go">                        Basic Constraints (critical):</span>
</span><span class='line'><span class="go">                                Certificate Authority (CA): FALSE</span>
</span><span class='line'><span class="go">                        Key Usage (critical):</span>
</span><span class='line'><span class="go">                                Digital signature.</span>
</span><span class='line'><span class="go">Other Information:</span>
</span><span class='line'><span class="go">        Public Key Id:</span>
</span><span class='line'><span class="go">                4544bcc4bb9524975dc295bf2795022c50099e35</span>
</span><span class='line'>
</span><span class='line'><span class="go">-----BEGIN NEW CERTIFICATE REQUEST-----</span>
</span><span class='line'><span class="go">(ç•¥)</span>
</span><span class='line'><span class="go">-----END NEW CERTIFICATE REQUEST-----</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ã¾ã¨ã‚ã¦ä½œæˆ</h2>

<p>CSR ã®ç”Ÿæˆã®æ™‚ã«ç§˜å¯†éµã‚’æŒ‡å®šã—ãªã„ã¨ã€
CSR ã¨ä¸€ç·’ã«ç§˜å¯†éµã‚’ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã§ã™ã€‚</p>

<h3>OpenSSL</h3>

<p><code>openssl req -new</code> ã§ <code>-key</code> ã®ä»£ã‚ã‚Šã« <code>-newkey</code> ãªã©ã‚’æŒ‡å®šã™ã‚‹ã¨ CSR ã¨ä¸€ç·’ã«ç§˜å¯†éµã‚‚ç”Ÿæˆã§ãã¾ã™ã€‚
ã“ã®å ´åˆã‚‚ãã®ã¾ã¾ã ã¨ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒ <code>-rw-rw-r--</code> (664) ã«ãªã‚‹ã‚ˆã†ãªã®ã§ã€æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
<code>-nodes</code> ã‚’ä»˜ã‘ãªã„ã¨æš—å·åŒ–ã™ã‚‹ãŸã‚ã®ãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’è¦æ±‚ã•ã‚Œã¾ã™ã€‚</p>

<figure class='code'><figcaption><span>openssl</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> openssl req -new -newkey rsa:4096 -nodes -keyout server.key -out server.csr
</span><span class='line'><span class="go">Generating a 4096 bit RSA private key</span>
</span><span class='line'><span class="go">.............................................................................................................................................................................................................................................................................................................................................++</span>
</span><span class='line'><span class="go">......++</span>
</span><span class='line'><span class="go">writing new private key to &#39;server.key&#39;</span>
</span><span class='line'><span class="go">-----</span>
</span><span class='line'><span class="go">You are about to be asked to enter information that will be incorporated</span>
</span><span class='line'><span class="go">into your certificate request.</span>
</span><span class='line'><span class="go">What you are about to enter is what is called a Distinguished Name or a DN.</span>
</span><span class='line'><span class="go">There are quite a few fields but you can leave some blank</span>
</span><span class='line'><span class="go">For some fields there will be a default value,</span>
</span><span class='line'><span class="go">If you enter &#39;.&#39;, the field will be left blank.</span>
</span><span class='line'><span class="go">-----</span>
</span><span class='line'><span class="go">Country Name (2 letter code) [AU]:JP</span>
</span><span class='line'><span class="go">State or Province Name (full name) [Some-State]:Osaka</span>
</span><span class='line'><span class="go">Locality Name (eg, city) []:</span>
</span><span class='line'><span class="go">Organization Name (eg, company) [Internet Widgits Pty Ltd]:</span>
</span><span class='line'><span class="go">Organizational Unit Name (eg, section) []:</span>
</span><span class='line'><span class="go">Common Name (e.g. server FQDN or YOUR name) []:ssl.example.jp</span>
</span><span class='line'><span class="go">Email Address []:</span>
</span><span class='line'>
</span><span class='line'><span class="go">Please enter the following &#39;extra&#39; attributes</span>
</span><span class='line'><span class="go">to be sent with your certificate request</span>
</span><span class='line'><span class="go">A challenge password []:</span>
</span><span class='line'><span class="go">An optional company name []:</span>
</span></code></pre></td></tr></table></div></figure>


<h3>GnuTLS</h3>

<p><code>certtool -q</code> ã§ <code>--load-privkey</code> ã‚’æŒ‡å®šã—ãªã„ã¨ç§˜å¯†éµã‚‚ä¸€ç·’ã«ç”Ÿæˆã™ã‚‹ã‚ˆã†ã§ã™ã€‚
å‡ºåŠ›ã¯ <code>--outfile</code> ã§æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã¦å…¥ã£ã¦ã—ã¾ã£ã¦ã€
ä½¿ã„å‹æ‰‹ã¯è‰¯ããªã„ã®ã§ã€å€‹åˆ¥ã«ç”Ÿæˆã—ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚</p>

<figure class='code'><figcaption><span>gnutls</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> certtool -q --outfile out.txt
</span><span class='line'><span class="go">Generating a PKCS #10 certificate request...</span>
</span><span class='line'><span class="go">Generating a 2432 bit RSA private key...</span>
</span><span class='line'><span class="go">Country name (2 chars):</span>
</span><span class='line'><span class="go">Organization name:</span>
</span><span class='line'><span class="go">Organizational unit name:</span>
</span><span class='line'><span class="go">Locality name:</span>
</span><span class='line'><span class="go">State or province name:</span>
</span><span class='line'><span class="go">Common name: tls.example.jp</span>
</span><span class='line'><span class="go">UID:</span>
</span><span class='line'><span class="go">Enter a dnsName of the subject of the certificate:</span>
</span><span class='line'><span class="go">Enter the IP address of the subject of the certificate:</span>
</span><span class='line'><span class="go">Enter the e-mail of the subject of the certificate:</span>
</span><span class='line'><span class="go">Enter a challenge password:</span>
</span><span class='line'><span class="go">Does the certificate belong to an authority? (y/N):</span>
</span><span class='line'><span class="go">Will the certificate be used for signing (DHE and RSA-EXPORT ciphersuites)? (y/N):</span>
</span><span class='line'><span class="go">Will the certificate be used for encryption (RSA ciphersuites)? (y/N):</span>
</span><span class='line'><span class="go">Is this a TLS web client certificate? (y/N):</span>
</span><span class='line'><span class="go">Is this also a TLS web server certificate? (y/N):</span>
</span><span class='line'><span class="gp">$</span> cat out.txt
</span><span class='line'><span class="go">-----BEGIN RSA PRIVATE KEY-----</span>
</span><span class='line'><span class="go">(ç•¥)</span>
</span><span class='line'><span class="go">-----END RSA PRIVATE KEY-----</span>
</span><span class='line'><span class="go">PKCS #10 Certificate Request Information:</span>
</span><span class='line'><span class="go">        Version: 1</span>
</span><span class='line'><span class="go">        Subject: CN=tls.example.jp</span>
</span><span class='line'><span class="go">        Subject Public Key Algorithm: RSA</span>
</span><span class='line'><span class="go">                Modulus (bits 2432):</span>
</span><span class='line'><span class="go">                        f4:ff:66:e8:c6:19:ab:7b:39:e3:72:ff:ee:13:fa:cf</span>
</span><span class='line'><span class="go">                     (ç•¥)</span>
</span><span class='line'><span class="go">                Exponent:</span>
</span><span class='line'><span class="go">                        01:00:01</span>
</span><span class='line'><span class="go">        Attributes:</span>
</span><span class='line'><span class="go">                Extensions:</span>
</span><span class='line'><span class="go">                        Basic Constraints (critical):</span>
</span><span class='line'><span class="go">                                Certificate Authority (CA): FALSE</span>
</span><span class='line'><span class="go">                        Key Usage (critical):</span>
</span><span class='line'><span class="go">                                Digital signature.</span>
</span><span class='line'><span class="go">Other Information:</span>
</span><span class='line'><span class="go">        Public Key Id:</span>
</span><span class='line'><span class="go">                61c9cef12d691e3373f71ad3a82d1ac4c4b71793</span>
</span><span class='line'>
</span><span class='line'><span class="go">-----BEGIN NEW CERTIFICATE REQUEST-----</span>
</span><span class='line'><span class="go">(ç•¥)</span>
</span><span class='line'><span class="go">-----END NEW CERTIFICATE REQUEST-----</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç¬¬3å› ã‚³ãƒ³ãƒ†ãƒŠå‹ä»®æƒ³åŒ–ã®æƒ…å ±äº¤æ›ä¼šï¼ å¤§é˜ª (ã‚³ãƒ³ãƒ†ãƒŠå‹VMã‚„é–¢é€£ã™ã‚‹ã‚«ãƒ¼ãƒãƒ«ç­‰ã®æŠ€è¡“ãŒè©±é¡Œã®å‹‰å¼·ä¼š)ã«å‚åŠ ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-12-lxcjp.html"/>
    <updated>2014-04-12T22:23:56+09:00</updated>
    <id>http://blog.n-z.jp/blog/lxcjp</id>
    <content type="html"><![CDATA[<p><a href="http://atnd.org/events/46446">ç¬¬3å› ã‚³ãƒ³ãƒ†ãƒŠå‹ä»®æƒ³åŒ–ã®æƒ…å ±äº¤æ›ä¼šï¼ å¤§é˜ª (ã‚³ãƒ³ãƒ†ãƒŠå‹VMã‚„é–¢é€£ã™ã‚‹ã‚«ãƒ¼ãƒãƒ«ç­‰ã®æŠ€è¡“ãŒè©±é¡Œã®å‹‰å¼·ä¼š)</a>
ã«å‚åŠ ã—ã¦ãã¾ã—ãŸã€‚</p>

<!--more-->


<h2>å…¨ä½“ã®æ„Ÿæƒ³</h2>

<p>å…¨ä½“çš„ã«ã¯ LXC ã‚„ Docker ã«é™ã‚‰ãšã€
Hyper-V ä¸Šã§ã® FreeBSD jail ã®è©±ã‚„ Vagrant ã‚„ CircleCI (LXC ã‚’ä½¿ã£ã¦ã„ã‚‹) ãªã©ã®è©±ã‚‚ã‚ã£ã¦ã€é¢ç™½ã‹ã£ãŸã§ã™ã€‚</p>

<h2>ä¼šå ´</h2>

<p>ã¡ã‚‡ã£ã¨æ—©ã‚ã«å‡ºç™ºã—ã¦ã€æ¢…ç”°ã‹ã‚‰é›£æ³¢æ©‹ã‚’é€šã£ã¦å ºç­‹ã‚’é€šã£ã¦ä¼šå ´ã¾ã§æ­©ã„ã¦ã„ãã¾ã—ãŸã€‚
å ´æ‰€ã‚‚ã‚ã‹ã‚Šã‚„ã™ãã¦äº¤å·®ç‚¹ã®åå‰ã¨ç›®çš„åœ°ã®ãƒ“ãƒ«ã®åå‰ã‚’ã¡ã‚ƒã‚“ã¨ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã‚Œã°è¿·ã‚ãšã«ãŸã©ã‚Šç€ã‘ã¾ã—ãŸã€‚</p>

<p>ä¼šå ´ç„¡ç·š LAN ãŒã‚ã£ãŸã®ã§ã™ãŒã€
æœ€åˆã«æ¥ç¶šã—ãŸ MacBook Air ã¯å•é¡Œãªãç¹‹ãŒã£ã¦ã„ãŸã®ã§ã™ãŒã€
å¾Œã‹ã‚‰è¿½åŠ ã§ã¤ãªã”ã†ã¨ã—ãŸ iPod touch ã¯ç„¡ç·š LAN è‡ªä½“ã¯ç¹‹ãŒã£ã¦ã„ã‚‹ã®ã« APIPA ã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãªã£ã¦ã„ã¦ã€
DHCP ã®å‰²ã‚Šå½“ã¦ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒè¶³ã‚Šãªã‹ã£ãŸã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã—ãŸã€‚</p>

<h2>LXC</h2>

<p>ã„ã‚ã„ã‚ã¨çŸ¥ã‚‰ãªã„ã“ã¨ã‚‚å¤šãã¦å‹‰å¼·ã«ãªã£ãŸã®ã§ã™ãŒã€ç‰¹ã« <code>veth</code> ã¨ <code>macvlan</code> ã®é•ã„ãŒã‚ˆãã‚ã‹ã£ã¦ã„ãªã‹ã£ãŸã®ã§ã€
<code>veth</code> ã¯ä½œæˆã—ãŸã ã‘ã ã¨é€šä¿¡ã«ä½¿ãˆãªãã¦ãƒšã‚¢ã®ç‰‡æ–¹ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã«å…¥ã‚Œãªã„ã¨ä½¿ãˆãªã„ã¨ã„ã†ã‚³ãƒ³ãƒ†ãƒŠç”¨ã®æ©Ÿèƒ½ã§ã€
<code>macvlan</code> ã¯ç‰©ç† NIC ã«åˆ¥ MAC ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä»˜ã‘ã¦ä½¿ã†ã‚‚ã®ã€
ã¨ã„ã†ã®ãŒã‚ã‹ã£ã¦è‰¯ã‹ã£ãŸã§ã™ã€‚</p>

<p>LXC ã¨ã„ã†è¨€è‘‰ãŒã•ã™ã‚‚ã®ãŒã€Œã‚«ãƒ¼ãƒãƒ«ã®ã‚³ãƒ³ãƒ†ãƒŠæ©Ÿèƒ½ã€ã®ã¨ãã¨ã€Œ<code>lxc-start</code> ãªã©ã® LXC ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ©ãƒ³ãƒ‰ã€ã®ã“ã¨ãŒã‚ã‚‹ã€ã¨ã„ã†ã®ã¯æ°—ã‚’ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨æ€ã„ã¾ã—ãŸã€‚
ãŸã¨ãˆã° Docker 0.9 ã§ LXC ã¸ã®ä¾å­˜ãŒãªããªã£ãŸã¨ã„ã†ã®ã¯ <code>lxc-start</code> ãªã©ã‚’ä½¿ã‚ãªããªã£ã¦ã€ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ <code>libcontainer</code> ã¨ã„ã†åˆ¥ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ç›´æ¥å‘¼ã‚“ã§ã‚«ãƒ¼ãƒãƒ«ã®ã‚³ãƒ³ãƒ†ãƒŠæ©Ÿèƒ½ã‚’ä½¿ã†ã‚ˆã†ã«ãªã£ãŸãªã©ã€‚</p>

<h2>FreeBSD jail</h2>

<p>jail ã«ã¤ã„ã¦ã¯å­˜åœ¨ã¯çŸ¥ã£ã¦ã„ãŸã®ã§ã™ãŒã€ä½¿ã£ãŸã“ã¨ã¯ãªã‹ã£ãŸã®ã§ã€ãã†ã„ã†ã‚‚ã®ãªã®ã‹ã¨æ€ã£ã¦ã¿ã¦ã„ã¾ã—ãŸã€‚</p>

<h2>Vagrantãƒ¦ãƒ¼ã‚¶ã®ãŸã‚ã®Dockerå…¥é–€</h2>

<p>é€”ä¸­ã®è³ªå•ã«ã‚ã£ãŸ container ã¨ image ã®é•ã„ã§
<a href="http://docs.docker.io/en/latest/terms/image/">http://docs.docker.io/en/latest/terms/image/</a>
ã«æ›¸ã„ã¦ã‚ã‚‹
<code>In Docker terminology, a read-only Layer is called an image. An image never changes.</code>
ãŒæ ¹æ‹ ã ã¨æ€ã†ã®ã§ã™ãŒã€
ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã‚³ãƒ³ãƒ†ãƒŠã«åå‰ã‚’ã¤ã‘ã¦ãƒªãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ¼ã«ã—ãŸã‚‚ã®ã€ã¨ã„ã†èª¬æ˜ã§
ä»Šã¾ã§æ›–æ˜§ã«ã—ã¦ã„ãŸé•ã„ãŒã¡ã‚ƒã‚“ã¨ã‚ã‹ã£ãŸã‚ˆã†ã«æ€ã„ã¾ã—ãŸã€‚</p>

<p>ã“ã®ãƒ–ãƒ­ã‚°ã® Docker é–¢é€£è¨˜äº‹ã®ä¸­ã§ä¸€ç•ªäººæ°—ã®
<a href="http://blog.n-z.jp/blog/2013-12-24-docker-rm.html">Dockerã§ä¸è¦ã«ãªã£ãŸã‚³ãƒ³ãƒ†ãƒŠã‚„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å‰Šé™¤ã™ã‚‹</a>
ã§å‰²ã¨ã‚³ãƒ³ãƒ†ãƒŠã¨ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ›–æ˜§ãªæ„Ÿã˜ã§æ›¸ã„ã¦ã„ã‚‹ã®ã¯ã€ã¯ã£ãã‚Šã¨ã¯åŒºåˆ¥ã§ãã¦ã„ãªã‹ã£ãŸã‹ã‚‰ã§ã—ãŸã€‚</p>

<p>Vagrant ã¨ã®ä½¿ã„åˆ†ã‘ã‚‚å®Ÿéš›ã«ä¸¡æ–¹ä½¿ã£ã¦ã„ã‚‹äººã®è©±ã ã£ãŸã®ã§ã€éå¸¸ã«å‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚
åŸºæœ¬çš„ã«ã¯ Vagrant ã‚‚ Docker ã‚‚é–‹ç™ºç’°å¢ƒã¨ã—ã¦ä½¿ã†ã¨ã„ã†è©±ã§ã—ãŸã€‚</p>

<h2>Dockeré‹ç”¨ã®è¦³ç‚¹ã‹ã‚‰ã¿ãŸLXC</h2>

<p>ã„ã‚ã„ã‚ãªè©±ãŒã‚ã‚Šã¾ã—ãŸã€‚
åŸºæœ¬çš„ã«ã¯ production ç’°å¢ƒã¨ã—ã¦ä½¿ã†è©±ã§ã—ãŸã€‚</p>

<h2>Docker ã® layer æ•°åˆ¶é™ã®è©±</h2>

<p>ä¼‘æ†©æ™‚é–“ã«è©±ã‚’ã—ã¦ã„ãŸã®ã§ã™ãŒ layer ã®åˆ¶é™ãŒ 42 ã‹ã‚‰ 127 ã«å¢—ãˆãŸã®ã¯
<a href="https://github.com/dotcloud/docker/pull/2897">Increase max image depth to 127</a>
ã‹ã‚‰ã§ã€
ç†ç”±ã¯ aufs ã®æ–¹ã§ <code>CONFIG_AUFS_BRANCH_MAX_127</code> ã¨ã„ã†è¨­å®šã‚’ <code>y</code> ã«ã™ã‚‹ã¨
åˆ¶é™ãŒ 127 ã«ãªã‚‹ã‹ã‚‰ã€ã¨ã„ã†ã“ã¨ã®ã‚ˆã†ã§ã—ãŸã€‚</p>

<p>æ‡‡è¦ªä¼šã®æ™‚ã«ã‚‚è©±ãŒå‡ºãŸã®ã§ã™ãŒã€
<code>RUN</code> ã”ã¨ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒããã®ã§ã€
åŸºæœ¬çš„ã«ã¯ <code>Dockerfile</code> ã®å¤‰æ›´ã‚’è©¦ã—ã¦ã„ã‚‹é–“ã¯ <code>RUN</code> ã”ã¨ã«ç´°ã‹ãã‚³ãƒãƒ³ãƒ‰ã‚’ä¸¦ã¹ã¦è©¦è¡ŒéŒ¯èª¤ã—ã¦ã€
å‡ºæ¥ä¸ŠãŒã£ãŸã‚‰ <code>&amp;&amp;</code> ã§ã¤ãªã’ã¦ä¸€è¡Œã® <code>RUN</code> ã«ã¾ã¨ã‚ã‚‹ã®ãŒè‰¯ã•ãã†ã€
ã¨ã„ã†è©±ã§ã—ãŸã€‚</p>

<p>é–¢é€£ã™ã‚‹è©±ã¨ã—ã¦ã¯ aufs ã® layer ãŒé‡ãªã£ã¦ã„ã‚‹ã®ã‚’ git ã§ merge ã™ã‚‹ã¨ãã®ã‚ˆã†ã«ã¾ã¨ã‚ãŸã„ã€
ã¨ã„ã†æ„è¦‹ã«å¯¾ã—ã¦ã€
<code>Dockerfile</code> ã‚’ãƒã‚¹ã‚¿ãƒ¼ (ä¸») ã¨ã—ã¦æ‰±ã£ã¦ã€
ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯æ¨ã¦ã¦ã„ã¤ã§ã‚‚ä½œã‚Šç›´ã›ã‚‹ã‚‚ã® (å¾“) ã¨ã—ã¦æ‰±ã†æ–¹ãŒè‰¯ã„ã€
ã ã‹ã‚‰ã€ç„¡ç†ã« aufs ã®å·®åˆ†ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä¸­ã‚’ç›´æ¥ã„ã˜ã£ã¦ãƒãƒ¼ã‚¸ã—ã‚ˆã†ã¨ã›ãšã«
<code>Dockerfile</code> ã‹ã‚‰å†ç”Ÿæˆã—ãŸæ–¹ãŒè‰¯ã„ã€
ã¨ã„ã†è©±ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<h2>CircleCI, Cucumber-Chef</h2>

<p><code>CircleCI</code> ã¨ <code>ngrok</code> ã‚’çµ„ã¿åˆã‚ã›ã¦ã€
rebuild.fm ã§è©±ãŒã‚ã£ãŸãƒ–ãƒ©ãƒ³ãƒã”ã¨ã‚ˆã‚Šã‚‚ã•ã‚‰ã«å¯Œè±ªçš„ã«ã€
ã‚³ãƒŸãƒƒãƒˆã”ã¨ã«æ™‚é–“åˆ¶é™ä»˜ãã®ã‚µãƒ¼ãƒãƒ¼ã‚’å‹•ã‹ã™è©±ãªã©ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<p><code>CircleCI</code> ã®1æ™‚é–“ã¨ã„ã†æ™‚é–“åˆ¶é™ (SSH ã§å…¥ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦å‹•ã‹ã™ã¨30åˆ†) ã¨
ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’å¤–ã«å…¬é–‹ã§ãã‚‹ <code>ngrok</code> ã¨ã„ã†ã‚‚ã®ã‚’çµ„ã¿åˆã‚ã›ã¦
ã‚³ãƒŸãƒƒãƒˆã”ã¨ã«ä¸€å®šæ™‚é–“ã‚µãƒ¼ãƒãƒ¼ã‚’å‹•ã‹ã—ã¦ã„ã‚‹ã¨ã„ã†è©±ã§ã—ãŸã€‚</p>

<h2>çµ‚ã‚ã‚Š</h2>

<p>ä»–ã®ç™ºè¡¨ã®æ™‚é–“ã«ä½™è£•ã‚’æŒãŸã›ã¦ã„ã¦ã€ãƒ‘ãƒãƒ«ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CVE-2014-0160 ã§ã® Cookie æ¼æ´©]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-09-cve-2014-0160.html"/>
    <updated>2014-04-09T23:55:46+09:00</updated>
    <id>http://blog.n-z.jp/blog/cve-2014-0160</id>
    <content type="html"><![CDATA[<p>å½±éŸ¿ç¯„å›²ã®ä¸€ä¾‹ã¨ã—ã¦
<a href="https://www.mattslifebytes.com/?p=533">Hijacking user sessions with the Heartbleed vulnerability</a>
ã®å®Ÿéš›ã«ã©ã†ã„ã†ãƒ‡ãƒ¼ã‚¿ãŒæŠœãå–ã‚‰ã‚Œã¦ã—ã¾ã†ã®ã‹ã€ã¨ã„ã†ä¾‹ã§
<code>JSESSIONID</code>
ãŒè¦‹ãˆã¦ã„ã‚‹ã‚ˆã†ã« Cookie ãŒæ¼æ´©ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>

<!--more-->


<h2>è€ƒãˆã‚‰ã‚Œã‚‹æ”»æ’ƒã‚·ãƒŠãƒªã‚ª</h2>

<p><a href="http://www.exploit-db.com/exploits/32745/">OpenSSL TLS Heartbeat Extension &ndash; Memory Disclosure</a>
ã‚’è‡ªåˆ†ã®ã‚µãƒ¼ãƒãƒ¼ã«è©¦ã—ãŸæ™‚ã«
<code>mod-spdy-beta</code>
ãŒåŸå› ã§è„†å¼±æ€§ãŒæ®‹ã£ãŸã¾ã¾ã«ãªã£ã¦ã„ã¦ã€
Rails ã‚¢ãƒ—ãƒªã® Cookie ãŒè¦‹ãˆã¦ã„ã¾ã—ãŸã€‚</p>

<p>ãã“ã§è€ƒãˆãŸã®ã¯ä¸Šè¨˜ã®ãƒ–ãƒ­ã‚°ã«æ›¸ã„ã¦ã‚ã‚‹ã‚ˆã†ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ãŒå¯èƒ½ã ã¨ã„ã†ã“ã¨ã§ã—ãŸã€‚</p>

<p>æ‚ªã„çŠ¶æ³ã‚’è€ƒãˆã‚‹ã¨ã€
è„†å¼±æ€§ã®æƒ…å ±ãŒå…¬é–‹ã•ã‚Œã¦ã‹ã‚‰å¯¾ç­–ãŒã•ã‚Œã‚‹ã¾ã§ã®é–“ã«
å…¨ä¸–ç•Œã® Web ã‚µãƒ¼ãƒãƒ¼ã« Heartbleed ã®æ”»æ’ƒã‚’ä»•æ›ã‘ã¦ãŠã„ã¦ã€
å¾Œã§ãƒ­ã‚°ã‚’èª¿ã¹ã¦ã€ã“ã†ã„ã† Cookie ã®ã‚ˆã†ãªæƒ…å ±ãŒã‚ã‚Œã°
ãã‚Œã‚’ä½¿ã£ã¦åˆ¥é€”ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ãªã©ã®åˆ¥ã®æ”»æ’ƒã‚’ã™ã‚‹ã€
ã¨ã„ã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>

<h2>Rails ã§ã®å¯¾å‡¦æ–¹æ³•æ¡ˆ</h2>

<p><code>config/initializers/secret_token.rb</code> ã® <code>secret_token</code> ã‚’å†ç”Ÿæˆã—ã¦è¨­å®šã—ç›´ã™ã¨ã„ã†æ–¹æ³•ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚
ãã®éš›ã€ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç„¡åŠ¹ã«ãªã£ãŸã‚Šã€
Remember me ã§è¦šãˆã•ã›ã¦ã„ã¦ã‚‚å¿˜ã‚Œã‚‰ã‚ŒãŸã‚Šã™ã‚‹ã¨ã„ã†ã“ã¨ãŒèµ·ãã‚‹ã®ã§ã€
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å½±éŸ¿ã‚’è€ƒãˆã¦å®Ÿæ–½ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚</p>

<p>ã¾ãŸã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ä¿å­˜ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–ã®éµã¨ã—ã¦ã‚‚ä½¿ã£ã¦ã„ãŸã‚‰ã€
èª­ã‚ãªããªã£ã¦ã—ã¾ã†ã®ã§ã€ãã†ã„ã†ç”¨é€”ã«ã‚‚ä½¿ã£ã¦ã„ãŸã‚‰ã€
åˆ¥ã®æ–¹æ³•ã§æ—¢å­˜ã® Cookie ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã—ã‹ãªã•ãã†ã§ã™ã€‚</p>

<h2>secure å±æ€§ã‚’ä»˜ã‘ã¦ã„ã¦ã‚‚ç„¡é–¢ä¿‚</h2>

<p>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®é€šä¿¡å†…å®¹ã®æ®‹éª¸ãŒæ¼æ´©ã—ã¦ã—ã¾ã†ã®ã§ã€
Cookie ã« secure å±æ€§ã‚’ä»˜ã‘ã¦ã„ã¦ã‚‚é˜²ã’ã¾ã›ã‚“ã€‚</p>

<h2>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ãŒåˆ¥ãƒ—ãƒ­ã‚»ã‚¹ã§ã‚‚ç„¡é–¢ä¿‚</h2>

<p>apache+passenger ã‚„ nginx+php-fpm ã®ã‚ˆã†ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã® Web ã‚µãƒ¼ãƒãƒ¼ãŒåˆ¥ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ã‹ã‚Œã¦ã„ã¦ã‚‚ã€
HTTPS å‘ã‘ã«æš—å·åŒ–ã™ã‚‹å‰ã®å¹³æ–‡ã®ãƒ‡ãƒ¼ã‚¿ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã® Web ã‚µãƒ¼ãƒãƒ¼ã«æ®‹ã£ã¦ã„ã¦ã€ãã“ã®æƒ…å ±ãŒæ¼æ´©ã—ã¦ã—ã¾ã†ã®ã§ã€
Cookie ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã™æƒ…å ±ã¯å½±éŸ¿ã‚’å—ã‘ã¦æ¼æ´©ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>

<p>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚µãƒ¼ãƒãƒ¼ã§ã—ã‹èª­ã¿è¾¼ã‚“ã§ã„ãªãã¦ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã¯æ¸¡ã—ã¦ã„ãªã„æƒ…å ±ã¯ã“ã®çµŒè·¯ã§ã¯æ¼æ´©ã—ã¾ã›ã‚“ã€‚</p>

<p>ä¾‹ãˆã°ã€å…¸å‹çš„ãª Rails ã‚¢ãƒ—ãƒªã®æ§‹æˆã§ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼ã¸æ¥ç¶šã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã¯æ¸¡ã•ãªã„ã®ã§ã€ã“ã®çµŒè·¯ã§ã¯æ¼æ´©ã—ã¾ã›ã‚“ã€‚</p>

<h2>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®ç§˜å¯†éµ</h2>

<p>æ—¢ã«æƒ…å ±åé›†ã—ã¦ã„ã‚Œã°çŸ¥ã£ã¦å¯èƒ½æ€§ãŒé«˜ã„ã¨æ€ã„ã¾ã™ãŒã€
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒèª­ã¿è¾¼ã‚“ã§ã„ã‚‹æƒ…å ±ã«ã‚ãŸã‚‹ SSL/TLS ã®ç§˜å¯†éµã¯æ¼æ´©ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>

<p>ãã¡ã‚“ã¨ã—ãŸå¯¾å‡¦ã¨ã—ã¦ã¯
<a href="http://d.hatena.ne.jp/nekoruri/20140408/heartbleed">CVE-2014-0160 OpenSSL Heartbleed è„†å¼±æ€§ã¾ã¨ã‚ &ndash; ã‚ã‚‚ãŠãã°</a>
ã«ã‚‚æ›¸ã„ã¦ã‚ã‚‹ã‚ˆã†ã«</p>

<ol>
<li><em>ç§˜å¯†éµã‹ã‚‰ä½œã‚Šç›´ã—ã¦</em> è¨¼æ˜æ›¸ã‚’å†ç™ºè¡Œ</li>
<li>éå»ã®è¨¼æ˜æ›¸ã‚’ <em>å¤±åŠ¹</em></li>
</ol>


<p>ã®ä¸¡æ–¹ãŒå¿…è¦ã§ã™ã€‚</p>

<h2>ä½™è«‡</h2>

<p>SPDY ã¨ã‹ä½¿ã„ãŸã„ã‹ã‚‰ HTTPS ã«ã—ã¦ã‚‹ã ã‘ã§ HTTP ã§é€šä¿¡ã—ã¦ã¦ã‚‚è‰¯ã„ã‚ˆã†ãªå†…å®¹ã—ã‹æ‰±ã£ã¦ãªã„ã‚µãƒ¼ãƒãƒ¼ãªã‚‰ (VirtualHost ã®ä»–ã®ãƒ›ã‚¹ãƒˆã‚‚å«ã‚ã¦ã¨ã„ã†æ¡ä»¶ä»˜ãã§)ã€æ”¾ç½®ã§ã‚‚è‰¯ã„ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€å°‘ãªãã¨ã‚‚æ¬¡ã®è¨¼æ˜æ›¸ã®æ›´æ–°ã®æ™‚ã«ã¯ç§˜å¯†éµã‚’ä½œã‚Šç›´ã—ãŸæ–¹ãŒè‰¯ã„ã‚ˆã†ã«æ€ã„ã¾ã™ã€‚</p>

<h2>ã¾ã¨ã‚</h2>

<p>å¤–éƒ¨ã‹ã‚‰ SSL/TLS æ¥ç¶šã‚’å—ã‘ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãŒæŒã£ã¦ã„ã‚‹æƒ…å ±ãŒæ¼æ´©ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€ã¨ã„ã†ã“ã¨ã§ã€å…·ä½“ä¾‹ã¨ã—ã¦ Cookie ã«ã¤ã„ã¦å°‘ã—è©³ã—ãè€ƒãˆã¦ã¿ã¾ã—ãŸã€‚</p>

<p>ç°¡å˜ã«è¨€ãˆã°ã€è„†å¼±æ€§ã®ã‚ã‚‹çŠ¶æ…‹ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨é€šä¿¡ã—ã¦ã„ã‚‹å†…å®¹ã¯ã™ã¹ã¦æ¼æ´©ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€ã¤ã¾ã‚Š HTTPS ã§é€šä¿¡ã—ã¦ã„ã¦ã‚‚ HTTP ã¨åŒã˜ã‚ˆã†ãªæ©Ÿå¯†æ€§ã—ã‹ãªã‹ã£ãŸå¯èƒ½æ€§ãŒã‚ã‚‹ã€ã¨è€ƒãˆã‚‹ã®ãŒè‰¯ã•ãã†ã§ã™ã€‚</p>

<p>ã¤ã¾ã‚Šã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ã£ãŸæƒ…å ±ã‚‚æ¼æ´©ã®å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€
Heartbleed è„†å¼±æ€§ãŒæ®‹ã£ã¦ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ã«ã¯ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·ãªã©ã®æƒ…å ±ã¯
é€ã‚‰ãªã„æ–¹ãŒè‰¯ã„ã€ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</p>

<p>é–¢é€£ã™ã‚‹è©±ãªã®ã§ä¸€ç·’ã«æ›¸ã„ã¦ã—ã¾ã£ãŸã®ã§ã€ã¡ã‚‡ã£ã¨ç´›ã‚‰ã‚ã—ã„ã§ã™ãŒã€
ã‚µãƒ¼ãƒãƒ¼ã®ç§˜å¯†éµã®æ¼æ´©ã®å¯èƒ½æ€§ã‚‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†è€…ã¯åˆ¥é€”å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CVE-2014-0160 ã® OpenSSL ã®è„†å¼±æ€§å¯¾å¿œ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-08-cve-2014-0160.html"/>
    <updated>2014-04-08T13:22:28+09:00</updated>
    <id>http://blog.n-z.jp/blog/cve-2014-0160</id>
    <content type="html"><![CDATA[<p><a href="http://heartbleed.com/">Heartbleed</a>
ã«ã‚ˆã‚‹ã¨ä»Šå›ã® OpenSSL ã®è„†å¼±æ€§ã¯å½±éŸ¿ãŒå¤§ããã†ãªã®ã§ã€
OpenSSL ã®æ›´æ–°ã‚’ã—ã¦å†èµ·å‹•ã ã‘ã§ã‚‚æ—©ã‚ã«ã—ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚</p>

<p>å†èµ·å‹•ãŒå¿…è¦ãªã‚‚ã®ã¯ Debian ãªã‚‰
<a href="http://blog.n-z.jp/blog/2013-12-06-checkrestart.html">debian-goodiesã®checkrestartã§å†èµ·å‹•ãŒå¿…è¦ãªãƒ—ãƒ­ã‚»ã‚¹ã‚’èª¿ã¹ã‚‹</a>
ã®ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚
Ubuntu ãªã‚‰ libssl ã®æ›´æ–°ã¯ OS è‡ªä½“ã‚’å†èµ·å‹•ã—ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</p>

<p>ç§˜å¯†éµã‚’å†ç”Ÿæˆã—ãŸæ–¹ãŒè‰¯ã„ã¨ã„ã†è©±ã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€
ãã“ã¾ã§ã®å¯¾å‡¦ã¯ç¶šå ±ã‚’å¾…ã£ã¦ã‹ã‚‰ã§ã‚‚è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>

<!--more-->


<h2><code>mod_spdy</code> ã«ã‚‚å½±éŸ¿</h2>

<p>(<code>mod_spdy</code> ã«ã¤ã„ã¦ 2014-04-09 ã«è¿½è¨˜)</p>

<p><a href="https://groups.google.com/forum/#!topic/mod-spdy-discuss/EwCowyS1KTU">mod_spdy</a>
ã‚‚å½±éŸ¿ã‚’å—ã‘ã‚‹ã®ã§ã€
<code>mod-spdy-beta</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã® <code>0.9.4.1-r397</code> ä»¥å‰ã‚’å…¥ã‚Œã¦ã„ã‚‹å ´åˆã¯æœ€æ–°ç‰ˆ (2014-04-09 ãƒªãƒªãƒ¼ã‚¹ã® <code>0.9.4.2-r413</code> ä»¥é™) ã«æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

<p><code>mod-spdy-beta</code> ã«å«ã¾ã‚Œã‚‹ <code>mod_ssl_with_npn.so</code> ã¯æ”¹å¤‰ã—ãŸ <code>libssl</code> ã‚’é™çš„ãƒªãƒ³ã‚¯ã—ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§ã€
ã‚·ã‚¹ãƒ†ãƒ å´ã® OpenSSL ãŒ 0.9.8 ç³»ãªã©ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ (wheezy ãªã©) ã§ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¦ã€è„†å¼±æ€§ã®å½±éŸ¿ã‚’å—ã‘ã¾ã™ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ldd /usr/lib/apache2/modules/mod_ssl.so
</span><span class='line'>        linux-vdso.so.1 =&gt;  (0x00007fff25b9a000)
</span><span class='line'>        libssl.so.1.0.0 =&gt; /usr/lib/x86_64-linux-gnu/libssl.so.1.0.0 (0x00007f6ae2d93000)
</span><span class='line'>        libcrypto.so.1.0.0 =&gt; /usr/lib/x86_64-linux-gnu/libcrypto.so.1.0.0 (0x00007f6ae299c000)
</span><span class='line'>        libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f6ae277f000)
</span><span class='line'>        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f6ae23f4000)
</span><span class='line'>        libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f6ae21f0000)
</span><span class='line'>        libz.so.1 =&gt; /lib/x86_64-linux-gnu/libz.so.1 (0x00007f6ae1fd8000)
</span><span class='line'>        /lib64/ld-linux-x86-64.so.2 (0x00007f6ae322d000)
</span><span class='line'>$ ldd /usr/lib/apache2/modules/mod_ssl_with_npn.so
</span><span class='line'>        linux-vdso.so.1 =&gt;  (0x00007fff825ff000)
</span><span class='line'>        librt.so.1 =&gt; /lib/x86_64-linux-gnu/librt.so.1 (0x00007f8704d4e000)
</span><span class='line'>        libcrypt.so.1 =&gt; /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007f8704b17000)
</span><span class='line'>        libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f87048fa000)
</span><span class='line'>        libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f87046f6000)
</span><span class='line'>        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f870436b000)
</span><span class='line'>        /lib64/ld-linux-x86-64.so.2 (0x00007f8705367000)</span></code></pre></td></tr></table></div></figure>


<h2>å½±éŸ¿ã‚’å—ã‘ã‚‹ OpenSSL ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³</h2>

<p>Heartbleed ã® <code>What versions of the OpenSSL are affected?</code>
ã«ã‚ˆã‚‹ã¨ã€å½±éŸ¿ã‚’å—ã‘ã‚‹ã®ã¯ OpenSSL 1.0.1 ã‹ã‚‰ 1.0.1f ã§ã€
OpenSSL 1.0.0 ç³»ã‚„ OpenSSL 0.9.8 ç³»ã¨ã„ã†å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯
å½±éŸ¿ãŒãªã„ã‚ˆã†ã§ã™ã€‚</p>

<h2>Debian ã‚„ Ubuntu ã¸ã®å½±éŸ¿</h2>

<p>ä»–ã® OS ã‚‚å«ã‚ãŸæƒ…å ±ã¯
Heartbleed ã® <code>How about operating systems?</code>
ã«ã¾ã¨ã¾ã£ã¦ã„ã‚‹ã®ã§ã€
Debian ã¨ Ubuntu ã«ä»˜ã„ã¦ã‚‚ã†å°‘ã—èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚</p>

<p>Heartbleed ã«ã‚‚æ›¸ã„ã¦ã‚ã‚Šã¾ã™ãŒã€
<a href="https://www.debian.org/security/2014/dsa-2896">Debian &mdash; Security Information &mdash; DSA-2896-1 openssl</a>
ã«ã‚ˆã‚‹ã¨ Debian ã¯ oldstable (squeeze) ã¯å½±éŸ¿ãŒãªãã¦ã€
stable (wheezy) ã ã¨å½±éŸ¿ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚
ã¤ã¾ã‚Šã¾ã  wheezy ã«ä¸Šã’ã¦ã„ãªã„ã‚µãƒ¼ãƒãƒ¼ã¯å¤§ä¸ˆå¤«ã§ã—ãŸã€‚</p>

<p><a href="http://www.ubuntu.com/usn/usn-2165-1/">USN-2165-1: OpenSSL vulnerabilities | Ubuntu</a>
ã«ã‚ˆã‚‹ã¨ Ubuntu ã¯</p>

<ul>
<li>Ubuntu 13.10 (saucy)</li>
<li>Ubuntu 12.10 (quantal)</li>
<li>Ubuntu 12.04 LTS (precise)</li>
</ul>


<p>ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒå‡ºã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚
10.04 LTS lucid ã¯ openssl ãŒå¤ã„ã®ã§å½±éŸ¿ãŒãªãã¦ã€
13.04 (raring) ã¯
<a href="http://www.ubuntu.com/info/release-end-of-life">ã‚µãƒãƒ¼ãƒˆçµ‚äº†</a>
ã—ã¦ã„ã‚‹ã®ã§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¯å‡ºã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚
ã¤ã„ã§ã«
<a href="http://distrowatch.com/table.php?distribution=ubuntu">DistroWatch.com: Ubuntu</a>
ã§ã‚‚ã†å°‘ã—èª¿ã¹ã¦ã¿ã‚‹ã¨ 1.0.1 ã«ãªã£ãŸã®ãŒ 12.04 ã‹ã‚‰ãªã®ã§ã€
11.10 ä»¥å‰ã¯å½±éŸ¿ãŒãªã„ã‚ˆã†ã§ã™ã€‚</p>

<h2>æ”»æ’ƒã‚’å—ã‘ãŸã‹ã©ã†ã‹ã®ç¢ºèªã¯ã§ããªã„</h2>

<p>Heartbleed ã«
<code>Can I detect if someone has exploited this against me?</code>
<code>Exploitation of this bug leaves no traces of anything abnormal happening to the logs.</code>
ã¨æ›¸ã„ã¦ã‚ã£ã¦ã€
ã€Œã“ã®ãƒã‚°ã‚’çªã‹ã‚Œã¦ã‚‚ä½•ã‹å¤‰ãªã“ã¨ãŒã‚ã£ãŸã¨ã„ã†ãƒ­ã‚°ã¯æ®‹ã‚‰ãªã„ã€
ã¨ã„ã†ã“ã¨ã®ã‚ˆã†ãªã®ã§ã€
æ™®é€šã¯æ”»æ’ƒã‚’å—ã‘ãŸã‹ã©ã†ã‹ç¢ºèªã§ããªã„ã¨ã„ã†ã“ã¨ã®ã‚ˆã†ã§ã™ã€‚</p>

<h2>ç§˜å¯†éµã¯å†ç”Ÿæˆã™ã‚‹ã¹ã</h2>

<p>ã¨ã„ã†ã‚ã‘ã§ã€
<a href="https://www.debian.org/security/2014/dsa-2896">DSA-2896</a>
ã«
<code>to the currently available information, private keys should be considered as compromised and regenerated as soon as possible.</code>
ã¨æ›¸ã„ã¦ã‚ã‚‹ã‚ˆã†ã«ã€
ç§˜å¯†éµã¯å‡ºæ¥ã‚‹ã ã‘æ—©ãå†ç”Ÿæˆã—ãŸæ–¹ãŒè‰¯ã„ã‚ˆã†ã§ã™ã€‚</p>

<h2>openssh-server ã®éµã®å†ç”Ÿæˆ</h2>

<p>2014-04-08 è¿½è¨˜:
<a href="http://undeadly.org/cgi?action=article&amp;sid=20140408063423">OpenSSH ã¯å½±éŸ¿ã‚’å—ã‘ãªã„</a>
ã‚ˆã†ã§ã™ã€‚
(2014-04-09 23:55 è¿½è¨˜: SSH ã®é€šä¿¡éƒ¨åˆ†ã§ OpenSSL ã‚’ä½¿ã£ã¦ã„ãªã„ã®ã§ã€ç›´æ¥ã¯å½±éŸ¿ã‚’å—ã‘ãªã„ã¨ã„ã†ã ã‘ã§ã€ PAM ã§ LDAPS ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆãªã©ã¯å½“ç„¶å½±éŸ¿ã‚’å—ã‘ã¾ã™ã€‚)</p>

<p>ã‚µãƒ¼ãƒãƒ¼å´ã§ã¯ <code>/etc/ssh/ssh_host_*</code> ã‚’å‰Šé™¤ã—ã¦ <code>dpkg-reconfigure openssh-server</code> ã§å†ç”Ÿæˆã™ã‚‹ã®ãŒè‰¯ã•ãã†ã§ã™ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>% sudo rm /etc/ssh/ssh_host_*
</span><span class='line'>% sudo dpkg-reconfigure openssh-server
</span><span class='line'>Creating SSH2 RSA key; this may take some time ...
</span><span class='line'>Creating SSH2 DSA key; this may take some time ...
</span><span class='line'>Creating SSH2 ECDSA key; this may take some time ...
</span><span class='line'>ssh stop/waiting
</span><span class='line'>ssh start/running, process 7230
</span><span class='line'>% sudo service ssh restart
</span><span class='line'>ssh stop/waiting
</span><span class='line'>ssh start/running, process 7339</span></code></pre></td></tr></table></div></figure>


<p>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã¯ã€
<code>HashKnownHosts no</code>
ã‚’è¨­å®šã—ã¦ã„ã‚Œã°
<code>~/.ssh/known_hosts</code>
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥ç·¨é›†ã—ã¦ã‚‚è‰¯ã„ã®ã§ã™ãŒã€
è¨­å®šã—ã¦ã„ãªã„ã¨ã€ã©ã®è¡ŒãŒã©ã®ãƒ›ã‚¹ãƒˆã‹ã‚ã‹ã‚‰ãªã„ã®ã§ã€
<code>ssh-keygen -R foo.example.jp</code>
ã®ã‚ˆã†ã«å‰Šé™¤ã™ã‚‹ã¨è‰¯ã•ãã†ã§ã™ã€‚</p>

<p>å ´åˆã«ã‚ˆã£ã¦ã¯
<code>ssh-keygen -R 192.168.1.2</code>
ã®ã‚ˆã†ã« IP ã‚¢ãƒ‰ãƒ¬ã‚¹å´ã®å‰Šé™¤ã‚„
<code>ssh-keygen -R '[foo.example.jp]:3843'</code>
ã®ã‚ˆã†ã«ãƒãƒ¼ãƒˆç•ªå·ä»˜ãã§ã®æŒ‡å®šãŒå¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>

<p><code>UserKnownHostsFile</code> ã§ <code>known_hosts</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†å‰²ã—ã¦ã„ã‚‹ã¨ãã¯
<code>ssh-keygen -R foo.example.jp -f ~/.ssh/foo.known_hosts</code> ã®ã‚ˆã†ã«
<code>UserKnownHostsFile</code> ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

<h2>ãã®ä»–ã®ã‚µãƒ¼ãƒãƒ¼ã®éµã®å†ç”Ÿæˆ</h2>

<p>apache2 ã¨ã‹ã® Web ã‚µãƒ¼ãƒãƒ¼ãªã‚‰
åˆå›ã®è¨­å®šã¨åŒæ§˜ã«å†ç”Ÿæˆã™ã‚Œã°è‰¯ã•ãã†ã§ã™ãŒã€
è¨¼æ˜æ›¸ã®å†ç™ºè¡Œã‚‚å¿…è¦ãªã®ã§ã€
æ°—è»½ã«ã¯å‡ºæ¥ãªã„ã¨ã„ã†ã“ã¨ã§ã€
ã—ã°ã‚‰ãæ§˜å­è¦‹ä¸­ã§ã™ã€‚</p>

<p>OpenVPN ã¯ã‚µãƒ¼ãƒãƒ¼ã®éµã¯å†ç”Ÿæˆã—ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ãŒã€
CA ã¾ã§å†ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã‹ã©ã†ã‹ãŒã‚ã‹ã‚‰ãªã„ã®ã§
æ§˜å­è¦‹ä¸­ã§ã™ã€‚</p>

<p>ä»¥å‰ã® Debian ã§ã®ä¿®æ­£ãƒŸã‚¹ã§è„†å¼±ãªéµã—ã‹ç”Ÿæˆã§ããªããªã£ã¦ã„ãŸå•é¡Œã®ä¿®æ­£ã®ã¨ãã®
<a href="https://www.debian.org/security/key-rollover/">Debian &mdash; éµã®ãƒ­ãƒ¼ãƒ«ã‚ªãƒ¼ãƒãƒ¼</a>
ãŒå‚è€ƒã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€
ä»Šå›ã¯ã‚µãƒ¼ãƒãƒ¼å¤–ã‹ã‚‰ã§ã‚‚éµãŒæŠœãå‡ºã›ã¦ã—ã¾ã†ã¨ã„ã†å•é¡Œã®ã‚ˆã†ãªã®ã§ã€
LAN å†…ã®ã‚µãƒ¼ãƒãƒ¼ãªã©ã€ãã®ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ç’°å¢ƒã«æ”»æ’ƒè€…ãŒå…¥ã‚Œã‚‹æ™‚ç‚¹ã§å•é¡ŒãŒã‚ã‚‹ç’°å¢ƒãªã‚‰ã€
ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’é©ç”¨ã—ã¦å†èµ·å‹•ã—ã¦ä»Šå¾Œéµã‚’æŠœãå–ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ã‚’ãªãã—ã¦ã‹ã‚‰ã€
ã‚†ã£ãã‚Šç¶šå ±ã‚’å¾…ã£ã¦ã‹ã‚‰å¯¾å‡¦ã‚’è€ƒãˆã‚‹ã¨ã„ã†ã“ã¨ã§ã‚‚è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</p>

<h2>å‚è€ƒãƒªãƒ³ã‚¯</h2>

<p>2014-04-09 å‚è€ƒãƒªãƒ³ã‚¯ã‚’è¿½åŠ </p>

<ul>
<li><a href="http://d.hatena.ne.jp/nekoruri/20140408/heartbleed">CVE-2014-0160 OpenSSL Heartbleed è„†å¼±æ€§ã¾ã¨ã‚ &ndash; ã‚ã‚‚ãŠãã°</a>

<ul>
<li>ã“ã®ãƒªãƒ³ã‚¯å…ˆãŒæ—¥æœ¬èªã¨ã—ã¦ã¯ä¸€ç•ªæƒ…å ±ãŒã¾ã¨ã¾ã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚</li>
</ul>
</li>
<li><a href="http://jvn.jp/vu/JVNVU94401838/">JVNVU#94401838: OpenSSL ã® heartbeat æ‹¡å¼µã«æƒ…å ±æ¼ãˆã„ã®è„†å¼±æ€§</a>

<ul>
<li>ãƒ™ãƒ³ãƒ€æƒ…å ±ã¨ã‹ CVSS ã¨ã‹ã€‚</li>
</ul>
</li>
<li><a href="http://heartbleed.com/">Heartbleed Bug</a>

<ul>
<li>è‹±èªã ã‘ã© Google Chrome ã®ç¿»è¨³æ©Ÿèƒ½ã§ã‚‚ã ã„ãŸã„èª­ã‚ã¾ã™ã€‚</li>
</ul>
</li>
<li><a href="http://www.exploit-db.com/exploits/32745/">OpenSSL TLS Heartbeat Extension &ndash; Memory Disclosure</a>

<ul>
<li>å®Ÿéš›ã«æƒ…å ±ãŒæŠœãå‡ºã›ã‚‹ãƒã‚§ãƒƒã‚¯ãƒ„ãƒ¼ãƒ«ã§ã€ã“ã‚Œã‚’ã¿ã¦ä»–ã®ãƒ„ãƒ¼ãƒ«ã®èª¤æ¤œçŸ¥ã§ã¯ãªã <code>mod_spdy</code> ãŒåŸå› ã ã¨æ°—ä»˜ãã¾ã—ãŸã€‚</li>
</ul>
</li>
<li><a href="https://groups.google.com/forum/#!topic/mod-spdy-discuss/0yAGH8BHfQo">CVE-2014-0160 / heartbleed openssl bug &amp; mod_spdy &ndash; Google ã‚°ãƒ«ãƒ¼ãƒ—</a>

<ul>
<li><code>mod_spdy</code> ã®å¯¾å¿œã®è©± (è‹±èª) ã§ã™ã€‚æ—¥æœ¬æ™‚é–“ã® 2014-04-09 02:00 æ™‚ç‚¹ã§ã¯ã¾ã å¯¾å¿œä¸­ã§ä¿®æ­£ç‰ˆã®ãƒªãƒªãƒ¼ã‚¹ã¯ã•ã‚Œã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚</li>
</ul>
</li>
<li><a href="https://groups.google.com/forum/#!msg/mod-spdy-discuss/EwCowyS1KTU/uGm4586P_CQJ">New mod_spdy binary bugfix release (v0.9.4.2) &ndash; SECURITY FIX</a>

<ul>
<li>æ—¥æœ¬æ™‚é–“ã® 2014-04-09 09:00 æ™‚ç‚¹ã§ã¯ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚</li>
</ul>
</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[R ã¨ Ruby ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿è§£æå…¥é–€ã€€èª­æ›¸ä¼šã€€ç¬¬1å›ã«å‚åŠ ã—ã¾ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-04-05-amagasakirb.html"/>
    <updated>2014-04-05T22:55:31+09:00</updated>
    <id>http://blog.n-z.jp/blog/amagasakirb</id>
    <content type="html"><![CDATA[<p><a href="http://kokucheese.com/event/index/153995/">4æœˆ5æ—¥ R ã¨ Ruby ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿è§£æå…¥é–€ èª­æ›¸ä¼š ç¬¬1å›(å…µåº«çœŒ)</a>
ã«å‚åŠ ã—ã¾ã—ãŸã€‚
ä»Šå›ã¯ã¾ãˆãŒãã‹ã‚‰3ç« ã¾ã§ã§ã—ãŸã€‚</p>

<div style="float:right">
<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=znz-22&amp;o=9&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=ss_til&amp;asins=4873116155" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
</div>


<p>æ¬¡å›ã¯5æœˆ17æ—¥ã ãã†ã§ã™ã€‚</p>

<!--more-->


<h2>ä¼šå ´</h2>

<p>ã„ã¤ã‚‚ã®éƒ¨å±‹ã«æˆ»ã£ã¦ã„ã¾ã—ãŸã€‚
ä»Šå›ã¯å‚åŠ è€…ãŒå¤šãã¦ã€æœ€çµ‚çš„ã«ã¯10åã«ãªã£ã¦ã„ã¾ã—ãŸã€‚</p>

<h2>ãƒ¡ãƒ¢</h2>

<p>ä»¥ä¸‹ä»Šå›ã®ãƒ¡ãƒ¢ã§ã™ã€‚</p>

<ul>
<li>ã€Œã¯ã˜ã‚ã«ã€ã®ã€Œã‚«ãƒ©ãƒ¼ãƒ†ãƒ¬ãƒ“ã‚’è¦‹ã‚‹ã¨ã‚«ãƒ©ãƒ¼ã®å¤¢ã‚’è¦‹ã‚‹ã€ã‹ã‚‰ç™½é»’ãƒ†ãƒ¬ãƒ“ã®æ™‚ä»£ã¯ç™½é»’ã®å¤¢ã ã£ãŸã®ã‹ã¨ã‹ã€ãƒ†ãƒ¬ãƒ“ã®æ™®åŠä»¥å‰ã¯ã©ã†ã ã£ãŸã®ã‹ã¨ã„ã†è©±</li>
<li>p.2 : ã€ŒC è¨€èªã¯ãƒ–ãƒ¼ãƒ«å‹ã‚’æŒãŸãªã„ã€ã‹ã‚‰ C99 ã ã¨ <code>_Bool</code> ãŒã‚ã‚‹ã¨ã„ã†è©±</li>
<li>p.5 : è„šæ³¨ã® magic comment ã‹ã‚‰æ›¸ãæ–¹ã®æµæ´¾ã®è©±

<ul>
<li>2.0 ã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ utf-8 ã«ãªã£ãŸã€‚</li>
<li>1.9 ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ us-ascii ã ã£ãŸã€‚</li>
</ul>
</li>
<li>p.13 ãƒ«ãƒ¼ãƒ— : <code>hungry?</code> ã¨ <code>full?</code> ã®ä¸­é–“ã®çŠ¶æ…‹ã¯ãªã„ã®ã‹</li>
<li>R ã§ <code>demo('Japanese')</code> ã¨ã‹</li>
<li>shoes ã® Debian ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ wheezy ã«ã¯ã‚ã‚‹ãŒ sid ã ã¨ãªããªã£ã¦ã„ãŸã€‚</li>
<li><code>sd</code> ã¨ã‹ã‹ã‚‰åå‰ã®çœç•¥ã®è©±</li>
<li>p.33 gforge ã®ã‚ãŸã‚Šã‹ã‚‰ rubyforge ã¯ã‚‚ã†ã™ãçµ‚äº†äºˆå®šã®è©±

<ul>
<li><a href="https://twitter.com/evanphx/status/399552820380053505">Announced today that we&rsquo;re sunsetting RubyForge. Last day will be May 15th. Begin your data migration now!</a></li>
</ul>
</li>
<li>1ã‚ªãƒªã‚¸ãƒ³ã‹0ã‚ªãƒªã‚¸ãƒ³ã‹ã¨ã‹è¥¿æš¦0å¹´ã®æœ‰ç„¡ã®è©±ã¨ã‹ Oracle ã¨ PostgreSQL ã®éäº’æ›ã®è©±ã¨ã‹</li>
<li>p.39 ã€Œæœ€ã‚‚åŸºç¤çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚ã‚‹ãƒ™ã‚¯ãƒˆãƒ«ã€ã‹ã‚‰ã‚¹ã‚«ãƒ©ãƒ¼ã¯ãªã„ã®ã‹ã¨ã„ã†è©±</li>
<li>p.40 ã€ŒäºŒé‡è§’æ‹¬å¼§ã¯å¸¸ã« 1 ã¤ã®å€¤ã‚’è¿”ã—ã¾ã™ã€ã®æ„å‘³ãŒåˆ†ã‹ã‚Šã«ãã„ã¨ã„ã†è©±</li>
<li>ã“ã®ã‚ãŸã‚Šã§ REPL ã§æ¯å›ä»˜ã„ã¦ã„ãŸ <code>[1]</code> ã¯ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¡¨ã—ã¦ã‚‹ã£ã½ã„ã“ã¨ã«æ°—ä»˜ã„ãŸ</li>
<li>p.47 <code>rbind</code> ã¯ _r_ows bind ã ã£ãŸã€‚
<code>help(rbind)</code> ã§ <code>cbind</code> ã¨ä¸€ç·’ã«èª¬æ˜ãŒå‡ºã¦ããŸã€‚</li>
<li>p.57 <code>factor</code> ã®ä½¿ç”¨ä¾‹ : å¹´ã‚’é€£ç¶šå€¤ã§ã¯ãªãé›¢æ•£å€¤ã¨ã—ã¦æ‰±ã†ãŸã‚ã«ä½¿ã£ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚</li>
<li>3ç« ã¯ç¿»è¨³ç‹¬è‡ªã®è¿½åŠ ã®ç« 

<ul>
<li>æ›´ãªã‚‹å‰æçŸ¥è­˜ãŒãªã„ã¨ã“ã‚Œã§ã‚‚ã¾ã é›£ã—ã„</li>
<li>8ã¤ã®é­”æ³•ã¨ã‚ã‚‹ãŒã€ãã‚Œãã‚Œã®èª¬æ˜ã®è©³ã—ã•ãŒé•ã†</li>
</ul>
</li>
<li>p-value ã ã‘ã¨ã‚ŠãŸã„å ´åˆã¨ã‹ã©ã†ã™ã‚Œã°ã„ã„ã®ã‹ã‚ã‹ã‚‰ãªã„

<ul>
<li><code>t.test()</code> ã®è¿”ã‚Šå€¤ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã£ã½ã„ãŒãã®å±æ€§ã®å–ã‚Šå‡ºã—æ–¹ãŒã‚ã‹ã‚‰ãªã„</li>
<li><code>help(t.test)</code> ã§ã„ã‚ã„ã‚æƒ…å ±ã¯å‡ºã¦ããŸ</li>
<li><code>v = t.test(hoge)</code> ã ã¨ <code>v$p.value</code> ã¨ã‹ <code>v["p.value"]</code> ã¨ã‹ã§å–ã‚Šå‡ºã›ãŸã€‚</li>
</ul>
</li>
<li><code>help</code> ã¨ã‹ã®ä½¿ã„æ–¹ (èª¿ã¹æ–¹) ã‚’èª¬æ˜ã—ã¦ã»ã—ã‹ã£ãŸã¨ã„ã†è©±</li>
<li>ãƒ—ãƒ­ã‚°ãƒ©ãƒ (è¨€èªã‚ªã‚¿ã‚¯?) å‘ã‘ã«ã¯ä»Šå›ã®èª­æ›¸ä¼šã®æœ¬ã‚ˆã‚Šã‚‚
<div style="float:right">
<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=znz-22&amp;o=9&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=ss_til&amp;asins=4873115795" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
</div>
<a href="http://www.amazon.co.jp/gp/product/4873115795/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=4873115795&amp;linkCode=as2&amp;tag=znz-22">ã‚¢ãƒ¼ãƒˆãƒ»ã‚ªãƒ–ãƒ»Rãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=znz-22&amp;l=as2&amp;o=9&amp;a=4873115795" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
ãŒã‚ªã‚¹ã‚¹ãƒ¡ã‚‰ã—ã„ã€‚</li>
</ul>


<h2>æ‡‡è¦ªä¼š</h2>

<p>èŠ±è¦‹ã«ã‚ˆã•ãã†ãªå ´æ‰€ãŒãªã‹ã£ãŸã®ã¨ã€å¤©æ°—ãŒä¸‹ã‚Šå‚ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚Šã€çµå±€ã„ã¤ã‚‚ã®ã•ãã‚‰æ°´ç”£ã§ã®æ‡‡è¦ªä¼šã§ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç¬¬60å› Ruby/Railså‹‰å¼·ä¼šï¼ é–¢è¥¿ã§æ­£è¦è¡¨ç¾ã®å…ˆèª­ã¿ã«ã¤ã„ã¦ã¨ã„ã†ç™ºè¡¨ã‚’ã—ã¾ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-03-29-kansaiworkshop060.html"/>
    <updated>2014-03-29T22:00:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/kansaiworkshop060</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/rubykansai/workshops/wiki/Kansaiworkshop060">ç¬¬50å› Ruby/Railså‹‰å¼·ä¼šï¼ é–¢è¥¿</a> ã«å‚åŠ ã—ã¦ã€ã€Œæ­£è¦è¡¨ç¾ã®å…ˆèª­ã¿ã«ã¤ã„ã¦ã€ã¨ã„ã†ç™ºè¡¨ã‚’ã—ã¦ãã¾ã—ãŸã€‚</p>

<!--more-->


<h2>ç™ºè¡¨è³‡æ–™</h2>

<ul>
<li><a href="https://github.com/znz/regexp-201403">https://github.com/znz/regexp-201403</a></li>
<li><a href="http://slide.rabbit-shocker.org/authors/znz/regexp-201403/">http://slide.rabbit-shocker.org/authors/znz/regexp-201403/</a></li>
<li><a href="https://speakerdeck.com/znz/zheng-gui-biao-xian-falsexian-du-minituite">https://speakerdeck.com/znz/zheng-gui-biao-xian-falsexian-du-minituite</a></li>
<li><a href="http://www.slideshare.net/znzjp/regexp-201403">http://www.slideshare.net/znzjp/regexp-201403</a></li>
</ul>


<h2>ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒª</h2>

<p>ãƒ‡ãƒ¢ã«ä½¿ã£ãŸ Web ã‚¢ãƒ—ãƒªã®ã‚½ãƒ¼ã‚¹ã¯
<a href="https://gist.github.com/znz/9835956#file-regexp-201403-rb">https://gist.github.com/znz/9835956#file-regexp-201403-rb</a>
ã§å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚</p>

<p>heroku ã«ã‚‚ deploy ã—ãŸã®ã§ã€
<a href="http://regexp-201403.herokuapp.com/">http://regexp-201403.herokuapp.com/</a>
ã§è©¦ã›ã¾ã™ã€‚</p>

<h3>åˆ¶é™äº‹é …</h3>

<p>ç™ºè¡¨ã§è¦‹ã›ã‚‹ç¯„å›²ã—ã‹ã¡ã‚ƒã‚“ã¨ä½œã£ã¦ã„ãªã„ã®ã§ã€
å¤‰ãªã“ã¨ã‚’ã™ã‚‹ã¨å¤‰ã«ãªã‚‹ã®ã¯ãã†ã„ã†ã‚‚ã®ã§ã™ã€‚</p>

<p>å¯¾å¿œã—ã¦ã„ã‚‹æ­£è¦è¡¨ç¾ã‚‚æœ€åˆã«ä¾‹ã¨ã—ã¦ä¸¦ã‚“ã§ã„ã‚‹ã‚‚ã®ã§ä½¿ã£ã¦ã„ã‚‹ã‚ˆã†ãªã‚‚ã®ã—ã‹å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚</p>

<h2>ç™ºè¡¨å†…å®¹</h2>

<p>ãƒ‡ãƒ¢ã‚’å…ˆã«ä½œã£ã¦å¾Œã§ç™ºè¡¨è³‡æ–™ã‚’ä½œã£ãŸã®ã§ã€ãƒ‡ãƒ¢ã®æ–¹ãŒãƒ¡ã‚¤ãƒ³ã§è³‡æ–™ã¯å¾Œä»˜ã‘ã¨ã„ã†æ„Ÿã˜ã§ã™ã€‚</p>

<h2>KPT</h2>

<ul>
<li>Keep

<ul>
<li>ã¡ã‚ƒã‚“ã¨ç™ºè¡¨ã§ããŸã€‚</li>
<li>ç›´å‰ã«ãªã£ã¦ã—ã¾ã£ãŸã‘ã‚Œã©ã€ç™ºè¡¨è³‡æ–™ã‚‚ã¡ã‚ƒã‚“ã¨ä½œæˆã§ããŸã€‚</li>
</ul>
</li>
<li>Problem

<ul>
<li>æº–å‚™ã®æ™‚é–“ãŒã‚ã¾ã‚Šå–ã‚Œãªã‹ã£ãŸã€‚</li>
<li>ä¼šå ´ã®å¾Œã‚ã®æ–¹ã§ã¡ã‚ƒã‚“ã¨è¦‹ãˆã¦ã„ãŸã®ã‹ã¨ã‹ã€èã“ãˆã¦ã„ãŸã®ã‹ã¨ã‹ãŒç¢ºèªã§ããªã‹ã£ãŸã€‚</li>
<li>ç™ºè¡¨è³‡æ–™ã®å…¬é–‹ãŒé…ããªã£ãŸã€‚(4æœˆ3æ—¥)</li>
</ul>
</li>
<li>Try

<ul>
<li>ä¸­ç¶™å†…å®¹ã®äº‹å‰ç¢ºèªã‚’ã—ã¦ãŠããŸã„ã€‚éŒ²ç”»ã‚ã‚Šã‹ã©ã†ã‹ã¨ã‹ã€‚</li>
<li>ä»Šåº¦ã“ã rabbiter ã‚’ä½¿ã„ãŸã„ã€‚</li>
</ul>
</li>
</ul>


<h2>ä»–ã®ç™ºè¡¨ã®æ„Ÿæƒ³ã¨ã‹</h2>

<p>RSpec 3 å¯¾å¿œã®ãƒ©ã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯äº‹å‰ã«ã‹ãªã‚Šã¡ã‚ƒã‚“ã¨æº–å‚™ã‚’ã—ã¦ããŸæ„Ÿã˜ãŒã—ã¦ã€
å†…å®¹ã‚‚å‚è€ƒã«ãªã£ã¦éå¸¸ã«è‰¯ã‹ã£ãŸã§ã™ã€‚</p>

<p>ä»–ã¯ã“ã†ã„ã†ã“ã¨ã‚’ã‚„ã£ã¦ã„ã¾ã™ã€ã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã®ç´¹ä»‹ã£ã½ã„æ„Ÿã˜ãŒå¤šãã¦ã€
ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®è©±ã¯å°‘ãªã‹ã£ãŸã®ã§ã€å†…å®¹ã¯é¢ç™½ã„ã‘ã©
Ruby/Railså‹‰å¼·ä¼šï¼ é–¢è¥¿å‘ãã§ã¯ãªã„ã‹ã‚‚ã€ã¨æ„Ÿã˜ã‚‹ã‚‚ã®ã‚‚ã‚ã‚Šã¾ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç¬¬ 9 å› RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka ã«å‚åŠ ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-03-19-rubymotion-mokumoku-osaka.html"/>
    <updated>2014-03-19T19:32:08+09:00</updated>
    <id>http://blog.n-z.jp/blog/rubymotion-mokumoku-osaka</id>
    <content type="html"><![CDATA[<p>ç¬¬ 1 å›ã‹ã‚‰ç¬¬ 8 å›ã«ã‚‚å‚åŠ ã—ãŸ RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka ã®
<a href="http://connpass.com/event/5276/">ç¬¬ 9 å› RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka</a>
ã«å‚åŠ ã—ã¦ãã¾ã—ãŸã€‚</p>

<p>æ¬¡å›ã®
<a href="http://connpass.com/event/5674/">ç¬¬ 10 å› RubyMotion ã‚‚ãã‚‚ãä¼š in Osaka</a>
ã¯ 4/23(æ°´) ã«ãªã‚Šã¾ã—ãŸã€‚</p>

<!--more-->


<h2>ãƒ¡ãƒ¢</h2>

<ul>
<li><a href="https://github.com/shin1x1/vagrantx/issues/1">VagrantX ã®ãƒ­ã‚´</a></li>
<li><a href="http://www.jetbrains.com/ruby/">RubyMine</a></li>
<li><a href="http://testflightapp.com/">TestFlight</a> ã®ä»£ã‚ã‚Šã«ä»Šã¯ <a href="https://deploygate.com/">DeployGate</a> ãŒè‰¯ã„ã¨ã„ã†è©±</li>
</ul>


<h2>ã‚„ã£ãŸã“ã¨</h2>

<p>RubyMine ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä½¿ã„å§‹ã‚ã¦ã¿ã¾ã—ãŸã€‚
è©¦ç”¨æœŸé–“ã¯æ¬¡å›ã®ã‚‚ãã‚‚ãä¼šã«ã¯åˆ‡ã‚Œã¦ã„ã‚‹ã®ã§ã€
ãã‚Œã¾ã§ã«ä»–ã§ã‚‚ä½¿ã£ã¦ãŠã‹ãªã„ã¨ã‚ã£ã¨ã„ã†é–“ã«è©¦ç”¨æœŸé–“ãŒçµ‚ã‚ã£ã¦ã—ã¾ã„ãã†ã§ã™ã€‚</p>

<p><a href="http://stackoverflow.com/questions/9289613/handlegeturlevent-doesnt-get-called">ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã®è¨­å®šã‚’ init ã§ã‚„ã‚Œã°è‰¯ã„</a>ã¨ã„ã†ã‚ˆã†ãªè©±ãŒã‚ã£ãŸã®ã§ã€
init ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¦ã¿ãŸã¨ã“ã‚ã€å‘¼ã°ã‚Œã¦ã„ãªã‹ã£ãŸã®ã§ã€
initialize ã«ã—ã¦ã¿ãŸã‚‰ã€
å‘¼ã°ã‚Œã¦ã„ã‚‹ã“ã¨ã¯ç¢ºèªã§ãã¦ã‚‚ã€
ã‚„ã£ã±ã‚Šèµ·å‹•æ™‚ã® URL ã¯å—ã‘å–ã‚Œãªã„ã¾ã¾ã§ã—ãŸã€‚</p>

<p>å†…éƒ¨çš„ãªå¤‰æ›´ã¨ã—ã¦ã¯
REPL ã§ç¢ºèªã—ãŸæ™‚ã«
<code>KeyDirectObject</code> ãŒå­˜åœ¨ã—ãªã‹ã£ãŸã®ã§ã€
<code>keyDirectObject = '----'.unpack('L')[0]</code>
ã®ã‚ˆã†ã«ä½œã£ã¦ã„ãŸã®ã‚’
<code>KeyDirectObject</code>
ã‚’ä½¿ã†ã‚ˆã†ã«å¤‰ãˆã¾ã—ãŸã€‚</p>

<p>ä»¥å‰ã®ã‚‚ãã‚‚ãä¼šã®æ™‚ã«æ°—ä»˜ã„ãŸã‚ˆã†ã«
<code>rake</code>
ã§ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«å‚ç…§ã—ã¦ã„ãªã„å®šæ•°ã¯ REPL ã§ã‚‚å­˜åœ¨ã—ãªã„ã¨ã„ã†ã ã‘ã§ã—ãŸã€‚</p>

<p>ä»–ã«ã¯ã„ã‚ã„ã‚èª¿ã¹ã¦ã„ã‚‹æ™‚ã«
<a href="http://vivacocoa.jp/objective-c3e/chapter5c.html">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¯ãƒ­ãƒ¼ã‚ºã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çµ‚äº†ã‚’åŒæœŸã•ã›ã‚‹</a>
ã¨ã„ã†ã®ã‚’çŸ¥ã£ãŸã®ã§ã€
ä»¥ä¸‹ã®ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©ã‚’è¿½åŠ ã—ã¦
window ã‚’é–‰ã˜ãŸæ™‚ã«çµ‚äº†ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
ã“ã‚Œã‚’è¿½åŠ ã™ã‚‹ã¾ã§ã¯é–‰ã˜ãŸã‚‰é–‹ãç›´ã™æ‰‹æ®µãŒãªãã¦ä½•ã‚‚å‡ºæ¥ãªããªã£ã¦ã„ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>app/app_delegate.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">applicationShouldTerminateAfterLastWindowClosed</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">true</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[bootstrap 2.3.2 ã‹ã‚‰ bootstrap 3.1.1 ã¸ã®ç§»è¡Œ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-03-14-bootstrap-2-to-3.html"/>
    <updated>2014-03-14T23:00:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/bootstrap-2-to-3</id>
    <content type="html"><![CDATA[<p>Rails 3.2.17 ã‚’ä½¿ã£ã¦ã„ã‚‹ rails ã‚¢ãƒ—ãƒªã§
bootstrap 2.3.2 ã‹ã‚‰ bootstrap 3.1.1 ã«ç§»è¡Œã—ã¦ã„ã‚‹é€”ä¸­ãªã®ã§ã™ãŒã€
ã©ã†ã„ã†ã¨ã“ã‚ã«å¯¾å‡¦ãŒå¿…è¦ã ã£ãŸã®ã‹ã€
ãƒ¡ãƒ¢ã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚</p>

<!--more-->


<h2>Gemfile å¤‰æ›´</h2>

<p>bootstrap 2 ç³»ã®ã¨ãã¯ twitter-bootstrap-rails gem ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€
bootstrap 3 ç³»å¯¾å¿œãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚‚ã‚ã£ã¦ã€
bootstrap å´ã‹ã‚‰å…¬å¼ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ã‚‹ bootstrap-sass gem ã«ç§»è¡Œã—ã¾ã—ãŸã€‚</p>

<p>bootstrap-sass ã¯ rails_admin gem ã§ä½¿ã‚ã‚Œã¦ã„ã¦ã€
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ rails_admin ã«ã‚ˆã£ã¦åˆ¶é™ã•ã‚Œã¦ã—ã¾ã†ã®ã§ã€
å…¬å¼ã® less ã® gem ãŒã‚ã‚Œã°è‰¯ã‹ã£ãŸã®ã§ã™ãŒã€
è¦‹ã¤ã‘ã‚‰ã‚Œãªã‹ã£ãŸã®ã§ã€
è‡ªåˆ†ã—ã‹ä½¿ã£ã¦ã„ãªã„ rails_admin ã‚’ rails 4 ã«ä¸Šã’ã‚‹ã¾ã§ã®é–“ã€
ä¸€æ™‚çš„ã« rails_admin ã‚’å¤–ã—ã¦ã€
æ–°ã—ã„ bootstrap-sass ã‚’ rails 3.2.17 ã¨ä¸€ç·’ã«ä½¿ã„ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>Gemfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;less-rails&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;twitter-bootstrap-rails&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã‚’ <a href="https://github.com/twbs/bootstrap-sass">https://github.com/twbs/bootstrap-sass</a> ã«æ›¸ã„ã¦ã‚ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šä»˜ãã§</p>

<figure class='code'><figcaption><span>Gemfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;sass-rails&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;= 3.2&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;bootstrap-sass&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 3.1.1&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã«æ›¸ãæ›ãˆã¦ã€ <code>bundle update</code> ã§åæ˜ ã—ã¾ã—ãŸã€‚</p>

<h2>twitter-bootstrap-rails ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰å‰Šé™¤</h2>

<p>twitter-bootstrap-rails ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ã„ãŸã‚‰ã€
å‰Šé™¤ã™ã‚‹ãªã‚Šä»£æ›¿ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¦ç½®ãæ›ãˆã‚‹ãªã‚Šã€
ä¸€æ™‚çš„ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã™ã‚‹ãªã‚Šã—ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã—ã¦ãŠãã¾ã™ã€‚</p>

<p>ä»Šå›ã¯ <code>glyph</code> ã¨ <code>add_breadcrumb</code> ãŒã²ã£ã‹ã‹ã‚Šã¾ã—ãŸã€‚</p>

<h2>bootstrap_and_overrides.css.less å‰Šé™¤</h2>

<p>app/assets/stylesheets/bootstrap_and_overrides.css.less ã‚’å‰Šé™¤ã—ã¦ã€
app/assets/stylesheets/app.css.scss ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»è¡Œã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>app.css.scss</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="o">//</span> <span class="err">ãã®ä»–ã®</span> <span class="nt">bootstrap_and_overrides</span><span class="nc">.css.less</span> <span class="err">ã‹ã‚‰ç§»è¡Œã—ãŸå†…å®¹</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤</h2>

<p>less ã‚’æ¶ˆã—ãŸã¯ãšãªã®ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªãã¦ãŠã‹ã—ã„ã¨æ€ã£ã¦ã„ãŸã‚‰ã€
ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å½±éŸ¿ã ã£ãŸã®ã§ã€
development ç’°å¢ƒã§ã‚‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æœ‰åŠ¹ã«ã—ã¦ã„ã‚‹å ´åˆã¯å‰Šé™¤ã—ã¾ã™ã€‚</p>

<p><code>bundle exec rake tmp:clear</code> ã§æ¶ˆã—ãŸã‚Šã€
<code>rake</code> çµŒç”±ã ã¨é…ã„ã¨æ€ã£ãŸã‚‰
<code>rm -rf tmp/cache</code> ã®ã‚ˆã†ã«ã°ã£ã•ã‚Šå‰Šé™¤ã—ãŸã‚Šã™ã‚‹ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</p>

<h2>.navbar</h2>

<p>bootstrap 2 ã‚’ä½¿ã£ã¦ã„ãŸé ƒã¯
<code>.navbar</code> ã¨ <code>.nav</code> ã®é•ã„ãŒã‚ˆãã‚ã‹ã£ã¦ã„ãªã‹ã£ãŸã®ã§ã™ãŒã€
<code>.navbar</code> ã¯ä¸Š (ã¾ãŸã¯ä¸‹) ã®ãƒãƒ¼ã®ã“ã¨ã§ã€
<code>.nav</code> ã¯ãã®ä¸­ã«ã‚ã‚‹ <code>ul</code> ã®ãƒªãƒ³ã‚¯ã®ã“ã¨ã§ã—ãŸã€‚</p>

<p><code>.nav</code> ã¯ä»–ã«ã‚‚ <code>.nav-tabs</code> ã®ã‚ˆã†ãªä½¿ã„æ–¹ã‚‚ã™ã‚‹ã¨ã„ã†ã®ã‚’å…ˆã«çŸ¥ã£ã¦ã„ã‚Œã°
è¿·ã‚ãªã‹ã£ãŸã¨æ€ã„ã¾ã™ã€‚</p>

<p><a href="http://getbootstrap.com/components/#nav">http://getbootstrap.com/components/#nav</a>
(å¤ã„æ–¹: <a href="http://getbootstrap.com/2.3.2/components.html#navs">http://getbootstrap.com/2.3.2/components.html#navs</a> )
ã®èª¬æ˜ã§ã¯ navbar ã®ä¸Šãªã®ã§ã™ãŒã€
ã‚µã‚¤ãƒˆã®ä½œæˆé †ã¨ã—ã¦ç”»é¢ã®ä¸Šã‹ã‚‰ä½œã£ã¦ã„ã£ã¦ã„ãŸã®ã§ã€
è¿·ã£ã¦ã—ã¾ã£ã¦ã„ãŸã‚ˆã†ã§ã™ã€‚</p>

<p><code>.navbar</code> ã®ä¸­ã® <code>.nav</code> ã¯ <code>.navbar-nav</code> ã«å¤‰ã‚ã£ã¦ã„ã‚‹ã€
<code>.navbar-inner</code> ã¯ <code>.container</code> ã‹ <code>.container-fluid</code> ã«ç½®ãæ›ãˆãªã©ã€
å¤‰æ›´ç‚¹ãŒå¤šã„ã®ã§ã€
<code>.navbar</code> ã®ä¸­èº«ã¯å…¨é¢çš„ã«è¦‹ç›´ã™ã®ãŒè‰¯ã•ãã†ã§ã™ã€‚</p>

<h2>.brand ã‹ã‚‰ .navbar-brand</h2>

<p><code>.brand</code> ã‹ã‚‰ <code>.navbar-brand</code> ã«å¤‰ã‚ã£ã¦ã„ã¾ã—ãŸã€‚</p>

<p>ä¸­ã«ç”»åƒã‚’å…¥ã‚Œã¦ã„ã‚‹ã¨ãšã‚Œã¦ã—ã¾ã†ã®ã§ã€
scss ã«ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã„ã¦èª¿æ•´ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.navbar-brand</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">padding-top</span><span class="o">:</span> <span class="m">8px</span><span class="p">;</span>
</span><span class='line'>  <span class="n">img</span> <span class="err">{</span>
</span><span class='line'>    <span class="k">height</span><span class="o">:</span> <span class="m">34px</span><span class="p">;</span>
</span><span class='line'>    <span class="k">width</span><span class="o">:</span> <span class="m">34px</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>8 + 34 + 8 ã¨ã„ã†ã“ã¨ã§é«˜ã• 50px ã® <code>.navbar</code> ã®çœŸã‚“ä¸­ã«ãªã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚</p>

<h2>.container (å›ºå®šå¹…) ã‹ .container-fluid (æ¨ªå¹…ã„ã£ã±ã„)</h2>

<p>grid system ã®é…ç½®ã‚’ä½¿ã†ãªã‚‰ <code>.row</code> ã¯ <code>.container</code> ã‹ <code>.container-fluid</code> ã®ä¸­ã«ç½®ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

<p>é•ã„ã¯å®Ÿéš›ã« window ã®æ¨ªå¹…ã‚’å¤‰ãˆã¦ã¿ã‚Œã°ã‚ã‹ã‚‹ã®ã§ã™ãŒã€
<code>.container</code> ã ã¨
<a href="http://getbootstrap.com/css/#grid">http://getbootstrap.com/css/#grid</a>
ã®ã‚ˆã†ã« 768px 992px 1200px ã®ã¨ã“ã‚ã§æ€¥ã«é…ç½®ãŒå¤‰ã‚ã£ã¦ã€
ãã®é–“ã¯å·¦å³ã®ä½™ç™½ãŒå¢—æ¸›ã™ã‚‹ã ã‘ã®ã‚ˆã†ã§ã™ã€‚</p>

<p><code>.container-fluid</code> ã ã¨æ™®é€šã®ã‚µã‚¤ãƒˆã¨åŒã˜ã‚ˆã†ã«å‡ºæ¥ã‚‹ã ã‘æ¨ªå¹…ã„ã£ã±ã„ã«ãªã‚‹ã‚ˆã†ã«ä¸­èº«ã®æ¨ªå¹…ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚</p>

<p>bootstrap 2 ã§ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã«ã—ãŸã„ã¨ãã¯ <code>.container-fluid</code> ã§å›ºå®šå¹…ã®æ™‚ã¯ <code>.container</code> ã ã£ãŸã®ã§ã€
<code>.container-fluid</code> ã—ã‹ä½¿ã£ã¦ã„ãªã‹ã£ãŸã®ã§ã™ãŒã€
ä»Šã¯ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªä¸­ã§ä½¿ã„åˆ†ã‘ãŒå‡ºæ¥ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚</p>

<p><a href="http://getbootstrap.com/examples/navbar-fixed-top/">http://getbootstrap.com/examples/navbar-fixed-top/</a>
ã®ä¾‹ã§ <code>Project name</code> ãŒå·¦ç«¯ã«ã‚ˆã£ã¦ã„ãªã„ã®ã‚‚ <code>.container</code> ã‚’ä½¿ã£ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ«ã§ <code>.container-fluid</code> ã«å¤‰ãˆã¦æ¨ªå¹…ã‚’å¤‰ãˆã¦ã¿ã‚Œã°
é•ã„ãŒã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>

<h2><code>.row-fluid .span*</code> ã‹ã‚‰ <code>.row .col-xs-*</code></h2>

<p><code>.row</code> ã¨ <code>.row-fluid</code> ã®åŒºåˆ¥ã¯ãªããªã£ã¦ã€
<code>.row</code> ã«çµ±ä¸€ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>

<p><code>.span*</code> ã®ç½®ãæ›ãˆã¯ <code>.col-md-*</code> ã¨èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ã‚ˆã†ã§ã™ãŒã€
<code>.col-md-</code> ãŒ <code>@media (min-width: 992px)</code> ã«ãªã£ã¦ã„ã‚‹ãªã©ã€
å°ã•ã„ç”»é¢ã‚µã‚¤ã‚ºç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤§ãã„ç”»é¢ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ«ã§ä¸Šæ›¸ãã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€
ç”»é¢ã‚µã‚¤ã‚ºã«é–¢ã‚ã‚‰ãšåŒã˜åˆ†å‰²ã‚’ã—ãŸã„ã®ãªã‚‰ <code>.col-xs-</code> ã ã‘æŒ‡å®šã™ã‚Œã°è‰¯ã•ãã†ã§ã™ã€‚</p>

<h2>btn</h2>

<p><code>btn</code> ã ã‘ã§ã¯è‰²ã‚„æ  (border) ãŒå¤‰ã‚ã‚‰ãªããªã£ãŸã®ã§ã€
<code>btn-default</code> ã‚’è¶³ã™å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<p>ã‚µã‚¤ã‚ºå¤‰æ›´ã® <code>btn-mini</code> ãªã©ãŒãªããªã£ã¦ <code>btn-xs</code> ãªã©ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<h2>list-unstyled</h2>

<p><code>ul.unstyled</code> ã¯ <code>ul.list-unstyled</code> ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<h2>font-awesome-sass</h2>

<p>ã‚¢ã‚¤ã‚³ãƒ³ã¯ glyphicons ã§ã¯ãªã font-awesome ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã€
<a href="https://github.com/FortAwesome/font-awesome-sass">font-awesome-sass</a>
ã«ä¹—ã‚Šæ›ãˆã¾ã—ãŸã€‚</p>

<p>mixin ã‚„ variables ãªã©ãŒãªã‘ã‚Œã°é–¢ä¿‚ãªã•ãã†ã§ã™ãŒã€
<a href="https://github.com/twbs/bootstrap-sass#usage">bootstrap-sass ã® Usage</a>
ã§ã¯ <code>//= require</code> ã‚ˆã‚Š <code>@import</code> ãŒæ¨å¥¨ã•ã‚Œã¦ã„ãŸã®ã§ã€</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="k">@import</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">@import</span> <span class="s2">&quot;font-awesome&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã« <code>@import</code> ã«ã—ã¦ã¿ã¾ã—ãŸã€‚</p>

<p><code>&lt;i class="icon-sort"&gt;&lt;/i&gt;</code> ãŒ
<code>&lt;i class="fa fa-sort"&gt;&lt;/i&gt;</code> ã«å¤‰ã‚ã‚‹ã‚ˆã†ãªæ„Ÿã˜ã§ã€
<code>icon-</code> ã‚’ <code>fa-</code> ã«ç½®ãæ›ãˆã‚‹ã ã‘ã§ã¯ãªãã€
<code>fa</code> ã®è¿½åŠ ãŒå¿…è¦ã§ã—ãŸã€‚</p>

<p><code>glyph</code> ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ã„ãŸå ´åˆã¯ã€
<code>icon</code> ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã«æ›¸ãæ›ãˆã‚‹ã¨è‰¯ã„ã®ã§ã™ãŒã€
è¤‡æ•°å¼•æ•°ã®æ‰±ã„ãŒé•ã†ã®ã¨ã€
<code>_</code> ã‚’ <code>-</code> ã«ç½®ãæ›ãˆã‚‹å‡¦ç†ãŒãªããªã£ã¦ã„ã‚‹ã®ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚</p>

<p>ãŸã¨ãˆã° <code>glyph(:sort_up)</code> ã¯ <code>icon('sort-up')</code> ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¾ã—ãŸã€‚</p>

<p><code>glyph(:lock, :white)</code> ã®ã‚ˆã†ãªè¤‡æ•°æŒ‡å®šã«ã¯å¯¾å¿œã—ã¦ã„ãªã„ã‚ˆã†ãªã®ã§ã€</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="p">=</span> <span class="n">icon</span><span class="p">(</span><span class="s1">&#39;spinner fa-spin&#39;</span><span class="o">.</span><span class="n">freeze</span><span class="p">)</span>
</span><span class='line'><span class="cp">-# or</span>
</span><span class='line'><span class="p">=</span> <span class="n">icon</span><span class="p">(</span><span class="ss">:spinner</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">&#39;fa-spin&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã« 2 å€‹ç›®ä»¥é™ã¯ç„¡ç†çŸ¢ç†åŸ‹ã‚è¾¼ã‚€ã—ã‹ãªã•ãã†ã§ã™ã€‚</p>

<p>ãã‚Œãã‚Œã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚½ãƒ¼ã‚¹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>

<ul>
<li><a href="https://github.com/seyhunak/twitter-bootstrap-rails/blob/40afc477f6a3813ef82cf5821602c9cf2422efc2/app/helpers/glyph_helper.rb">glyph</a></li>
<li><a href="https://github.com/FortAwesome/font-awesome-sass/blob/23ca05e75e85ec84afecca9f62e7f01d1fb9628b/lib/font_awesome/sass/rails/helpers.rb">icon</a></li>
</ul>


<p><code>icon</code> ã¯ç¬¬2å¼•æ•°ã«æ–‡å­—åˆ—ã‚’æŒ‡å®šã™ã‚‹ã¨é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã¦ãã‚Œã‚‹ã®ã§ã€
ä»Šã¾ã§ã¯</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nt">i</span><span class="o">[</span><span class="nt">class</span><span class="o">^=</span><span class="s2">&quot;icon-&quot;</span><span class="o">]</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span> <span class="s2">&quot; &quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã§ç©ºç™½ã‚’è¶³ã—ã¦ã„ãŸã®ã§ã™ãŒã€</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">icon</span><span class="p">(</span><span class="ss">:pencil</span><span class="p">,</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;.edit&#39;</span><span class="p">,</span> <span class="ss">default</span><span class="p">:</span> <span class="ss">:&#39;helpers.links.edit&#39;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã«ä½¿ã†ã®ã‚‚è‰¯ã•ãã†ã§ã™ã€‚</p>

<p>ä»Šå›ã¯æ›¸ãæ›ãˆã®æ‰‹é–“ã‚’æ¸›ã‚‰ã™ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ä»Šã¾ã§ã¨åŒã˜ã‚ˆã†ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã§ç©ºç™½ã‚’å…¥ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
ä½•ã®ã‚¹ã‚¿ã‚¤ãƒ«ãŒå½±éŸ¿ã—ã¦ã„ã‚‹ã®ã‹èª¿ã¹ã¦ã„ãªã„ã®ã§ã™ãŒã€åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã ã¨ã†ã¾ãã„ã‹ãªã‹ã£ãŸã®ã§ã€ NBSP ã‚’ç›´æ¥åŸ‹ã‚è¾¼ã¿ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nt">i</span><span class="nc">.fa</span><span class="nd">:after</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">content</span><span class="o">:</span> <span class="s2">&quot;Â &quot;</span><span class="p">;</span> <span class="o">//</span> <span class="n">nbsp</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã„ãã¤ã‹ã®ã‚¢ã‚¤ã‚³ãƒ³ã®åå‰ã¯å¤‰æ›´ãŒå¿…è¦ã§ã—ãŸã€‚
ä½¿ã£ã¦ã„ã¦å½±éŸ¿ãŒã‚ã£ãŸã®ã¯ä»¥ä¸‹ã®ã‚¢ã‚¤ã‚³ãƒ³ã§ã—ãŸã€‚</p>

<ul>
<li>å¤‰æ›´å‰ å¤‰æ›´å¾Œ</li>
<li>comment-alt comment-o</li>
<li>folder_close folder</li>
<li>picture picture-o</li>
<li>remove times</li>
<li>signin sign-in</li>
<li>signout sign-out</li>
<li>star-empty star-o</li>
<li>trash trash-o</li>
</ul>


<h2>pagination</h2>

<p>kaminari ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã€
<code>app/views/kaminari/_paginator.html.*</code>
ã®
<code>nav.pagination ul</code>
ã¨ã„ã†æ§‹é€ ã«ãªã£ã¦ã„ã‚‹éƒ¨åˆ†ã‚’
<code>ul.pagination</code>
ã«æ›¸ãæ›ãˆã‚‹ã ã‘ã§ã—ãŸã€‚</p>

<h2>label</h2>

<p><code>btn</code> ã¨åŒæ§˜ã« <code>label</code> å˜ç‹¬ã§ã¯ãªã <code>label-default</code> ã¨çµ„ã¿åˆã‚ã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>

<p>é¸æŠã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã« <code>label-inverse</code> ã‚’ä½¿ã£ã¦ã„ãŸã®ã«ãªããªã£ã¦ã—ã¾ã£ãŸã®ã§ã€
<code>label-primary</code> ã«å¤‰ãˆã¾ã—ãŸã€‚</p>

<p>æ„å‘³çš„ã«ã¯ <code>.nav</code> ã«å¤‰ãˆãŸæ–¹ãŒè‰¯ã•ãã†ãªã®ã§ã€
ä¸€é€šã‚Šä¸€æ™‚çš„ãªå¯¾å‡¦ã‚’ã—ãŸå¾Œã«ã¡ã‚ƒã‚“ã¨å¤‰æ›´ã—ã‚ˆã†ã¨æ€ã£ã¦ã„ã¾ã™ã€‚</p>

<h2>muted</h2>

<p><code>.muted</code> ã¯ <code>.text-muted</code> ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚</p>

<h2>å‚è€ƒã‚µã‚¤ãƒˆ: Bootstrap3ç§»è¡Œã‚¬ã‚¤ãƒ‰</h2>

<p>åŸºæœ¬çš„ã«æœ¬å®¶ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ã„ãŸã®ã§ã™ãŒã€
ã“ã“ã¾ã§å¤‰æ›´ã—ã¦ã‹ã‚‰ 2 ã‹ã‚‰ 3 ã¸ã®ç§»è¡Œã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¢ã—ã¦ã€
<a href="http://bootstrap.s1.adexd.net/">Bootstrap3ç§»è¡Œã‚¬ã‚¤ãƒ‰</a>
ã‚’ã¿ã¤ã‘ã¦è¦‹ã¦ã¿ãŸã®ã§ã™ãŒã€å…¨ä½“ã¨ã—ã¦ã¯éå¸¸ã«å‚è€ƒã«ãªã‚‹ã®ã§ã™ãŒã€
æ‰€ã€…æ°—ã«ãªã‚‹ç‚¹ãŒã‚ã‚Šã¾ã—ãŸã€‚
é€£çµ¡å…ˆãŒè¦‹ã¤ã‘ã‚‰ã‚Œãªã‹ã£ãŸã®ã§ã€ã“ã“ã«ãƒ¡ãƒ¢ã—ã¦ãŠãã¾ã™ã€‚</p>

<p><a href="http://bootstrap.s1.adexd.net/css.php#grid">ã‚°ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ ï¼ˆGrid systemï¼‰</a>
ã®ã€Bootstrap2.xã¨ã®å¤‰æ›´ç®‡æ‰€ã€‘ã®èª¬æ˜ã§ <code>.row</code> ã¨ä½¿ã„åˆ†ã‘ã‚‹ã¨æ›¸ã„ã¦ã„ã‚‹ã®ã¯
é–“é•ã„ã ã¨æ€ã„ã¾ã™ã€‚</p>

<p>ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼ç”¨ã®ã‚¯ãƒ©ã‚¹ã‚’
<a href="http://bootstrap.s1.adexd.net/css.php#screen-reader">ã™ã¹ã¦ã®è¦ç´ ã®è¡¨ç¤ºã‚’éš ã™</a>
ã¨èª¬æ˜ã—ã¦ã„ã‚‹ãªã©ã€ãŸã¾ã«é–“é•ã„ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚</p>

<h2>ç¾çŠ¶ã¾ã¨ã‚</h2>

<p>layouts ã¨ã„ãã¤ã‹ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã«å¯¾å¿œã™ã‚‹ views ã‚’å¤‰æ›´ã™ã‚Œã°
ã‚ã‚‹ç¨‹åº¦è‡ªåˆ†ã®ã‚¢ãƒ—ãƒªã§ä½¿ã£ã¦ã„ã‚‹ã‚‚ã®ã¯ç¶²ç¾…ã§ãã‚‹ã®ã§ã€
ãã“ã‹ã‚‰ã¯ç§»è¡Œã«å¿…è¦ãªå¤‰æ›´ç‚¹ã¯ã‚ã‹ã£ã¦ãã¦é€Ÿããªã£ã¦ã„ãæ„Ÿã˜ã§ã—ãŸã€‚</p>

<p>å…ˆæ—¥æ›¸ã„ãŸ haml ã‹ã‚‰ slim ã¸ã®ç§»è¡Œã‚‚åŒæ™‚ã«ã‚„ã£ã¦ã„ã¦ã€
views å…¨ä½“ã‚’è¦‹ç›´ã™è‰¯ã„æ©Ÿä¼šã«ãªã£ã¦ã„ã¾ã™ã€‚</p>

<p>ä¸€éƒ¨ã§ jquery-ui ã‚’ä½¿ã£ã¦ã„ã¦ã€
æ©Ÿèƒ½çš„ã«ã¯å•é¡Œãªã„ã®ã§ã™ãŒã€
è¦‹ãŸç›®ãŒ bootstrap 3 ã¨ãªã˜ã¾ãªã„ã®ã§ã€
å¾Œã§å¯¾å‡¦ãŒå¿…è¦ãã†ã§ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[hamlã‹ã‚‰slimã¸ã®ç§»è¡Œã§ã²ã£ã‹ã‹ã£ãŸã“ã¨]]></title>
    <link href="http://blog.n-z.jp/blog/2014-03-11-haml-to-slim.html"/>
    <updated>2014-03-11T22:39:11+09:00</updated>
    <id>http://blog.n-z.jp/blog/haml-to-slim</id>
    <content type="html"><![CDATA[<p>haml ã‚ˆã‚Š slim ã®æ–¹ãŒé€Ÿã„ã‚‰ã—ã„ã¨ã„ã†è©±ã‚’è‰¯ãè¦‹ã‹ã‘ã‚‹ã®ã§ã€
haml ã‹ã‚‰å°‘ã—ãšã¤ slim ã«ç§»è¡Œã—ã‚ˆã†ã¨ã—ã¦ã€
haml2slim ã§å¤‰æ›ã—ã¦ã¿ãŸã‚‰ã²ã£ã‹ã‹ã‚Šã¾ãã‚Šã¾ã—ãŸã€‚</p>

<!--more-->


<h2>ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒãªã„</h2>

<p>haml ã¯ç”Ÿæˆã•ã‚Œã‚‹ HTML ãŒã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã•ã‚Œã¦ã„ã¦ã¿ã‚„ã™ã„ã®ã§ã™ãŒã€
slim ã¯ä¸è¦ãªã‚¹ãƒšãƒ¼ã‚¹ã¯å…¥ã‚Œãšã«ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãª HTML ãŒç”Ÿæˆã•ã‚Œã‚‹ã‚ˆã†ã§ã€
å˜ç´”ã«æ¯”è¼ƒã§ããªãã¦å›°ã‚Šã¾ã—ãŸãŒã€
<a href="https://github.com/slim-template/slim#default-options">https://github.com/slim-template/slim#default-options</a>
ã§è¨­å®šã§ãã‚‹ã‚ˆã†ã ã£ãŸã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>config/initializers/slim.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">if</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">development?</span>
</span><span class='line'>  <span class="ss">Slim</span><span class="p">:</span><span class="ss">:Engine</span><span class="o">.</span><span class="n">set_default_options</span> <span class="ss">pretty</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>1.9 hash style</h2>

<p><a href="https://github.com/slim-template/haml2slim/pull/23">https://github.com/slim-template/haml2slim/pull/23</a>
ã« pull request ãŒã§ã¦ã„ã‚‹ã‚ˆã†ã«
haml ã§å±æ€§ã‚’ <code>{foo: bar}</code> ã®ã‚ˆã†ã«æ›¸ãå½¢å¼ã«ã¯å¯¾å¿œã—ã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚</p>

<h2>string interpolation ãŒãŠã‹ã—ã„</h2>

<p><a href="https://github.com/slim-template/haml2slim/issues/7">https://github.com/slim-template/haml2slim/issues/7</a>
ãªã©ã§å ±å‘Šã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã« <code>#{ ... }</code> ã¨ã„ã†æ›¸ãæ–¹ã®å¤‰æ›ã§å•é¡ŒãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚
<code>%tag(foo="#{bar}")</code> ãŒ <code>tag(foo="# bar ")</code> ã«ãªã£ã¦ã„ã¦æ°—ã¥ãã¾ã—ãŸã€‚</p>

<h2>HTML ã‚³ãƒ¡ãƒ³ãƒˆã®ä¸­ã§ã‚¿ã‚°ã«ãªã‚‰ãªã„</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="c">/</span><span class="cs">[if lt IE 9]</span><span class="c"></span>
</span><span class='line'>  <span class="nt">%script</span><span class="p">{</span><span class="ss">src</span><span class="p">:</span> <span class="n">url_for</span><span class="p">(</span><span class="n">html5shiv</span><span class="p">)}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã«æ›¸ã„ã¦ã„ãŸã®ãŒ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>/![if lt IE 9]
</span><span class='line'>  script src: url_for(html5shiv)
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã«å¤‰æ›ã•ã‚Œã¦ã•ã£ã±ã‚Šãƒ€ãƒ¡ã ã£ãŸã®ã§ã€</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>/[if lt IE 9]
</span><span class='line'>  script(src=&quot;#{url_for(html5shiv)}&quot;)
</span></code></pre></td></tr></table></div></figure>


<p>ã¾ãŸã¯</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>/[if lt IE 9]
</span><span class='line'>  script(src=url_for(html5shiv))
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¾ã—ãŸã€‚
HTML ã‚³ãƒ¡ãƒ³ãƒˆ <code>/!</code> ã®ä¸­ã ã¨ã‚¿ã‚°ãŒä½¿ãˆãªã„ (ãã®ã¾ã¾æ–‡å­—åˆ—ã¨ã—ã¦ã‚³ãƒ¡ãƒ³ãƒˆã®ä¸­ã«å…¥ã‚‹) ã‚ˆã†ãªã®ã§ã€
IE ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ«ã‚³ãƒ¡ãƒ³ãƒˆ <code>/[...]</code> ã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚</p>

<h2>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‹ã‚Šã«ãã„</h2>

<p>æ›¸ãæ›ãˆé€”ä¸­ã§ã€å±æ€§å€¤ã‚’ããã‚‹ <code>""</code> ã‚’å¿˜ã‚Œã‚‹ã¨
ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ
<code>syntax error, unexpected ';'</code>
ã¨ã—ã‹ã§ãªã„ã®ã§åŸå› ãŒã‚ã‹ã‚Šã«ããã¦å›°ã‚Šã¾ã—ãŸã€‚</p>

<p>ä»–ã®ã¨ã“ã‚ã§ã‚‚ ruby ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãã®ã¾ã¾ãªã®ã§ã€
é–‰ã˜å¿˜ã‚Œç³»ã¯åŸå› ã®è¡Œã¨é›¢ã‚ŒãŸã¨ã“ã‚ã§ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã€
è¡Œç•ªå·ã‚‚ã‚ã¾ã‚Šå½“ã¦ã«ãªã‚‰ãªãã¦ä¸ä¾¿ã§ã™ã€‚</p>

<h2>çœŸå½å€¤å±æ€§ã®å±æ€§å€¤ãŒçœç•¥ã§ããªã„</h2>

<p>haml ã ã¨ <code>%div(data-pjax-container)</code> ã§ <code>&lt;div data-pjax-container&gt;</code> ã«å¤‰æ›ã§ãã‚‹ã®ã«ã€
slim ã ã¨ <code>div(data-pjax-container)</code> ãŒ <code>&lt;div data-pjax-container=""&gt;</code> ã«ãªã£ã¦ã—ã¾ã£ã¦ã€
<code>=""</code> ãŒä½™è¨ˆã§ã™ã€‚</p>

<p><a href="https://github.com/slim-template/slim/issues/480">Render boolean attributes without value in html5</a>
ã«ã‚ˆã‚‹ã¨
<code>:format</code> ã‚’ <code>:html</code> ã«ã™ã‚Œã°è‰¯ã„ã¨ã„ã†ã“ã¨ã§</p>

<figure class='code'><figcaption><span>config/initializers/slim.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">Slim</span><span class="p">:</span><span class="ss">:Engine</span><span class="o">.</span><span class="n">set_default_options</span> <span class="nb">format</span><span class="p">:</span> <span class="ss">:html</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã¨è¨­å®šã—ã¦ã¿ã¦ã‚‚ slim 2.0.2 ã ã¨å¤‰åŒ–ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>

<p>ã¾ã ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã€
<code>Gemfile</code> ã§ <code>gem 'slim', github: 'slim-template/slim'</code> ã¨æŒ‡å®šã—ã¦
è©¦ãã†ã¨ã—ãŸã®ã§ã™ãŒã€
rails 3.2.17 ã¨ã®çµ„ã¿åˆã‚ã›ã¯ tilt ã®è¦æ±‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è§£æ±ºãŒ
å‡ºæ¥ãªãã¦ä½¿ãˆã¾ã›ã‚“ã§ã—ãŸã€‚</p>

<p>å®Ÿé¨“ã®ãŸã‚ slim å°‚ç”¨ã® Gemfile ã‚’ç”¨æ„ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«è©¦ã—ãŸã¨ã“ã‚ã€
slim ã¨ temple ã®ä¸¡æ–¹ã‚’ã¾ã ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã™ã‚‹ã¨
ä½¿ãˆã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> mkdir /tmp/slim-test
</span><span class='line'><span class="gp">%</span> <span class="nb">cd</span> /tmp/slim-test
</span><span class='line'><span class="gp">%</span> bundle init
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">&#39;gem &quot;slim&quot;, github: &quot;slim-template/slim&quot;&#39;</span> &gt;&gt; Gemfile
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">&#39;gem &quot;temple&quot;, github: &quot;judofyr/temple&quot;&#39;</span> &gt;&gt; Gemfile
</span><span class='line'><span class="gp">%</span> bundle
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">&#39;div(ng-app)&#39;</span> | bundle <span class="nb">exec </span>slimrb
</span><span class='line'><span class="go">&lt;div ng-app=&quot;&quot;&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">&#39;div(ng-app)&#39;</span> | bundle <span class="nb">exec </span>slimrb -o <span class="nv">format</span><span class="o">=</span>:html
</span><span class='line'><span class="go">&lt;div ng-app&gt;&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä»Šã®ã¨ã“ã‚ã€ <code>rack-pjax</code> ã®ä½¿ç”¨ã¯æ­¢ã‚ã¦ã„ã¦ã€
 <code>=""</code> ãŒã¤ãæŒ™å‹•ã§ç›´æ¥å›°ã‚‹ã“ã¨ã¯ãªã•ãã†ãªã®ã§ã€
ã“ã®å•é¡Œã¯ä¿ç•™ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p>

<h2>javascript ã‚„ css ã®åŸ‹ã‚è¾¼ã¿</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nd">:javascript</span>
</span><span class='line'>  <span class="nd">window.current_user_id = </span><span class="si">#{</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">to_i</span><span class="si">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã®ã‚ˆã†ã«æ›¸ã„ã¦ã„ãŸã‚‰ã€</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>javascript:
</span><span class='line'>  | window.current_user_id = #{current_user.id.to_i}
</span></code></pre></td></tr></table></div></figure>


<p>ã¨å¤‰æ›ã•ã‚Œã¦ <code>|</code> ãŒãã®ã¾ã¾ <code>script</code> ã®ä¸­èº«ã«ä»˜ã„ã¦ã—ã¾ã£ãŸã®ã§ã€
å‰Šé™¤ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>javascript:
</span><span class='line'>  window.current_user_id = #{current_user.id.to_i}
</span></code></pre></td></tr></table></div></figure>


<p><code>:css</code> ã‹ã‚‰ <code>css:</code> ã®å¤‰æ›ã§ã‚‚åŒæ§˜ã§ã—ãŸã€‚
CSS ã®å ´åˆã¯è¡Œé ­ãŒè¨˜å·ã ã¨ <code>|</code> ãŒã¤ã„ã¦ã„ãªã„ã“ã¨ã‚‚ã‚ã‚Šã¾ã—ãŸã€‚</p>

<h2>ç©ºç™½ã®æœ‰ç„¡ã®å•é¡Œ</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>        <span class="p">=</span> <span class="n">link_to</span> <span class="n">home_path</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">&#39;brand&#39;</span> <span class="k">do</span>
</span><span class='line'>          <span class="p">=</span> <span class="n">image_tag</span><span class="p">(</span><span class="s2">&quot;brand.png&quot;</span><span class="p">,</span> <span class="ss">alt</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="ss">size</span><span class="p">:</span> <span class="s2">&quot;35x35&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="p">=</span> <span class="n">base_title</span>
</span></code></pre></td></tr></table></div></figure>


<p>ãŒãã®ã¾ã¾ slim ã«ãªã£ã¦ã„ã¦ã€åŸºæœ¬çš„ã«ã¯å•é¡Œãªã‹ã£ãŸã®ã§ã™ãŒã€
haml ã¨é•ã£ã¦ slim ã ã¨ã‚¿ã‚°ã¨ã‚¿ã‚¤ãƒˆãƒ«ã®é–“ã«ç©ºç™½ãŒå…¥ã‚‰ãªããªã£ã¦ã—ã¾ã£ã¦ã€
è¦‹ãŸç›®ãŒå¤‰ã‚ã£ã¦ã—ã¾ã£ã¦ã„ãŸã®ã§ã€
<code>'</code> ã ã‘ã®è¡Œã‚’è¿½åŠ ã—ã¦ç©ºç™½ãŒå…¥ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>        = link_to home_path, class: &#39;brand&#39; do
</span><span class='line'>          = image_tag(&quot;brand.png&quot;, alt: &quot;&quot;, size: &quot;35x35&quot;)
</span><span class='line'>          &#39;
</span><span class='line'>          = base_title
</span></code></pre></td></tr></table></div></figure>


<h2>end ãŒæŠœã‘ã‚‹ãƒã‚°ã§ SyntaxError</h2>

<p><code>syntax error, unexpected keyword_ensure, expecting keyword_end</code>
ã«ãªã‚‹ã®ã§åŸå› ã‚’èª¿ã¹ã¦ã¿ãŸã¨ã“ã‚ã€
ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®ä¸­ã®æœ€åˆãŒã‚³ãƒ¡ãƒ³ãƒˆã ã¨ã€
ãã®ãƒ–ãƒ­ãƒƒã‚¯ã® <code>end</code> ãŒæŠœã‘ã¦ã—ã¾ã†ã‚ˆã†ã§ã™ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">$&#39;- if true\n  / comment&#39;</span> | bundle <span class="nb">exec </span>slimrb -e
</span><span class='line'><span class="go">&lt;% if true</span>
</span><span class='line'>
</span><span class='line'><span class="go"> %&gt;</span>
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">$&#39;- if true\n  |&#39;</span> | bundle <span class="nb">exec </span>slimrb -e
</span><span class='line'><span class="go">&lt;% if true</span>
</span><span class='line'>
</span><span class='line'><span class="go">end %&gt;</span>
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">$&#39;- articles.each do |a|\n  / comment&#39;</span> | bundle <span class="nb">exec </span>slimrb -e
</span><span class='line'><span class="go">&lt;% articles.each do |a|</span>
</span><span class='line'>
</span><span class='line'><span class="go"> %&gt;</span>
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">$&#39;- articles.each do |a|\n  | text&#39;</span> | bundle <span class="nb">exec </span>slimrb -e
</span><span class='line'><span class="go">&lt;% articles.each do |a|</span>
</span><span class='line'><span class="go"> %&gt;text&lt;%</span>
</span><span class='line'><span class="gp">%</span>&gt;&lt;% end %&gt;
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">$&#39;- articles.each do |a|\n  / comment\n/ more comment&#39;</span> | bundle <span class="nb">exec </span>slimrb -e
</span><span class='line'><span class="go">&lt;% articles.each do |a|</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="go"> %&gt;</span>
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">$&#39;- articles.each do |a|\n  / comment\n| text\n/ more comment&#39;</span> | bundle <span class="nb">exec </span>slimrb -e
</span><span class='line'><span class="go">&lt;% articles.each do |a|</span>
</span><span class='line'>
</span><span class='line'><span class="go"> %&gt;text&lt;%</span>
</span><span class='line'><span class="gp">%</span>&gt;&lt;%
</span><span class='line'><span class="gp">%</span>&gt;
</span><span class='line'><span class="gp">%</span> <span class="nb">echo</span> <span class="s1">$&#39;- articles.each do |a|\n  / comment\n| text\n&#39;</span> | bundle <span class="nb">exec </span>slimrb -e
</span><span class='line'><span class="go">&lt;% articles.each do |a|</span>
</span><span class='line'>
</span><span class='line'><span class="go"> %&gt;text&lt;%</span>
</span><span class='line'><span class="gp">%</span>&gt;
</span></code></pre></td></tr></table></div></figure>


<p>ã“ã®ä»¶ã¯ <a href="https://github.com/slim-template/slim/issues/485">https://github.com/slim-template/slim/issues/485</a> ã§å ±å‘Šã—ã¦ã¿ã¾ã—ãŸã€‚</p>

<h2>ãƒ•ã‚¡ã‚¤ãƒ«åã®æŒ‡å®šãŒé¢å€’</h2>

<p>ã“ã‚Œã¯ slim ã‚„ haml2slim ã®å•é¡Œã§ã¯ãªã„ã®ã§ã™ãŒã€
zsh ã§ä¹…ã—ã¶ã‚Šã« compctl ã‚’ä½¿ã£ã¦</p>

<pre><code>compctl -g '*.haml' + -g '*(-/)' haml2slim
</code></pre>

<p>ã¨è¨­å®šã—ã¾ã—ãŸãŒã€ã¡ã‚ƒã‚“ã¨ compsys ã‚’ä½¿ã£ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ç›´ã—ã¦ã€</p>

<pre><code>compdef '_files -g "*.haml"' haml2slim
</code></pre>

<p>ã¨è¨­å®šã—ã¾ã—ãŸã€‚</p>

<h2>æ„Ÿæƒ³</h2>

<p>ã‚·ãƒ³ãƒ—ãƒ«ã¨ã‹å…¥åŠ›ãŒæ¥½ã¨ã‹ã„ã†ä¸»è¦³çš„ãªã‚‚ã®ã¯å€‹äººçš„ã«ã¯åŒæ„ã§ããªãã¦åˆ©ç‚¹ã¨ã¯æ€ãˆãªã„ã®ã§ã€
é€Ÿã„ã¨ã„ã†å®¢è¦³çš„ãªç†ç”±ã§ slim ã¸ã®ç§»è¡Œã‚’ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€
haml2slim ã®å‡ºæ¥ãŒæ‚ªã‹ã£ãŸã‚Šã€
ç©ºç™½ã®æ‰±ã„ã®é•ã„ã§åŒã˜ã‚ˆã†ãªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã§ã‚‚æœ€çµ‚çš„ãªè¦‹ãŸç›®ãŒé•ã†ã‚‚ã®ãŒå‡ºæ¥ãŸã‚Šã—ã¦ã€
ç§»è¡Œã¯æ€ã£ãŸã‚ˆã‚Šå¤§å¤‰ãªå°è±¡ã‚’å—ã‘ã¾ã—ãŸã€‚</p>

<p>ã¯ã¾ã‚Šã©ã“ã‚ã•ãˆã‚ã‹ã£ã¦ã„ã‚Œã°ã€ãã“ã‚’æ³¨æ„ã—ã¦ haml2slim ã§ã®å¤‰æ›çµæœã‚’ä¿®æ­£ã—ã¦ã„ã‘ã°è‰¯ã„ã®ã§ã€é€”ä¸­ã‹ã‚‰ã¯ã©ã‚“ã©ã‚“å¤‰æ›ã—ã¦ã„ã‘ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
(ã¾ã ä¸€éƒ¨ã—ã‹çµ‚ã‚ã£ã¦ã„ã¾ã›ã‚“ãŒã€‚)</p>

<p>ãã‚Œãªã‚Šã®æ•°ã®å¤‰æ›ã‚’ã—ã¦ã¿ãŸçµæœã€æœ€åˆã‹ã‚‰ slim ã§æ›¸ãã‚ˆã†ã«ã™ã‚Œã° haml ã¨å¤§ããªé•ã„ã¯ãªã•ãã†ã«ã‚‚æ„Ÿã˜ã¾ã—ãŸã€‚</p>

<p><code>end</code> æŠœã‘ãªã©ã®å•é¡ŒãŒèµ·ããŸã“ã¨ã‹ã‚‰ã€
haml ã¨æ¯”ã¹ã¦ã„ã‚ã‚“ãªæ›¸ãæ–¹ã§ä½¿ã‚ã‚Œã¦ã„ãªã•ãã†ã¨ã„ã†ã“ã¨ã§ã€
ã¾ã å®‰å®šã—ã¦ãªã•ãã†ã¨æ„Ÿã˜ã¾ã—ãŸã€‚</p>

<p>ã¾ãŸå±æ€§å€¤ãªã—ã® <code>&lt;div ng-app&gt;</code> ã®ã‚ˆã†ãªå‡ºåŠ›ã«å¯¾å¿œã—ã¦ã„ã‚‹ãƒªãƒªãƒ¼ã‚¹ãŒã¾ã ãªã„ãªã©ã€
èé€šãŒåˆ©ã‹ãªã„ç‚¹ãŒã‚ã£ã¦å•é¡ŒãŒèµ·ããã†ãªå¯èƒ½æ€§ãŒã‚ã‚Šãã†ã ã¨æ„Ÿã˜ã¾ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby 2.1.1ã®Hash#rejectã®ä¸å…·åˆå¯¾ç­–]]></title>
    <link href="http://blog.n-z.jp/blog/2014-03-11-hash-reject.html"/>
    <updated>2014-03-11T14:22:28+09:00</updated>
    <id>http://blog.n-z.jp/blog/hash-reject</id>
    <content type="html"><![CDATA[<p><a href="https://www.ruby-lang.org/ja/news/2014/03/10/regression-of-hash-reject-in-ruby-2-1-1/">Ruby 2.1.1 ã«å«ã¾ã‚Œã‚‹ Hash#reject ã®ä¸å…·åˆã«ã¤ã„ã¦</a>
ã¨ã„ã†è©±ãŒã‚ã£ã¦ã€
è‡ªåˆ†ã§æ›¸ãã‚³ãƒ¼ãƒ‰ã§ã¯æ™®é€šã¯ Hash ã‚’ç¶™æ‰¿ã™ã‚‹ã“ã¨ã¯ãªã„ (is-a ã«ã›ãšã« has-a ã«ã™ã‚‹ã“ã¨ãŒå¤šã„) ã®ã§å½±éŸ¿ã¯ãªã„ã®ã§ã™ãŒã€
Rails ã®ä¸­ã® ActiveSupport ãŒå½±éŸ¿ã‚’å—ã‘ã‚‹ã¨ã„ã†ã“ã¨ã§å¯¾å‡¦ã‚’å…¥ã‚Œã¾ã—ãŸã€‚</p>

<p>ä»–ã«ã‚‚ãƒãƒƒã‚¯ãƒãƒ¼ãƒˆæ¼ã‚Œã®ã‚³ãƒŸãƒƒãƒˆã‚’ã‚ã¦ãŸç‹¬è‡ªãƒ“ãƒ«ãƒ‰ã‚’ä½¿ã†ã¨ã‹ã€
Ruby 2.1.0 ã‚’ä½¿ã†ã€ã¨ã„ã†å¯¾å‡¦ã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ã€‚</p>

<!--more-->


<p><a href="https://github.com/rails/rails/issues/14188">Rails ã® Issue #14188</a>
ã§è©±ãŒã‚ã‚‹ã‚ˆã†ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¿®æ­£ã§ã¯ãªã„ãŸã‚ã€
Rails 3.2 ç³»ã«ã“ã®ä¿®æ­£ã¯å…¥ã‚‰ãªã„ã®ã§ã€
ãƒ¢ãƒ³ã‚­ãƒ¼ãƒ‘ãƒƒãƒã‚’å…¥ã‚Œã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p>

<p>bugs.ruby-lang.org ã§ã¯
<a href="https://github.com/ruby/bugs.ruby-lang.org/blob/ro-2-5/lib/redmine/core_ext.rb">https://github.com/ruby/bugs.ruby-lang.org/blob/ro-2-5/lib/redmine/core_ext.rb</a>
ã®ã‚ˆã†ã«å¯¾å‡¦ã—ã¦ã„ãŸã®ã‚’å‚è€ƒã«ã—ã¦ã€
ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’
<code>config/initializers/hash_reject.rb</code>
ã«ç½®ã„ã¦å¯¾å‡¦ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>config/initializers/hash_reject.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># monkey patch for regression of Hash#reject in Ruby 2.1.1</span>
</span><span class='line'><span class="c1"># see https://www.ruby-lang.org/ja/news/2014/03/10/regression-of-hash-reject-in-ruby-2-1-1/</span>
</span><span class='line'><span class="c1"># or https://www.ruby-lang.org/en/news/2014/03/10/regression-of-hash-reject-in-ruby-2-1-1/</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;active_support/hash_with_indifferent_access&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;active_support/ordered_hash&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">ActiveSupport</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">HashWithIndifferentAccess</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">dup</span><span class="o">.</span><span class="n">tap</span> <span class="p">{</span> <span class="o">|</span><span class="nb">hash</span><span class="o">|</span> <span class="nb">hash</span><span class="o">.</span><span class="n">select!</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">reject</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">dup</span><span class="o">.</span><span class="n">tap</span> <span class="p">{</span> <span class="o">|</span><span class="nb">hash</span><span class="o">|</span> <span class="nb">hash</span><span class="o">.</span><span class="n">reject!</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">class</span> <span class="nc">OrderedHash</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">dup</span><span class="o">.</span><span class="n">tap</span> <span class="p">{</span> <span class="o">|</span><span class="nb">hash</span><span class="o">|</span> <span class="nb">hash</span><span class="o">.</span><span class="n">select!</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">reject</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">dup</span><span class="o">.</span><span class="n">tap</span> <span class="p">{</span> <span class="o">|</span><span class="nb">hash</span><span class="o">|</span> <span class="nb">hash</span><span class="o">.</span><span class="n">reject!</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã“ã“ã®ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹å‰ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚Œã°å•é¡Œãªã„ã®ã§ã™ãŒã€
ã“ã“ã§ã‚¯ãƒ©ã‚¹å®šç¾©ã—ã¦ã—ã¾ã†ã¨å…ƒã€…ã®å®šç¾©ãŒ autoload ã•ã‚Œãªããªã‚‹ã®ã§ã€
å¿µã®ãŸã‚ require ã—ã¦ã„ã¾ã™ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ãƒšãƒ¼ã‚¸ã®åˆ‡ã‚Šæ›¿ã‚ã‚Šã”ã¨ã«èƒŒæ™¯ã®è‡ªå‹•å¤‰æ›´]]></title>
    <link href="http://blog.n-z.jp/blog/2014-03-03-auto-change-background.html"/>
    <updated>2014-03-03T23:25:01+09:00</updated>
    <id>http://blog.n-z.jp/blog/auto-change-background</id>
    <content type="html"><![CDATA[<p>ã‚ã‚‹ Rails ã‚¢ãƒ—ãƒªã§ãƒšãƒ¼ã‚¸ã®åˆ‡ã‚Šæ›¿ã‚ã‚Šã”ã¨ã«èƒŒæ™¯ã‚’è‡ªå‹•ã§å¤‰æ›´ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ãŸã®ã§ã™ãŒã€
ãƒ‡ã‚¶ã‚¤ãƒ³å¤‰æ›´ã§ä½¿ã‚ãªããªã£ãŸã®ã§ã€ã©ã†ã„ã†ã“ã¨ã‚’ã‚„ã£ã¦ã„ãŸã®ã‹ã€ãƒ¡ãƒ¢ã¨ã—ã¦æ®‹ã—ã¦ãŠãã“ã¨ã«ã—ã¾ã™ã€‚</p>

<!--more-->


<h2>HTML</h2>

<p>ã¾ãš CSS ç”¨ã®ã‚¯ãƒ©ã‚¹ã¨ã—ã¦è‡ªå‹•å¤‰æ›´ã™ã‚‹ç›®å°ã® <code>background</code> ã¨åˆæœŸçŠ¶æ…‹ã® <code>background-0</code> ã‚’ <code>body</code> ã«è¨­å®šã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>app/views/layouts/application.html.haml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>  <span class="nt">%body</span><span class="nc">.background.background-0</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h2>

<p><code>sessionStorage</code> ã‚’ä½¿ã£ã¦ã‚¿ãƒ–ã”ã¨ã«çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
ä»Šå›ã¯ç”»åƒã¨ã—ã¦ <code>app/assets/images/background-0.jpg</code> ã¨ <code>app/assets/images/background-1.jpg</code> ã® 2 æšã ã‘ã ã£ãŸã®ã§ã€
<code>background_num = 2</code> ã«ã—ã¦ã„ã¾ã™ã€‚</p>

<p>ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸæ™‚ã«ã¯çŸ¥ã‚‰ãªã‹ã£ãŸã®ã§å¯¾å‡¦ãŒå…¥ã£ã¦ã„ãªã„ã®ã§ã™ãŒã€
Safari ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ–ãƒ©ã‚¦ã‚ºã§ã¯ <code>sessionStorage</code> ãŒã‚ã‚‹ã®ã«ä½¿ãˆãªã„ã¨ã„ã†å„ä»‹ãªã“ã¨ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€å¿…è¦ãªã‚‰ãã®ã‚ãŸã‚Šã®ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚‚å…¥ã‚ŒãŸæ–¹ãŒè‰¯ã„ã§ã™ã€‚</p>

<figure class='code'><figcaption><span>app/assets/javascripts/background.js.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">jQuery</span> <span class="nf">-&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="k">typeof</span> <span class="nx">sessionStorage</span> <span class="o">!=</span> <span class="s">&#39;undefined&#39;</span>
</span><span class='line'>    <span class="nv">background_num = </span><span class="mi">2</span>
</span><span class='line'>    <span class="nv">change_background = </span><span class="nf">-&gt;</span>
</span><span class='line'>      <span class="nv">body = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="o">!</span><span class="nx">body</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span>
</span><span class='line'>      <span class="nv">background = </span><span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="nx">background</span>
</span><span class='line'>        <span class="nv">background = </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">background</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&quot;background-&quot;</span> <span class="o">+</span> <span class="nx">background</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">background = </span><span class="p">(</span><span class="nx">background</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nx">background_num</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&quot;background-&quot;</span> <span class="o">+</span> <span class="nx">background</span><span class="p">)</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="nv">background = </span><span class="mi">0</span>
</span><span class='line'>      <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">,</span> <span class="nx">background</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span> <span class="s">&#39;ajax:success.background&#39;</span><span class="p">,</span> <span class="nx">change_background</span>
</span><span class='line'>    <span class="nx">change_background</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ</h2>

<p>rails 4.0.3, sass-rails 4.0.1, sprockets 2.11.0, sprockets-rails 2.0.1
ã§ç¢ºèªã—ãŸã¨ã“ã‚ã€
<code>depend_on_asset</code> ã§ã¯ãªã <code>depend_on</code> ã‚’ä½¿ã£ã¦æ‹¡å¼µå­ä»˜ãã®ãƒ•ã‚¡ã‚¤ãƒ«åã§
ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã« <code>depend_on</code> ã‚’ä¸¦ã¹ã‚Œã°ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ãŸã¨ãã«
<code>rake assets:precompile</code> ã§ <code>css</code> ã‚‚å†ç”Ÿæˆã•ã‚Œã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã—ãŸã€‚</p>

<p>ã¤ã¾ã‚Š <code>//= depend_on "background-1.jpg"</code> ã‚’ <code>.background-1</code> ã®ç›´å‰ã«æŒã£ã¦ã„ãã¨åæ˜ ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚</p>

<p><code>depend_on_asset</code> ã ã¨å…¨ãåæ˜ ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚</p>

<p>ãƒ•ã‚¡ã‚¤ãƒ«ã®æŒ‡å®šã¯ <code>//= depend_on "../images/background-0.jpg"</code> ã‚„ <code>//= depend_on "../images/background-1.jpg"</code> ã®ã‚ˆã†ã«ç›¸å¯¾ãƒ‘ã‚¹ã§ã‚‚ã€ãƒ•ã‚¡ã‚¤ãƒ«åã®ã¿ã§ã‚‚å¤§ä¸ˆå¤«ã§ã—ãŸã€‚</p>

<p><code>image-url</code> ã§å‚ç…§ã—ã¦ã„ã‚‹ã®ã ã‹ã‚‰ã€ãã“ã§è‡ªå‹•çš„ã«ä¾å­˜é–¢ä¿‚ã«å…¥ã£ã¦ã»ã—ã„ã¨ã“ã‚ã§ã™ãŒã€ãã†ã„ã†ä»•çµ„ã¿ã«ã¯ãªã£ã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚
ã¡ã‚ƒã‚“ã¨èª­ã‚“ã§ã„ãªã„ã®ã§ã™ãŒã€
<a href="https://github.com/sstephenson/sprockets/issues/488">Dependent assets might not be recompiled</a>
ã®ã‚ãŸã‚Šã«ã™ã§ã«è©±ãŒå‡ºã¦ã„ã‚‹ã®ã§ã€ä»•æ§˜ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>

<figure class='code'><figcaption><span>app/assets/stylesheets/background.css.scss</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="o">//=</span> <span class="nt">depend_on</span> <span class="s2">&quot;background-0.jpg&quot;</span>
</span><span class='line'><span class="o">//=</span> <span class="nt">depend_on</span> <span class="s2">&quot;background-1.jpg&quot;</span>
</span><span class='line'><span class="nc">.background-0</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">background-image</span><span class="o">:</span> <span class="n">image</span><span class="o">-</span><span class="sx">url(&quot;background-0.jpg&quot;)</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nc">.background-1</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">background-image</span><span class="o">:</span> <span class="n">image</span><span class="o">-</span><span class="sx">url(&quot;background-1.jpg&quot;)</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[autopagerizeã®ã‚ˆã†ãªå‹•ä½œã‚’kaminariã¨ransackã‚’ä½¿ã£ãŸç’°å¢ƒã§å®Ÿè£…ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-02-25-autopagerize-kaminari-ransack.html"/>
    <updated>2014-02-25T18:58:39+09:00</updated>
    <id>http://blog.n-z.jp/blog/autopagerize-kaminari-ransack</id>
    <content type="html"><![CDATA[<p>autopagerize ã®ã‚ˆã†ãªå‹•ä½œã‚’ã™ã‚‹ã¨ãã« id é‡è¤‡å•é¡ŒãŒã‚ã‚‹ã®ã§ã€
<a href="http://qa.atmarkit.co.jp/q/3513">QA@IT ã§è³ªå•</a>
ã—ã¦ã¿ãŸã¨ã“ã‚ã€
ä»Šã®ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹æœ€å¾Œã® id ã§å¯¾å‡¦ã™ã‚‹ã—ã‹ãªã•ãã†ã ã¨ã‚ã‹ã£ãŸã®ã§ã€
ãã†ã„ã†æ–¹é‡ã§å®Ÿè£…ã—ã¦ã¿ã¾ã—ãŸã€‚</p>

<!--more-->


<h2>ã‚¹ã‚¯ãƒªãƒ—ãƒˆéƒ¨åˆ†</h2>

<p>ã‚³ã‚¢éƒ¨åˆ†ã¯ä»¥å‰ã«å®Ÿè£…ã—ãŸã‚‚ã®ã‚’ãã®ã¾ã¾ä½¿ã„ã¾ã—ãŸã€‚
i18n å¯¾å¿œãªã©ãŒå‡ºæ¥ã¦ã„ã¾ã›ã‚“ãŒã€å†’é ­ã«æ›¸ã„ã¦ã‚ã‚‹ id ã‚„ class ãŒé–¢é€£è¦ç´ ã«ãªã‚Šã¾ã™ã€‚</p>

<figure class='code'><figcaption><span>app/assets/javascripts/autonext.js.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">jQuery</span> <span class="nf">-&gt;</span>
</span><span class='line'>  <span class="nv">timerId = </span><span class="kc">null</span>
</span><span class='line'>  <span class="nv">loadingId = </span><span class="s">&#39;#autopager_loading&#39;</span>
</span><span class='line'>  <span class="nv">nextId = </span><span class="s">&#39;#next_for_pager&#39;</span>
</span><span class='line'>  <span class="nv">pageElement = </span><span class="s">&#39;.page_element&#39;</span>
</span><span class='line'>  <span class="nv">lastContent = </span><span class="s">&#39;.page_content:last&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">loadNext = </span><span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nv">nextLink = </span><span class="nx">$</span><span class="p">(</span><span class="nx">nextId</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>    <span class="k">if</span> <span class="nx">nextLink</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">loadingId</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">nextId</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
</span><span class='line'>      <span class="nv">request = </span><span class="nx">$</span><span class="p">.</span><span class="nx">get</span> <span class="nx">nextLink</span><span class="p">.</span><span class="nx">href</span><span class="p">,</span> <span class="nf">(data) -&gt;</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="nx">loadingId</span><span class="p">).</span><span class="nx">before</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">pageElement</span><span class="p">)).</span><span class="nx">hide</span><span class="p">()</span>
</span><span class='line'>        <span class="c1"># å¿…è¦ãªã‚‰ turbolinks ã® `page:change` ã®ã‚ˆã†ãª DOM å¤‰æ›´é€šçŸ¥ã‚’ã™ã‚‹</span>
</span><span class='line'>      <span class="nx">request</span><span class="p">.</span><span class="nx">error</span> <span class="nf">(xhr, status, error) -&gt;</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">error</span> <span class="o">==</span> <span class="s">&quot;Unauthorized&quot;</span>
</span><span class='line'>          <span class="nx">alert</span><span class="p">(</span><span class="s">&quot;èªè¨¼ã®æœŸé™åˆ‡ã‚Œã§ã™ã€‚å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">else</span>
</span><span class='line'>          <span class="nx">alert</span><span class="p">(</span><span class="s">&quot;ä½•ã‹ã‚¨ãƒ©ãƒ¼ã§ã™ã€‚å°‘ã—å¾…ã£ã¦ã‹ã‚‰ã€å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="nx">loadingId</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&quot;&lt;a href=&#39;javascript:location.reload()&#39; class=&#39;btn btn-block btn-primary&#39;&gt;å†èª­ã¿è¾¼ã¿&lt;/a&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="nv">autoNext = </span><span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nv">content = </span><span class="nx">$</span><span class="p">(</span><span class="nx">lastContent</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="nx">content</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">content</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">&lt;</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span>
</span><span class='line'>      <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="nx">loadingId</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">)</span> <span class="o">is</span> <span class="s">&#39;none&#39;</span>
</span><span class='line'>        <span class="nx">loadNext</span><span class="p">()</span>
</span><span class='line'>    <span class="nv">timerId = </span><span class="kc">null</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span> <span class="s">&#39;scroll.autoNext&#39;</span><span class="p">,</span> <span class="nx">autoNextDefer</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">autoNextDefer = </span><span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">off</span> <span class="s">&#39;scroll.autoNext&#39;</span>
</span><span class='line'>    <span class="nv">timerId = </span><span class="nx">setTimeout</span> <span class="nx">autoNext</span><span class="p">,</span> <span class="mi">1000</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span> <span class="s">&#39;scroll.autoNext&#39;</span><span class="p">,</span> <span class="nx">autoNextDefer</span>
</span></code></pre></td></tr></table></div></figure>


<h2>views</h2>

<p>view ã¯æ¬¡ã®ã‚ˆã†ãªæ„Ÿã˜ã«ã—ã¾ã—ãŸã€‚
<code>page_entries_info</code> ã‚’ <code>.page_element</code> ã®ä¸­ã«ã™ã‚‹ã‹ã€å¤–ã«ã™ã‚‹ã‹ã¯æ‚©ã¾ã—ã„ã¨ã“ã‚ã§ã™ã€‚</p>

<figure class='code'><figcaption><span>app/views/posts/index.html.haml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nc">.page_element</span>
</span><span class='line'>  <span class="nt">%small</span><span class="nc">.page-entries-info</span><span class="p">=</span> <span class="n">page_entries_info</span> <span class="vi">@posts</span>
</span><span class='line'>  <span class="p">=</span> <span class="n">render</span> <span class="vi">@posts</span>
</span><span class='line'>  <span class="p">=</span> <span class="n">link_to_auto_next_page_with_ransack</span> <span class="vi">@q</span><span class="p">,</span> <span class="vi">@posts</span><span class="p">,</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;views.pagination.next&#39;</span><span class="p">),</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;btn btn-large btn-block btn-success&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;next_for_pager&quot;</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="n">params</span>
</span><span class='line'><span class="nf">#autopager_loading</span>(<span class="na">style=</span><span class="s">&quot;display:none&quot;</span>)
</span><span class='line'>  <span class="p">=</span> <span class="n">fa_icon</span> <span class="s2">&quot;spinner spin&quot;</span>
</span><span class='line'>  <span class="p">=</span> <span class="n">t</span><span class="p">(</span><span class="s2">&quot;loading&quot;</span><span class="p">,</span> <span class="ss">default</span><span class="p">:</span> <span class="s2">&quot;Loading...&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>kaminari</code> ã® <code>link_to_next_page</code> ã‚’ä½¿ã£ã¦ã„ã‚‹æ™‚ã«å•é¡Œã«ãªã£ãŸã®ã§ã™ãŒã€
<code>params</code> ã‚’ã¡ã‚ƒã‚“ã¨æ¸¡ã•ãªã„ã¨ <code>paginate @posts</code> ã§ç”Ÿæˆã•ã‚Œã‚‹ãƒªãƒ³ã‚¯ã¨é•ã£ã¦
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ä¸è¶³ã«ãªã£ã¦ã—ã¾ã†ã‚ˆã†ã§ã™ã€‚
ãã®ãŸã‚è‡ªä½œã® <code>link_to_auto_next_page_with_ransack</code> ã§ã‚‚æ¸¡ã™ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>

<h2>helper</h2>

<p>ã“ã“ãŒãƒªãƒ³ã‚¯ç”Ÿæˆã®è‚ã«ãªã‚Šã¾ã™ã€‚
ã‚½ãƒ¼ãƒˆã®ã‚­ãƒ¼ã®ã†ã¡ã€ä»Šè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹æœ€å¾Œã®ã‚‚ã®ã‚’ä½¿ã£ã¦ã€
<code>updated_at desc</code> ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãªã‚‰ã€
<code>updated_at_lt</code> ã§æŒ‡å®šã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã‚’ã—ã¦ã„ã¾ã™ã€‚
ä»•çµ„ã¿ã®éƒ½åˆä¸Šã€åŒã˜å€¤ãŒè¤‡æ•°å…¥ã‚‹ã¨è¡¨ç¤ºã•ã‚Œãšã«æŠœã‘è½ã¡ã¦ã—ã¾ã†ã®ã§ã€
<code>id</code> ã‚„ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãªã©ã®ã‚ˆã†ãªã‚«ãƒ©ãƒ ã«é™å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚</p>

<p>æ™‚åˆ»ã¯æ¨™æº–ã® <code>to_s</code> ã ã¨é–‹ç™ºç’°å¢ƒã®ä¸€æ°—ã«å…¥åŠ›ã—ãŸãƒ‡ãƒ¼ã‚¿ã§å•é¡ŒãŒèµ·ããŸã®ã§ã€
<code>strftime</code> ã‚’ä½¿ã£ã¦ <code>%N</code> (ãƒŠãƒç§’) ã¾ã§å…¥ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚</p>

<figure class='code'><figcaption><span>app/helpers/link_to_helper.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">link_to_auto_next_page_with_ransack</span><span class="p">(</span><span class="n">search</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span> <span class="nb">name</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">if</span> <span class="n">scope</span><span class="o">.</span><span class="n">last_page?</span>
</span><span class='line'>    <span class="n">params</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="ss">:params</span><span class="p">)</span> <span class="o">||</span> <span class="p">{}</span>
</span><span class='line'>    <span class="n">sorts</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">sorts</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">sorts</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>      <span class="k">raise</span> <span class="s2">&quot;You must set sorts to ransack (e.g. `@q.sorts = &#39;updated_at desc&#39; if @q.sorts.empty?`)&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">order</span> <span class="o">=</span> <span class="n">sorts</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'>    <span class="n">column</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'>    <span class="n">dir</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">dir</span> <span class="o">==</span> <span class="s2">&quot;desc&quot;</span> <span class="p">?</span> <span class="s2">&quot;lt&quot;</span> <span class="p">:</span> <span class="s2">&quot;gt&quot;</span>
</span><span class='line'>    <span class="n">value</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">last</span><span class="o">[</span><span class="n">column</span><span class="o">]</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="ss">:strftime</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">value</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="ss">:hour</span><span class="p">)</span>
</span><span class='line'>      <span class="c1"># expect Time, DateTime, ActiveSupport::TimeWithZone</span>
</span><span class='line'>      <span class="c1"># and not Date</span>
</span><span class='line'>      <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-%d %H:%M:%S.%N %Z&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">q</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:q</span><span class="o">]</span> <span class="o">||</span> <span class="p">{}</span>
</span><span class='line'>    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">column</span><span class="si">}</span><span class="s2">_</span><span class="si">#{</span><span class="n">dir</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">=&gt;</span> <span class="n">value</span><span class="p">)</span>
</span><span class='line'>    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">search_key</span> <span class="o">=&gt;</span> <span class="n">q</span><span class="p">)</span>
</span><span class='line'>    <span class="n">link_to</span> <span class="nb">name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">reverse_merge</span><span class="p">(</span><span class="ss">:rel</span> <span class="o">=&gt;</span> <span class="s1">&#39;next&#39;</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">block</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>controller</h2>

<p>ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¯ <code>kaminari</code> ã‚„ <code>ransack</code> ã‚’æ™®é€šã«ä½¿ã£ã¦ã„ã‚‹ã ã‘ã§ã™ã€‚
<code>@posts = Post</code> ã®è¡Œã¯ <code>cancan</code> ã® <code>load_and_authorize_resource</code> ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã«ã¯ä¸è¦ãªã®ã§ã€
åˆ¥ã®è¡Œã«ã—ã¦ã„ã¾ã™ã€‚</p>

<figure class='code'><figcaption><span>app/controllers/posts_controller.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@posts</span> <span class="o">=</span> <span class="no">Post</span>
</span><span class='line'>    <span class="vi">@q</span> <span class="o">=</span> <span class="vi">@posts</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:q</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@q</span><span class="o">.</span><span class="n">sorts</span> <span class="o">=</span> <span class="s1">&#39;updated_at desc&#39;</span> <span class="k">if</span> <span class="vi">@q</span><span class="o">.</span><span class="n">sorts</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>    <span class="vi">@posts</span> <span class="o">=</span> <span class="vi">@q</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="ss">distinct</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@posts</span> <span class="o">=</span> <span class="vi">@posts</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ</h2>

<p>èª­ã¿è¾¼ã¿ä¸­ã®éƒ¨åˆ†ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ã€ç”»é¢ã®æœ€ä¸‹éƒ¨ã®æ¨ªå¹…ã„ã£ã±ã„ã«å‡ºã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
ã‚¨ãƒ©ãƒ¼ã®æ™‚ã¯ã“ã®ä¸­èº«ãŒå†èª­ã¿è¾¼ã¿ãƒœã‚¿ãƒ³ã«å¤‰ã‚ã‚Šã¾ã™ã€‚
é–‹ç™ºç’°å¢ƒã ã¨ <code>rails server</code> ã‚’åœæ­¢ã—ãŸçŠ¶æ…‹ã§è‡ªå‹•èª­ã¿è¾¼ã¿ã•ã›ã‚Œã°ã€ã™ãã«ç¢ºèªã§ãã¾ã™ã€‚</p>

<figure class='code'><figcaption><span>app/assets/stylesheets/application.css.scss</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nf">#autopager_loading</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">background-color</span><span class="o">:</span> <span class="m">#000</span><span class="p">;</span>
</span><span class='line'>  <span class="k">bottom</span><span class="o">:</span> <span class="m">0px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">color</span><span class="o">:</span> <span class="m">#fff</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">12px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">25px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">left</span><span class="o">:</span> <span class="m">0px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">opacity</span><span class="o">:</span> <span class="m">0</span><span class="o">.</span><span class="m">8</span><span class="p">;</span>
</span><span class='line'>  <span class="k">position</span><span class="o">:</span> <span class="k">fixed</span><span class="p">;</span>
</span><span class='line'>  <span class="k">text-align</span><span class="o">:</span> <span class="k">center</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">100</span><span class="o">%</span><span class="p">;</span>
</span><span class='line'>  <span class="k">z-index</span><span class="o">:</span> <span class="m">1000</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ã¾ã¨ã‚</h2>

<p>autopagerize ã®ã‚ˆã†ãªè‡ªå‹•èª­ã¿è¾¼ã¿ã‚’ <code>kaminari</code> ã¨ <code>ransack</code> ã‚’ä½¿ã£ãŸ rails ã‚¢ãƒ—ãƒªã«çµ„ã¿è¾¼ã‚“ã å®Ÿè£…ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚
éƒ¨å“ã ã‘ã§å…¨ä½“ã‚’ç¤ºã›ã¦ã„ãªã„ã®ã§ã€ã‚‚ã—ã‹ã—ãŸã‚‰æ›¸ãå¿˜ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ã‚‚ã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€é‡è¦ãªéƒ¨åˆ†ã¯è¼‰ã›ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã®ã§ã€å‚è€ƒã«ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç¬¬ 81 å› é–¢è¥¿ Debian å‹‰å¼·ä¼šã«å‚åŠ ã—ãŸ]]></title>
    <link href="http://blog.n-z.jp/blog/2014-02-23-kansai-debian-meeting.html"/>
    <updated>2014-02-23T14:02:06+09:00</updated>
    <id>http://blog.n-z.jp/blog/kansai-debian-meeting</id>
    <content type="html"><![CDATA[<p><a href="https://wiki.debian.org/KansaiDebianMeeting/20140223">ç¬¬ 81 å› é–¢è¥¿ Debian å‹‰å¼·ä¼š</a>
ã«å‚åŠ ã—ã¦ãã¾ã—ãŸã€‚</p>

<!--more-->


<h2>ã‚‚ãã‚‚ãã®ä¼š</h2>

<p>ä»Šå›ã‚‚ã‚‚ãã‚‚ãã®ä¼šãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<p>å‰å›ã®ã‚‚ãã‚‚ãã®ä¼šã®æ™‚ã«ä½œã£ã¦ã„ãŸ
<a href="https://github.com/znz/rd2markdown-app">rd2markdown</a>
ã‚’ä½¿ã£ã¦
<a href="https://bugs.ruby-lang.org/projects/ruby/wiki">ruby-lang.org ã® Wiki</a>
ã§ RD è¨˜æ³•ã®ã¾ã¾ã«ãªã£ã¦ã„ãŸãƒšãƒ¼ã‚¸ã®å¤‰æ›ã‚’è©¦ã—ã¤ã¤ã€
ã†ã¾ãå¤‰æ›ã§ããªã‹ã£ãŸéƒ¨åˆ†ã‚’ä¿®æ­£ã—ã¦ã€
ã»ã¼ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã‚’å¤‰æ›ã—ã¦ã„ãã¾ã—ãŸã€‚
æœ€çµ‚çš„ã«ã¯å®¶ã«å¸°ã£ã¦ã‹ã‚‰ã€
ã“ã®ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’æ›¸ãå‰ã«æ®‹ã‚Šã‚’å¤‰æ›ã—ã¾ã—ãŸã€‚</p>

<p>æˆæœç™ºè¡¨ãªã©ã®æ™‚ã«ã‚‚å¤‰æ›ä½œæ¥­ã‚’ã—ã¦ã„ãŸã®ã§ã€
ä»–ã®äººã®è©±ã¯ã‚ã¾ã‚Šèã‘ãªã‹ã£ãŸã®ã§ã™ãŒã€
<a href="http://i3wm.org/">http://i3wm.org/</a>
ã‚„
<a href="https://github.com/sn0w75/MikuMikuPenguin">https://github.com/sn0w75/MikuMikuPenguin</a>
ã®è©±ãªã©ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<h2>LT</h2>

<p><a href="http://blog.n-z.jp/blog/2014-02-23-upstart-has-missing-features.html">upstartã«ä¸è¶³ã—ã¦ã„ã‚‹æ©Ÿèƒ½</a>
ã®è©±ã¨
<a href="http://blog.n-z.jp/blog/2014-02-23-boot2docker.html">boot2docker</a>
ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ docker ç’°å¢ƒã§ã®ãƒ‡ãƒ¢ã‚’ã—ã¾ã—ãŸã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[upstartã«ä¸è¶³ã—ã¦ã„ã‚‹æ©Ÿèƒ½]]></title>
    <link href="http://blog.n-z.jp/blog/2014-02-23-upstart-has-missing-features.html"/>
    <updated>2014-02-23T11:15:27+09:00</updated>
    <id>http://blog.n-z.jp/blog/upstart-has-missing-features</id>
    <content type="html"><![CDATA[<p>Ubuntu ã®æ¨™æº–ã® init ã® upstart ã§æ©Ÿèƒ½ä¸è¶³ã‚’æ„Ÿã˜ãŸè©±ã§ã™ã€‚</p>

<!--more-->


<h2>workaround-upstart-snafu</h2>

<p>2012å¹´6æœˆã®é ƒã® Ubuntu ã§èµ·ããŸè©±ã§ã™ã€‚
æ˜”ã®è©±ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©ã‚‚ã¡ã‚ƒã‚“ã¨ãƒ¡ãƒ¢ã—ã¦ã„ãªã‹ã£ãŸã®ã§ã™ãŒã€
å½“æ™‚ã‚µãƒãƒ¼ãƒˆå¯¾è±¡ã ã£ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã©ã‚Œã‹ã§ã™ã€‚</p>

<p>ç¾è±¡ã¨ã—ã¦ã¯è‡ªä½œã® <code>/etc/init/hoge.conf</code> ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«
<code>expect</code> stanza ã‚’è©¦è¡ŒéŒ¯èª¤ã—ã¦ã„ãŸã‚‰ã€
è¨­å®šãŒé–“é•ã£ã¦ã„ãŸã‚‰ã—ãã€
ãƒ—ãƒ­ã‚»ã‚¹ã®çµ‚äº†ã‚’ã¡ã‚ƒã‚“ã¨èªè­˜ã§ããªãã¦ã€
ã‚‚ã†å­˜åœ¨ã—ãªã„ãƒ—ãƒ­ã‚»ã‚¹ ID ã‚’çµ‚äº†ã—ãŸã‚¸ãƒ§ãƒ–ã®ãƒ—ãƒ­ã‚»ã‚¹ ID ã¨ã—ã¦èªè­˜ã—ãŸã¾ã¾
<code>start</code> ã‚‚ <code>stop</code> ã‚‚ãã‹ãªããªã£ã¦ã—ã¾ã£ãŸã€
ã¨ã„ã†ã“ã¨ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>

<p>ã“ã“ã¾ã§ã¯è‡ªåˆ†ãŒæ›¸ã„ãŸè¨­å®šãŒé–“é•ã„ã¨ã„ã†ã“ã¨ã§ã€
åˆ¥ã«è‰¯ã„ã®ã§ã™ãŒã€
ãã®çŠ¶æ…‹ã‚’è§£æ¶ˆã™ã‚‹æ–¹æ³•ãŒ upstart è‡ªä½“ã«ã¯å­˜åœ¨ã—ã¦ã„ãªãã¦ã€
<a href="http://irclogs.ubuntu.com/2011/01/31/%23upstart.html">http://irclogs.ubuntu.com/2011/01/31/%23upstart.html</a>
ã§ç´¹ä»‹ã•ã‚Œã¦ã„ãŸ
<a href="https://github.com/ion1/workaround-upstart-snafu">workaround-upstart-snafu</a>
ã‚’ä½¿ã†ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>

<p>ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æŒ‡å®šã—ãŸãƒ—ãƒ­ã‚»ã‚¹ ID ã«ãªã‚‹ã¾ã§ fork ã—ã¦ã™ãã«çµ‚äº†ã™ã‚‹ã®ã‚’ç¹°ã‚Šè¿”ã—ã¦
upstart ã«è©²å½“ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ ID ã®ãƒ—ãƒ­ã‚»ã‚¹çµ‚äº†ã‚’èªè­˜ã•ã›ã‚‹ã€ã¨ã„ã†ä»•çµ„ã¿ã®ã‚ˆã†ã§ã™ã€‚</p>

<p>ã“ã®ã‚ˆã†ãªç„¡ç†çŸ¢ç†ãªæ–¹æ³•ã§ã¯ãªã upstart è‡ªä½“ã«ãƒ—ãƒ­ã‚»ã‚¹ãŒã¾ã å­˜åœ¨ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ãƒã‚§ãƒƒã‚¯ã—ç›´ã™æ©Ÿèƒ½ãŒå­˜åœ¨ã™ã‚‹ã¹ãã ã¨æ€ã„ã¾ã—ãŸã€‚</p>

<h2>Should-Start</h2>

<p><code>/etc/init.d/</code> ã«ç½®ã‹ã‚Œã‚‹
<a href="https://wiki.debian.org/LSBInitScripts">LSB ã® Init ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</a>
ã«ã¯ã€èµ·å‹•æ™‚ã®é †ç•ª (ä¾å­˜é–¢ä¿‚) ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ›¸ãã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>

<p>ã“ã®æŒ‡å®šã®ä¸­ã«ã¯ <code>Should-Start</code> ã¨ã„ã†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚Œã°å…ˆã«èµ·å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã‘ã‚Œã°å½±éŸ¿ã—ãªã„ã€ã¨ã„ã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚</p>

<p>ãŸã¨ãˆã°ã€
ãƒ‡ãƒ¼ãƒ¢ãƒ³ãŒä¾å­˜ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒåŒã˜ãƒã‚·ãƒ³ã«å…¥ã£ã¦ã„ã‚Œã°
å…ˆã«èµ·å‹•ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã‘ã‚Œã©ã€
åˆ¥ã®ãƒã‚·ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ã€
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªãã¦ã‚‚è‰¯ã„ã€
ã¨ã„ã†ç”¨é€”ãŒæƒ³å®šã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚</p>

<p>å…·ä½“çš„ãªä¾‹ã¨ã—ã¦ã¯
Ubuntu 13.10 ã®
<code>zabbix-server-pgsql</code> 2.0.6+dfsg-1ubuntu2
ã®
<code>/etc/init.d/zabbix-server</code>
ã§ã¯</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>### BEGIN INIT INFO
</span><span class='line'># Provides:          zabbix-server
</span><span class='line'># Required-Start:    $remote_fs $network
</span><span class='line'># Required-Stop:     $remote_fs
</span><span class='line'># Default-Start:     2 3 4 5
</span><span class='line'># Default-Stop:      0 1 6
</span><span class='line'># Should-Start:      postgresql
</span><span class='line'># Should-Stop:       postgresql
</span><span class='line'># Short-Description: Start zabbix-server daemon
</span><span class='line'># Description: Start zabbix-server daemon (PostgreSQL)
</span><span class='line'>### END INIT INFO</span></code></pre></td></tr></table></div></figure>


<p>ã¨ãªã£ã¦ã„ã¦ã€
<code>postgresql</code> ã‚ˆã‚Šå¾Œã«èµ·å‹•ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã«ã€</p>

<p><code>/etc/init/zabbix-server.conf</code>
ã§ã¯</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>start on (filesystem and net-device-up IFACE=lo)
</span><span class='line'>stop on runlevel [!2345]</span></code></pre></td></tr></table></div></figure>


<p>ã¨ãªã£ã¦ã„ã¦ã€èµ·å‹•é †åºã®é–¢ä¿‚ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚</p>

<p>ãã®çµæœã€
<code>zabbix-server</code> ã®æ–¹ãŒ <code>postgresql</code> ã‚ˆã‚Šæ—©ãèµ·å‹•ã—ã¦ã—ã¾ã£ã¦ã€
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã§ããªãã¦èµ·å‹•ã«å¤±æ•—ã™ã‚‹ã€
ã¨ã„ã†ã“ã¨ãŒèµ·ãã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã—ãŸã€‚
(ä»¥å‰ã® Ubuntu ã§èµ·ãã¦ã„ãŸç¾è±¡ã§ Ubuntu 13.10 ã ã¨åˆ¥ã®ç¾è±¡ã«ãªã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ã€
å†åº¦æ¤œè¨¼ãŒå¿…è¦ãã†ã§ã™ã€‚)</p>

<p>å¯¾ç­–ã¨ã—ã¦
<code>/etc/cron.d/local</code>
ã«</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># zabbix-server may fail to start before postgresql
</span><span class='line'>@reboot root /usr/sbin/service zabbix-server start</span></code></pre></td></tr></table></div></figure>


<p>ã¨ã„ã†è¨­å®šã‚’ç½®ã„ã¦ã„ã¦ã€
<code>cron</code> ã® <code>@reboot</code> ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§èµ·å‹•ã—ç›´ã™ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>

<h2>ã¾ã¨ã‚</h2>

<p>èµ·å‹•æ™‚ã®å‡¦ç†ã¨ã„ã†ã“ã¨ã§ã€
å®Ÿé‹ç”¨ç’°å¢ƒã§ã¯æ¤œè¨¼ã—ã¥ã‚‰ãã€
å•é¡ŒãŒèµ·ãã¦ã‚‚ãƒã‚·ãƒ³ã®å†èµ·å‹•æ™‚ã«æ³¨æ„ã—ã¦ã„ã‚Œã°è‰¯ã„ã ã‘ãªã®ã§ã€
å„ªå…ˆåº¦ãŒä½ãã¦ã€
æ¤œè¨¼ç’°å¢ƒã‚’ç”¨æ„ã—ã¦ã¾ã§èª¿æŸ»ã™ã‚‹ã¨ã„ã†æ‰‹é–“ã‚’ã‹ã‘ã‚‹ã¾ã§ã¯å‡ºæ¥ã¦ã„ãªã„ã®ã§ã™ãŒã€
upstart ã¯ã„ã‚ã„ã‚ã¨ sysvinit (insserv) ã«æ¯”ã¹ã¦åŠ£åŒ–ã—ã¦ã„ã‚‹éƒ¨åˆ†ãŒã‚ã‚‹ã‚ˆã†ãªã®ã§ã€
å›°ã‚Šã¾ã™ã€‚</p>

<p>ä¸»æµãŒ systemd ã«å¤‰ã‚ã‚Šã¤ã¤ã‚ã‚‹ã¨ã„ã†è©±ã‚‚ã‚ã‚‹ã‚ˆã†ãªã®ã§ã€
ã©ã†ãªã£ã¦ã„ãã®ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ãŒã€
init ã¯ OS ã®æ ¹å¹¹ã«é–¢ã‚ã‚‹éƒ¨åˆ†ãªã®ã§ã€
ã‚‚ã£ã¨å®‰å®šã—ã¦ä¿¡é ¼æ€§ã®ã‚ã‚‹ã‚‚ã®ã«ãªã£ã¦ã»ã—ã„ã¨æ€ã„ã¾ã—ãŸã€‚</p>
]]></content>
  </entry>
  
</feed>
