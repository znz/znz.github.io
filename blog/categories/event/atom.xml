<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: event | @znz blog]]></title>
  <link href="http://blog.n-z.jp/blog/categories/event/atom.xml" rel="self"/>
  <link href="http://blog.n-z.jp/"/>
  <updated>2017-09-18T22:28:45+09:00</updated>
  <id>http://blog.n-z.jp/</id>
  <author>
    <name><![CDATA[Kazuhiro NISHIYAMA]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[RubyKaigi 2017 の1日目に参加しました]]></title>
    <link href="http://blog.n-z.jp/blog/2017-09-18-rubykaigi2017.html"/>
    <updated>2017-09-18T10:34:48+09:00</updated>
    <id>http://blog.n-z.jp/blog/rubykaigi2017</id>
    <content type="html"><![CDATA[<p><a href="http://rubykaigi.org/2017">RubyKaigi 2017</a> の1日目に参加したので、そのメモです。</p>

<!--more-->


<p>最初の方は個人的なメモなので、興味がなければ飛ばして、オープニング以降からどうぞ。</p>

<h2>移動と前夜祭</h2>

<p>土曜日に姫路に寄ってから、岡山県の実家に泊まっていて、日曜に台風の影響で11時ごろから岡山の在来線が止まるということで、その前に移動していたので、広島には問題なく到着していました。広島では10時ごろから在来線が止まっていたようでした。
午後は新幹線も広島より西で停電があった影響で遅れたり、博多と広島の間は止まったりしていたようです。</p>

<p>飛行機はだいたい止まっていたようで、東京からの人はさっさと新幹線に切り替えた人は問題なくたどり着けて、遅く新幹線に乗った人は遅れていて、前夜祭に間に合わなかったりしたようです。</p>

<p>前夜祭は、ホテルから移動している時に傘が壊れる (1本骨が曲がる) ということはありましたが、問題なくたどり着いて参加できました。
終わった後はほとんど雨は降っていませんでした。
Twitter のハッシュタグ <code>#rubykaigi</code> をみていると、会場準備をしていたスタッフの人で終わった後にきて、残っていたものを食べたりお土産をもらったりしていた人もいるようでした。</p>

<h2>朝の移動</h2>

<p>近くのホテルに泊まっていたので、開場前に会場につけるかと思っていたら、ちょっと準備に手間取ってしまって、結局9:40頃に到着しました。</p>

<h2>オープニング</h2>

<p>オープニングというか最初のキーセッションの前のつなぎとして、松田さんが会場アンケートしたりしていました。
初参加の人が意外と多かったようです。</p>

<h2>Ruby Forward</h2>

<ul>
<li>Money Forward によるスポンサーセッション</li>
<li>BtoC の新サービスを明日リリース予定</li>
<li>Ruby逆引きハンドブックの改訂版を出版(予定)</li>
<li>福岡の開発拠点を新設</li>
</ul>


<h2>Making Ruby? ゆるふわRuby生活</h2>

<ul>
<li>Heroku の matz team</li>
<li>日々の話</li>
<li>Repository は svn.ruby-lang.org がメインで github.com にはミラーがある</li>
<li>pull request は裏口</li>
<li>Why not Git?</li>
<li>ruby は Git より昔からあるから</li>
<li>作業する人がいない</li>
<li>個人的に hash がリビジョン番号の方が良い</li>
<li>コミッターにとっての利点不足</li>
<li>issue は redmine</li>
<li>開発者会議</li>
<li>tarball からのビルドの仕方: configure + make</li>
<li>Out-of-place build</li>
<li>configure に色々オプションがあったりいろんな環境をサポートしていたり</li>
<li>一度にビルドできる Makefile <a href="https://github.com/nobu/build-files/blob/master/Ruby.mk">https://github.com/nobu/build-files/blob/master/Ruby.mk</a></li>
<li>repo からのビルド</li>
<li>subversion or git / autoconf / bison / gperf / ruby</li>
<li>BASERUBY, MINIRUBY</li>
<li>トラブルによりすとうさんのサポート</li>
<li>MINIRUBY の機能や制限</li>
<li>2.4 までは miniruby と拡張ライブラリのビルドは parallel だったが、extconf.rb の実行が逐次実行だった</li>
<li>親にしか依存していないので 2.5 では exts.mk ファイルを分割生成して parallel に実行できるようになって速くなった</li>
<li>拡張ライブラリ作成時の問題点</li>
<li>C ヘッダーの場所とかが問題</li>
<li>Solution: <code>trace_var</code></li>
<li><code>$extmk</code>, <code>$ruby</code></li>
<li>? (突然の質疑応答タイム) → 特になし</li>
<li>Bug Report</li>
<li><a href="http://mla.n-z.jp/?ruby-list=50578">ruby-list:50578</a></li>
<li><code>p = 2; p (-1.3).abs</code> の話</li>
<li>スペースの有無によって意味ががらっと変わることがある</li>
<li>良くいって罠</li>
<li>少なくとも 1.1 からの仕様 (それより古いものはコンパイルが通らないので調べていない)</li>
<li>悪魔城 parse.y</li>
<li>難しくない?</li>
<li>ruby -w で警告が出るのでそのソースコード解説</li>
<li><code>EXPR_LABEL</code> はキーワード引数の名前が置けるところ</li>
<li><code>lvar_defined</code></li>
<li>matz issue</li>
<li>? 再び</li>
<li>literal symbol by intern</li>
<li><code>:"#{foo}"</code> が intern を再定義していると Symbol 以外になることがある</li>
<li>昨晩前夜祭の前に<a href="https://github.com/ruby/ruby/blob/d1e63172c6ecf2606ff9a947d917117eb6923436/parse.y#L7894-L7900">直した</a></li>
<li><a href="https://bugs.ruby-lang.org/issues/13812">Refinements で定義した to_s を String interpolation が呼んでくれない</a></li>
<li>.x86_64-darwin などをビルドディレクトリに使っている</li>
<li><code>.gitignore</code> に <code>.*-*</code> が入っている</li>
<li><code>make -C .x86_64-darwin exam commit</code></li>
<li>違い: 変換が明示的に見えるようにするのと見えないようにする</li>
<li>2.5 には目玉機能がない?</li>
<li>NEWS をみると色々</li>
<li>Reject された feature</li>
<li>議論中</li>
<li><code>Kernel#method</code> に対応する演算子?</li>
<li><p>Rightward assignment: <code>-&gt;</code> とか <code>=&gt;</code> とか使っているので良いものがない</p></li>
<li><p>質疑応答</p></li>
<li>extmk の分割の話で親子関係しか依存がないのを確認した? → digest が openssl に依存していた (チェックするためのメソッドを共有していた) のを切り分けた。 Windows で何かあったのを親子関係にした。実行時の依存ではなくビルド時の依存関係なのでもともと多くはなかった。</li>
<li>Rightward assignment の記号の提案 (:= が書籍では ← と書かれる言語があるので =: は?) → トークンの追加は衝突がなければ難しくない、<code>a=:b</code> がシンボルと衝突する。 <code>a ~&gt; b</code>, <code>a |&gt; b</code> ?</li>
<li><code>String#intern</code> を再定義する? → する人もいるらしいので、先手を打って直した</li>
<li>yield_self が目玉機能になる? → 機能としては長い間要望されていたものが、名前問題でなかなか入らなかった。とりあえず説明的な名前で入れて、良い名前があれば alias 追加すればいいという感じで入った。</li>
</ul>


<h2>Fiber in the 10th year</h2>

<ul>
<li>ささださんすごいとツイートしてほしい話</li>
<li>所属が変わっても基本的に ruby のコアの開発をしている</li>
<li>Fiber の紹介</li>
<li><p>Proc との違いは restart できる</p></li>
<li><p>Fiber の利用例</p></li>
<li>内部イテレーターを外部イテレータ〜にする例</li>
<li>Enumerator が内部で Fiber を使っている</li>
<li>Agent simulation : ゲームのキャラクター表現など</li>
<li><p>Non-blocking IO scheduler</p></li>
<li><p>Thread との違い</p></li>
<li>timer で自動で切り替わるかどうか</li>
<li>I/O ブロックで勝手に切り替わるかどうか</li>
<li>同期処理が必要かどうか</li>
<li>次のコンテキストを指定する必要があるかどうか</li>
<li><p>パフォーマンス</p></li>
<li><p>以上が Fiber の歴史</p></li>
<li><p>背景: Ruby 1.9 における Callcc と Fiber</p></li>
<li>2007/05 作り始め</li>
<li>Fiber の名前は Windows API から</li>
<li>今では他の言語でも Fiber という名前が使われているものがある</li>
<li><p>最初は <code>Fiber#pass</code> しかなかった</p></li>
<li><p>Coroutine or Semi-coroutine</p></li>
<li>Coroutine は難しいがパワフル</li>
<li>Semi-coroutine (Fiber) and Coroutine (Fiber::Core)</li>
<li>大クラス主義 (big class principle) を理由に Fiber::Core を削除してマージ</li>
<li><p>Semi-coroutine: resume, Coroutine: transfer</p></li>
<li><p>Fiber の実装</p></li>
<li>2007年: Copy machine stack</li>
<li>2010年: Use Native support</li>
<li>2017年: More light weight switching</li>
<li>速度: 5% 改善, メモリ: 30% 削減</li>
<li>VM stack や Machine stack があるので構造体のメモリ削減の影響は小さい?</li>
<li><p>Guild に繋げるための整理になった</p></li>
<li><p>Auto Fiber proposal</p></li>
<li>Automatic schedule on I/O blocking</li>
<li>次のターゲットを指定する必要がなくなる</li>
<li>同期が必要になる</li>
<li>利点: 既存のプログラムを変更する必要がない、Fiber 同様に軽い、Thread より安全</li>
<li><p>欠点: Thread と同様にバグりやすい</p></li>
<li><p>質疑応答</p></li>
<li>想定より多かった使い方は? → IO のスケジュールに使ってくれるのが想定より多かった。Enumerator が隠蔽するので直接使う人は少ないと思っていた。</li>
<li>アーキテクチャ依存やパフォーマンスで苦労したと思ったが、一番苦労した点は? → アーキテクチャ依存部分の最初は 1.8 を参考にしたので、ほとんど苦労しなかった。NetBSD の setcontext が動かなかったとかの話。</li>
</ul>


<h2>Handling mails on a text editor</h2>

<ul>
<li>通訳の方が Emacs を知らなかったので直前まで打ち合わせをしていた</li>
<li>自己紹介</li>
<li>Ruby で書いたテキストエディタ</li>
<li><a href="https://github.com/shugo/textbringer">Textbringer</a></li>
<li>Emacs 風</li>
<li>ターミナル上のみ</li>
<li>Pure Ruby</li>
<li>かっこいい名前</li>
<li>Law, Chaos, and Cosmic Balance</li>
<li>エディターだと <a href="https://twitter.com/ujm/status/909642340863688704">https://twitter.com/ujm/status/909642340863688704</a></li>
<li>コードの修正もたとえば rubocop を盲信するのではなくバランスが大事</li>
<li>キーバインディングは Emacs 風で help は少ないのでリンクからソースをみる</li>
<li>実装詳細</li>
<li>Linked Line ではなく Buffer Gap を採用</li>
<li>Internal encoding: UTF-8</li>
<li>indexing が問題になったので、基本的に ASCII-8BIT で持っておいて必要に応じて <code>force_encoding('UTF-8')</code></li>
<li>配列を使うのは文字列に変換するのが <code>force_encoding</code> だけより重そうだったので採用せず</li>
<li>部分再描画は curses 任せ</li>
<li>curses を使っているなら pure Ruby じゃないというツッコミがあった</li>
<li>動的な部分で ruby の特徴を活かせる</li>
<li><code>eval_expression</code></li>
<li><code>eval_buffer</code></li>
<li><code>eval_region</code></li>
<li>Suppress warnings : <code>$VERBOSE = nil</code></li>
<li><code>def</code> を使っていない理由</li>
<li>Plugin</li>
<li>Mournmail</li>
<li>MUAs for Emacs の話</li>
<li>Demo</li>
<li>メールの同期にバックグラウンド処理が必要になる</li>
<li>UI スレッドを用意した</li>
<li>UI スレッド以外では Textbringer のメソッドをよんではいけない</li>
<li>必要に応じて <code>next_tick</code> を使う</li>
<li>メールを扱うライブラリ: mail.gem, Net::IAMP</li>
<li>refine でローカルなモンキーパッチ</li>
<li>質疑応答</li>
<li>Auto Fiber? → 通訳さんとの打ち合わせで聞けていなかった。切り替わりのタイミングが想定できなくなるのは向いていないかも。</li>
<li>Emacs なのにS式がない? → Ruby で実装していて Emacs ではない</li>
<li>Emacs だと M-x だと <code>-</code> つながり? → Textbringer はタブを押すと <code>-</code> を <code>_</code> に変換する</li>
<li>名前空間の衝突は大丈夫? → 適切に prefix をつければいい</li>
</ul>


<h2>Gemification for Ruby 2.5/3.0</h2>

<ul>
<li>self.introduce</li>
<li>歴史: RAA, RubyForge, gems.github.com, gemcutter.org, rubygems.org, bundler</li>
<li>組み込みライブラリ: require しなくても使えるもの</li>
<li>標準添付ライブラリ: 別途インストールしなくても require できるもの</li>
<li>Standard Libraries, Default Gems, Bundled Gems</li>
<li>Pure Ruby, C extensions</li>
<li>Standard Libraries: upstream が svn.ruby-lang.org</li>
<li>Default Gems: Upstream が GitHub の Ruby team</li>
<li>Bundled Gems: メンテナが別</li>
<li>Default gem</li>
<li><code>*.gemspec</code> があると特別扱いされる</li>
<li>具体例: ruby/openssl</li>
<li>メインの upstream は <a href="https://github.com/ruby/openssl">https://github.com/ruby/openssl</a></li>
<li>利点: gem update openssl で新しい openssl gem を使える</li>
<li>セキュリティアップデートも、例えば最近の例なら json gem だけあげて ruby 本体をあげなくてもできる</li>
<li>psych : libyaml に依存、upstream に JRuby integration がある</li>
<li>rdoc: rdoc/rdoc から ruby/rdoc に移動</li>
<li>ripper 対応してくれた人が現れた</li>
<li>Bundled gems</li>
<li><code>gems/bundled_gems</code> にある gem を普通にインストールする</li>
<li>アンインストールも普通にできる</li>
<li>test framework の問題</li>
<li>test-unit, minitest が upstream と非互換になった</li>
<li>標準添付から外して本体のテスト専用に</li>
<li>test library がなくなるのは問題ということで bundled gem という方法が生み出された</li>
<li>rake は標準添付ライブラリでなくて良いのでは、ということで bundled gem になった例</li>
<li>bundled gem の問題</li>
<li>コンパイルがちゃんとできるかサポートできないので、拡張ライブラリを含むものはサポートしていない</li>
<li>bundled gem のテストが必要</li>
<li><a href="https://bugs.ruby-lang.org/issues/5481">Gemifying Ruby standard library</a></li>
<li>bundled gem や default gem の仕組みができたことで段階的に外していくことができるようになった</li>
<li>Gemification は利用者に利点は多いがメンテナは大変</li>
<li>たとえば rubygems はまだ Ruby 1.8 対応しているので大変</li>
<li>rubygems</li>
<li>rubygems/rubygems.org は rails で書かれているサイトそのもの</li>
<li>rubygems/rubygems はコマンドラインツール</li>
<li>メンテナなどは完全に別</li>
<li>Reserved words on rubygems.org</li>
<li>fileutils, fiddle, gdbm</li>
<li>Future</li>
<li>Ruby 2.5 では bundler が default gem に</li>
<li>RubyGems に Bundler 統合予定</li>
<li>全部 default gem, bundled gem にしたい</li>
<li>rubygems-2.7.0 がテストで bundler を使うようになる</li>
<li>bundler-2.0 のリリース後に rubygems-3.0 は本体でも bundler を使うように開発していく予定</li>
<li><a href="https://bugs.ruby-lang.org/issues/13847">Gem activated problem for default gems</a></li>
<li><a href="https://bugs.ruby-lang.org/issues/10320">require into module</a></li>
<li>shared library 問題, LOADED_FEATURES 問題</li>
</ul>


<h2>How to optimize Ruby internal</h2>

<ul>
<li>私用により途中から聞いていました。</li>
<li>細かい改善の話でした。</li>
<li>質疑応答</li>
<li>Hash の最適化で st_table を再利用するという案はなかったのか? → とりあえず想定していなかった? よく聞き取れず</li>
<li>聞き取れず → Ruby のメソッド一つ一つを計測してどうなったのかだけ</li>
<li>ベンチマークツール? → Apple 提供の可視化ツール</li>
<li>CI に回すのがどれくらいできそうか? → 1時間半ぐらいかかるが大丈夫か? グラフ表示したい。→ RubyBench が何か持っているかも。</li>
<li>どのくらい網羅しているかとか、みんなで追加すればいいのではないかとか → 発表が終わったのでオープンにしていきたい</li>
<li>ユーザーがカスタマイズする余地が消えたもの、壊す可能性が消えたものの見極めは? → 基本はテストが通るもの</li>
</ul>


<h2>Development of Data Science Ecosystem for Ruby</h2>

<ul>
<li>BigData is important in your business</li>
<li>RubyKaigi 2016 in Kyoto で Ruby が Data Science に使えない話とどうすれば良いかという話をした</li>
<li>今は使えるようになっている</li>
<li>将来も使える状態を維持していきたい</li>
<li>self.introduce</li>
<li>私はカエルです</li>
<li>現状</li>
<li>Ruby で書かれているものに追加したい場合</li>
<li>Ruby だけでやるか Python や R を JSON 経由で併用する方法があった</li>
<li>第3の選択肢として PyCall を作った</li>
<li>PyCall の話</li>
<li>使用例</li>
<li>数列の合計</li>
<li>bugs.ruby-lang.org の7月ごろのスナップショットをもらってデモ: ソースは <a href="https://github.com/mrkn/bugs-viewer-rk2017">https://github.com/mrkn/bugs-viewer-rk2017</a></li>
<li><code>Pandas.read_from_sql</code> は第二引数に ActiveRecord の connection を渡せるように拡張してある</li>
<li>Object recognition (物体検出) by Keras</li>
<li><a href="https://github.com/mrkn/ssd_keras">https://github.com/mrkn/ssd_keras</a></li>
<li>Python is a best friend of Ruby from now on</li>
<li><a href="https://github.com/mrkn/pycall.rb">https://github.com/mrkn/pycall.rb</a></li>
<li>Python での選択肢は Python のみか Rpy2 で R と連携の2個</li>
<li>今は PyCall を使えば良いが将来的には Ruby で</li>
<li><a href="https://red-data-tools.github.io/">https://red-data-tools.github.io/</a></li>
<li>Apache Arrow <a href="https://arrow.apache.org/">https://arrow.apache.org/</a></li>
<li>一つの言語で完結することは少ないので、データ交換が必要</li>
<li>シリアライズで結構 CPU 時間を使っている</li>
<li>シリアライズも組み合わせそれぞれから、共通化しようとしている</li>
<li><a href="https://github.com/red-data-tools/red-arrow">https://github.com/red-data-tools/red-arrow</a></li>
<li>Apache Arrow のコアメンバーにすとうさんが昨日入った</li>
<li><a href="https://gitter.im/red-data-tools/ja">https://gitter.im/red-data-tools/ja</a> <a href="https://gitter.im/red-data-tools/en">https://gitter.im/red-data-tools/en</a></li>
<li>明日の 13:50-15:50 in Room Ran で RubyData Workshop in RubyKaigi 2017</li>
<li>jupyter との連携は? → いい感じに使えている</li>
<li>Python のオブジェクトのメモリ管理と PyCall のオーバーヘッド → Ruby のオブジェクトが死んだ段階でデクリメントしている、オーバーヘッドは呼び出す処理による、 sin 関数などだとオーバーヘッドが大きいが numpy の行列計算などの重たい処理の場合はオーバーヘッドはあまり考えなくて良い</li>
<li>オブジェクトを変換しているか? → numpy のオブジェクトなどは変換していない、プリミティブは変換している</li>
</ul>


<h2>cookpad のスポンサーセッション</h2>

<ul>
<li>microservice 化でモデル数は減っている</li>
<li>なぜ Ruby <em>Committer</em> Sponsor ?</li>
<li>もっと良い言語が出てきたらどうするの? → Ruby を強くすれば良い</li>
<li>Ruby 3 に本気で向き合っている</li>
<li>cookpad &lt;&lt; mame</li>
</ul>


<h2>Ruby Committers vs the World</h2>

<p>コミッターなので壇上にいました。</p>

<ul>
<li>新コミッター紹介</li>
<li>rhe さん : openssl</li>
<li>k0kubun さん : ERB</li>
<li>watson さん : ちまちま速くするパッチを投げていたらコミッターになれた</li>
<li>質問のサンプルとして、型注釈の話</li>
<li>絶対書きたくない : 6人ぐらい</li>
<li>書かなくても良いが書くと良くなる : 多め</li>
<li>コメントぐらいなら良い (いざとなれば無視できる) : 多め</li>
<li>OpenMP みたいな感じ?</li>
<li>rdoc みたいなのがうれしい</li>
<li>古い処理系で無視されるといえば、すでにマジックコメントがある</li>
<li>現状だと動くものが型で制限されると嫌</li>
<li>matz: nominal type は絶対採用しない、String と書いても structal にしたい、できれば未来のためにプログラムの中に書くのは採用したくない、最低でもコメントに留めていたい</li>
<li>型を書かせたくないと思っているコミッター? → 4人ぐらい</li>
<li>Q(ujm): 右代入の本気度? →</li>
<li>akr: yield_self は右代入の代用の部分があるのではないか、左から右に流れるように書きたいことがあるのではないか</li>
<li>matz: 完全にフリーハンドであれば入れたい、長い歴史の中で記号を使い尽くしているので良い候補がない、既存のプログラムを壊れるような変更をしてまで入れるようなものではない</li>
<li>shyouhei: 他の言語では?</li>
<li>メモ取れず</li>
<li>durest: メソッドチェーンの話があったので、記号がなければメソッドでやってみるのはありではないか</li>
<li>会場を含めたアンケート</li>
<li>概念としてありは割といる</li>
<li>ないだろうはほとんどいない</li>
<li>Q(ujm): 変数とか定数とかどのあたりまでサポートするかという質問だった →</li>
<li>matz: 今代入の左辺になれるものは右代入でもサポートしたい</li>
<li>多重代入は難しい?</li>
<li>Q: YARV の命令仕様を確定して公開すると他の言語処理系が作れる? → 変化していくために固定する予定はないという感じ</li>
<li>他の案としては LLVM とか</li>
<li>Q: 右代入は <code>setter=</code> も対象? → matz: 当然</li>
<li>一番大変なのは parser</li>
<li>右代入で多重代入</li>
<li>後置 if との組み合わせ? → akr: 今の代入は式なのでできる、右代入は文にするというのはありかもしれない</li>
<li>機能制限するバージョンがあるか? → matz: ない、補助輪みたいなものは別のツールでサポートすれば良いのではないか</li>
<li>takao: 実際に使わせている子供達は補助輪を外したがっていたり、Ruby 認定資格を取りたがっていたりする場合もある</li>
<li>CI の実機が足りない問題は解決した? 今日の別の発表で Rails アプリケーションのベンチマークが取れるものが出てきている。Ruby 3x3 のユーザーからのフィードバックは何が必要? →</li>
<li>mame: 速くするパッチが必要 (watoson さんがやっているような)</li>
<li>以前 Mac の CI が足りないとか、ベンチマークが足りないとかいっていたが解決した? → matz: その件についてはだいぶ解決した</li>
<li>hsbt: CI 用のマシンは Ruby Association (RA) 経由である程度手配できるようになったが、 Windows の環境が足りない</li>
<li>Windows Server とか Visual Studio のライセンスを良い感じにする必要がある</li>
<li>matz: benchmark CI?</li>
<li>naruse: watson さんのが欲しい</li>
<li>ko1: RA や日本 Ruby の会経由で CI 用のマシンはなんとかなっている</li>
<li>さらにその上でベンチマークをなんとかしたい</li>
<li>RubyBench というのが何かやっている</li>
<li>watson: 今は個人のマシンで動かしている、自宅にはおきたくない、安定した結果が欲しいので実機が望ましい、足りないベンチマークを増やしたい</li>
<li>ko1: rails とか optcarrot とかだけではなく、これを速くして欲しいというのを提案して欲しい</li>
<li>matz: RA か日本 Ruby の会に寄付してくれると嬉しいが控除などはないのが申し訳ない</li>
<li>shyouhei: パッチを投稿していただくのはありがたいが、敷居が高いなら、雇って書かせるという手がある</li>
<li>Ruby 会議の運営を手伝ってもらえると、手が空いて間接的に、というのもある</li>
<li>hsbt: RubyKaigi 後に回復したら、パフォーマンスベンチを進めたい</li>
<li>matz: 転職活動している人?</li>
<li>ko1: 手があげられないのでは。</li>
<li>ko1: optcarrot と Rails 以外に使っている人?</li>
<li>shugo: テキストエディタが速くなると嬉しい、String が速くなるとうれしい</li>
<li>会場: fluentd</li>
<li>会場: puppet</li>
<li>amatsuda: ハッシュが速くなったので、fluentd が速くなったという話を聞いた</li>
<li>Q(ujm): Ruby, C, Streem, Emacs Lisp 以外に好きな言語?</li>
<li>matz: Swift, Clojure</li>
<li>mame: OCaml, Haskell?</li>
<li>takano: Smalltalk</li>
<li>akr: coq</li>
<li>nobu: FORTH</li>
<li>mrkn: julia</li>
<li>ko1: Ruby は好きだけど不満があるから直したい人が壇上には多いのでは</li>
<li>Q: インスピレーションの源になっているのは何?</li>
<li>matz: Lisp からたくさん、今後もたぶん、最近 2.0 の method prepend は CLOS のメソッドコンビネーション</li>
<li>takano: Lisp のマクロが羨ましい</li>
<li>mrkn: julia 推し</li>
<li><code>transform_keys</code> は Active Support (AS) と挙動は同じ? → nobu: 同じはず、<code>Hash#slice</code> も同様</li>
<li>amatsuda: 使い勝手は変わらないが、C実装になるのでちょっと速くなる</li>
<li>AS のようなものをどんどん入れる?</li>
<li>matz: 全部入れる気はないが、use case などでちゃんと説得してもらえば入る可能性はある、AS に入っているからという理由で入ることはない</li>
<li>amatsuda: AS は Web では便利だが、汎用的に入れるものかどうかは疑問</li>
<li>ko1: 年単位で議論して入ったものもある (入らなかったものもある)</li>
<li>amatsuda: 違う仕様で入ったものもある、 <code>Array#sum</code> とか</li>
<li>mrkn: Cで書くと float の誤差が改善されるということで、そういう実装が入った</li>
</ul>


<h2>懇親会</h2>

<p>食べ物の列は待っていれば短くなるかなと思って、話をしながら待っていたらそんなことはなかったので、並んでみたらギリギリ少し残っていたのが食べられて、その後で野菜が残っているのをみつけたのでそれを食べたりしていたので、全然食べられないということはなかったので、二次会には行きませんでした。</p>

<p>明日の懇親会と違って、オフィシャルパーティーはみんな集まっているので、複数人で話したいこと(<a href="https://bugs.ruby-lang.org/issues/13904">getter for original information of Enumerator</a>の件)は、この日のうちに話しておくべきだと思ったのですが、集められなかったので無理でした。後から確認したら、頑張って英語で書いたおかげで代わりにメンテナーを説得しようとしてくれる人がいて、結果的には大丈夫そうです。いいたかったのも、直接は関係がないので mrkn さんとかに説得を頑張って欲しいと言いたかっただけぐらいなので、明日以降に個別に言っておいても良いかもしれないと思いました。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[姫路IT系勉強会 2017.09 に参加しました]]></title>
    <link href="http://blog.n-z.jp/blog/2017-09-16-histudy.html"/>
    <updated>2017-09-16T13:40:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/histudy</id>
    <content type="html"><![CDATA[<p>RubyKaigi 2017 への移動途中に参加可能だったので、<a href="https://histudy.connpass.com/event/66084/">姫路IT系勉強会 2017.09</a>に参加しました。
公式の記録は勉強会のページからリンクされている HackMD のページ<!-- https://hackmd.io/s/r1rUBZF9Z -->に残っています。</p>

<!--more-->


<p>以下、メモです。</p>

<h2>会場</h2>

<p>iPod touch の connpass アプリの「マップで見る」でピンが表示されている場所に向かっている途中でさとうさんをみつけたので、一緒に行こうとしたら会場の建物の前だったようで、ピンが表示されていた場所はずれていたように思いました。</p>

<h2>自己紹介</h2>

<p>まずは connpass の参加者一覧を元に自己紹介でした。</p>

<h2>休憩</h2>

<h2>HTML の勉強方法</h2>

<ul>
<li>Hexo のテーマを作り始めたが HTML4 の頃の知識で止まっているので、モダンな HTML, CSS の勉強方法は?</li>
<li>初心者向けとかのサイトではなく、差分だけ知りたい</li>
<li><a href="https://caniuse.com/#search=flexbox">https://caniuse.com/#search=flexbox</a> とか</li>
<li>Hexo 界隈では sass ではなく Stylus がよく使われているらしい</li>
<li><a href="https://www.w3schools.com/cssref/css3_browsersupport.asp">https://www.w3schools.com/cssref/css3_browsersupport.asp</a></li>
<li>Bootstrap とかフレームワークはどうかという話</li>
<li>フルスタックなものと軽量なものを知っておくと良い?</li>
<li><a href="http://bourbon.io/">http://bourbon.io/</a> : 軽量な sass の mixin 集</li>
<li><a href="http://neat.bourbon.io/">http://neat.bourbon.io/</a> を組み合わせると grid system も使える</li>
<li><a href="http://bitters.bourbon.io/">http://bitters.bourbon.io/</a> だと基本的なスタイルまで付いている</li>
<li><a href="http://bourbon.io/docs/">http://bourbon.io/docs/</a> deprecated になっているものが多い</li>
<li>フルスタックが鬱陶しい人にはおすすめ</li>
<li>軽量なフレームワークで流行っているものはあまりない?</li>
<li>node の sass は ruby の sass とほぼ互換性があるらしい</li>
<li>node に限らないが独自作法が大変な話</li>
<li>プラグインアーキテクチャが流行っているらしい</li>
<li>ruby は PHP などに比べて非互換がきついことがある</li>
<li>node はタスクランナー周りのものがたくさんあってメンテナンスされなくなってきて、npm 直接使うことが多くなっている</li>
<li>Web 界隈は色々とカオス</li>
<li>作った後、ちゃんと更新されていないものがきつい</li>
<li>awesome から github を辿っていって使うと少しまし <a href="https://github.com/sindresorhus/awesome">https://github.com/sindresorhus/awesome</a></li>
<li>CentOS とか古いので wpscan でチェックすると色々言われる?</li>
</ul>


<h2>WordPress の話</h2>

<ul>
<li>なぜか話が来たが、情報が少なくてよくわからず</li>
<li>とりあえず WordPress の情報が集まっている場所は?</li>
<li>まず WordBench がおすすめ</li>
<li>おすすめプラグイン</li>
<li>WordPressプラグイン100選 の目次から良さそうなプラグインを探す</li>
<li>パーミッションをちゃんとしよう</li>
<li>関連する話が先週の<a href="https://histudy.connpass.com/event/66082/">加古川IT系インフラ勉強会 2017.09</a>であったらしい</li>
<li>困ったら金で解決という手段もある</li>
</ul>


<h2>Markdown の話</h2>

<ul>
<li>途中抜けているところがあっても手順書があるだけまし</li>
</ul>


<h2>女子中学生チケット詐欺事件</h2>

<ul>
<li><a href="https://gist.github.com/shunirr/2bd6a5a00b966e1e534b443790c68eda">女子中学生チケット詐欺事件</a> (オリジナル)</li>
<li><a href="https://gist.github.com/kawabata/fefd78b84856ed7900c69eb9aba3af19">女子中学生チケット詐欺事件</a> (詳しい fork 版)</li>
</ul>


<h2>Markdown の話</h2>

<ul>
<li>話が戻って発表</li>
<li><a href="https://gitpitch.com/sky-y/himeji-it-2017-09">Markdownのカオスと付き合う</a> (発表資料)</li>
<li><a href="https://bitjourney.kibe.la/shared/entries/f740d533-0d57-44fe-a891-dfe669d16121">Markdownはなぜ拡張され続けるのか</a> は一読をおすすめ</li>
<li><a href="https://babelmark.github.io/?text=%40__gfx__">https://babelmark.github.io/?text=%40__gfx__</a> が strong になることがある問題</li>
<li>Markdown きつい問題 → 根本的な解決策はない</li>
<li>他の軽量マークアップ言語: reST など以外にも Ruby の RD や Perl の POD なども昔からある</li>
<li>表現力が高いマークアップ言語はなかなか流行らない: SGML vs HTML など (XHTML → HTML5 とか)</li>
<li>無難な記法: CommonMark か GFM (GitHub Flavored Markdown) がおすすめ</li>
<li><code>#</code> の後ろにスペースを入れた方が良いなど、標準的な書き方を覚えておけば方言に対応しやすい</li>
<li><a href="http://commonmark.org/help/">http://commonmark.org/help/</a> が基本</li>
<li>改行の扱い <a href="https://babelmark.github.io/?text=abc%0Adef%0A%0Aghi%0Ajkl">https://babelmark.github.io/?text=abc%0Adef%0A%0Aghi%0Ajkl</a> 連続の改行で p が分割されて単独の改行は br になったりならなかったり</li>
<li>改行の扱いは CommonMark と GFM で違う</li>
<li>ASCII Art などなら code block を使えば良い</li>
<li>表現力の高いものから低いものに変換するとゴミ (HTML 断片) が入ったりする</li>
<li><p>CSV から Markdown? : pandoc のフィルターにあるかも</p></li>
<li><p>org-mode から HTML にエクスポートで使っている話</p></li>
<li><p>markdown にエクスポートもできるらしい</p></li>
<li><p>ドキュメントを書くことを普及させたい</p></li>
<li><p>同じ名前なのが混乱の元?</p></li>
<li>継承して拡張とかできるので別の名前をつけるのも難しそう</li>
<li>CommonMark で統一しようとしている</li>
<li><p>GFM も参考になる</p></li>
<li><p>Markdown は英語圏のメールなどの文章を書く時の一般的な作法が元になっているらしい</p></li>
<li><p>最低限のドキュメントは書きましょうという話</p></li>
<li>ansible とか terraform とか</li>
<li>Jupyter</li>
</ul>


<h2>休憩</h2>

<p>15:50 まで</p>

<h2>Perl の Acme::EyeDrops</h2>

<ul>
<li>デモ</li>
<li>プログラム解説</li>
<li>改行と空白削除</li>
<li>文ごとに改行追加</li>
<li>などなど順番に変更していってプログラム解説</li>
<li>ビット演算とか Web 系の人はしらなさそう</li>
<li>カラーコードで16進数は知ってそうだが、ビット演算はしらなさそう</li>
<li>ビット演算を知らないとパーミッションとかもわからなさそう</li>
<li><code>(?{...})</code> は Perl 5.18 から <code>use re "eval"</code> が必要になっている</li>
</ul>


<h2>BlueBorne</h2>

<ul>
<li>Android で Bluetooth テザリングを便利に使っていたのに使えなくなった</li>
<li>カーナビはアップデートとかできなさそうなので厳しい</li>
<li>車はエンジン系とエンタメ系のエンタメ系しか Bluetooth で繋がらないので問題があったとしても大丈夫?</li>
<li>CAN という規格 (認証とかがない) でエンジン系と通信ができるので可能性はある?</li>
<li>iOS は大丈夫だったので iPhone で Bluetooth イヤホンとか使ってる人は大丈夫</li>
<li>サーバーは関係なさそう</li>
</ul>


<h2>これから未来ある開発言語またはシステムは?</h2>

<ul>
<li>言語は教養として全然違うものを勉強するのが良いのではないか。 Prolog とか PostScript とか SQL とか</li>
<li>仕事という面では PHP がとりあえずわかれば Web 担当になれる</li>
<li>WordPress をカスタマイズする時とか PHP が必須になる</li>
<li>機械学習なら Python になりそう</li>
<li>未来はわからないので直近を考える</li>
<li>JavaScript が作れるものの幅が一番広い</li>
<li>大穴狙いなら COBOL?</li>
<li>COBOL のプログラムはまだなくなりそうにない</li>
<li>Ruby のようにコミュニティの雰囲気が良いという観点で選ぶのもあり (元々楽しくプログラミングという基本思想があるので、それが影響しているのかコミュニティの雰囲気が良い)</li>
<li>この勉強会はなんでもありなので、派生したものを作るのは歓迎</li>
</ul>


<h2>HoloLens とかの話</h2>

<ul>
<li>HoloLens は完全に視界をおおう VR ではなく、現実世界にホログラムを載せるようなもの</li>
<li>最近は WinMR というのもあるらしい</li>
<li>HoloLens は Windows 10</li>
<li>Edge も VR に対応しているらしい</li>
<li>開発環境とかは?</li>
<li>Unity</li>
<li>ユニバーサル Windows プラットフォーム (UWP)</li>
<li>Unreal Engine</li>
<li>まずは企業向けで使われるようになる?</li>
<li>研究は長い間されていたが、やっと実用化されるようになってきた</li>
<li>脆弱性対策の話</li>
<li>VR アプリのデバッグ</li>
<li>通常の Windows アプリとしてのデバッグ</li>
<li>体験のデバッグ</li>
<li>酔う対策は、まだ知見が足りない</li>
</ul>


<h2>Lisp 入門?</h2>

<ul>
<li>ふわっとした理由で Lisp を勉強したいということだったので色々紹介的な話</li>
<li>Lisp-1 と Lisp-2</li>
<li>Scheme と Common Lisp</li>
<li>コンパクトなのが Scheme</li>
<li>なんでもありなのが Common Lisp</li>
<li>Common Lisp HyperSpec</li>
<li>一番有名な処理系が sbcl</li>
<li>clisp, Clozure CL</li>
<li>Gauche</li>
</ul>


<h2>退出</h2>

<p>17時を過ぎても続いていて、移動しないと間に合わなくなりそうだったので、Lisp の話の途中で出ました。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[第11回 HosCon - GMO Hosting Conference - @大阪 に参加しました]]></title>
    <link href="http://blog.n-z.jp/blog/2017-09-14-hoscon.html"/>
    <updated>2017-09-14T22:46:24+09:00</updated>
    <id>http://blog.n-z.jp/blog/hoscon</id>
    <content type="html"><![CDATA[<p><a href="https://gmohoscon.connpass.com/event/63440/">第11回 HosCon - GMO Hosting Conference - @大阪</a> に参加したので、そのメモです。</p>

<!--more-->


<h2>会場</h2>

<p>グランフロントタワー B の 梅田・GMO Yours での開催でした。
前に何かの勉強会で一度来たことがあるような気がするのですが、何だったか思い出せませんでした。</p>

<p>タワー B 自体は最近 Rails Developers Meetup #4 大阪会場 で来ていました。</p>

<h2>その他</h2>

<p>ハッシュタグは <code>#hoscon</code> でしたが、ツイートはあまりありませんでした。</p>

<p><a href="https://twitter.com/rzl5/status/908276901914882049">https://twitter.com/rzl5/status/908276901914882049</a> に写真がありますが、 ConoHa カードをもらったので、使ってみたいと思いました。</p>

<h2>コンテナ基盤であるLXC/LXDを本番環境で運用する話</h2>

<ul>
<li>2011年に物理からKVMによる完全仮想化へ</li>
<li>完全仮想化はリソースに無駄があるということで準仮想化、コンテナ化へ</li>
<li>なぜLXDか?</li>
<li>他に検討した選択肢は Docker, KVM, OpenVZ, (VMware は高いので選択肢に入らず)</li>
<li>質問: Linux だけで Windows や BSD はなかった? カーネルモジュールなども問題なかった? → Linux で、カスタマイズはしていたが共通の kernel だったので問題なく集約できた。</li>
<li>質問: OpenVZ が遅かった? → 一般的には遅くないかもしれないが、試した環境ではコンテナより遅かった。</li>
<li>LXDは2017年2月から運用開始</li>
<li>ホストOSは Ubuntu 16.04 LTS</li>
<li>ゲストOSは使い慣れたCentOS</li>
<li>なぜZFSか?　→ 公式がオススメしているのとベンチマークの結果がよかった</li>
<li>今も苦労している部分はある</li>
<li>fio で計測</li>
<li>ZFS を採用した理由: 機能性、柔軟性, 比較対象: lvm, dir</li>
<li>ホストシステム構築時のトラブル</li>
<li>オープンファイル数の上限など色々な上限に引っかかった</li>
<li>ネットワーク編</li>
<li>NIC の MAC アドレスがかぶっていた</li>
<li>LXD 運用編</li>
<li>Apache RLimitNPROC にひっかかった</li>
<li>ホストのロードアベレージが急激に上昇 → ZFS がボトルネックだったのでチューニングを実施 (ZFS ARC?)</li>
<li>2ラック (KVM) → 1ラック (LXD)</li>
<li>質問タイム</li>
<li>LXD で新しくサービスできるようになったことはある? → 新たなサービスはないが、快適なディスクIOを提供できている</li>
<li>まだリリースできていないが、準専有の基盤ができた</li>
<li>ZFS はメモリをたくさん使って残りがユーザーの領域? → ご想像にお任せします</li>
<li>どのようなところで運用負荷の軽減? 運用でカバーしているところ? → 物理が減ったので楽になった。リソースの制限の自動化を目標に手動でやっている。物理より柔軟にできるのが良い。</li>
<li>ライブマイグレーションをしているかどうか? → やっていない。今後対応していく。</li>
<li>内製でコントロールパネルのようなものを作っている? → ない。全部コマンドで。</li>
<li>CentOS? → 既存のノウハウをいかすために選んだ。</li>
<li>OS のアップデートはどうしている? → カーネル以外は通常のアップデート</li>
<li>ホスト側のリソース監視はしていると思うが、コンテナ側はどうしている? → 緩めの limit を設定してる</li>
<li>PHP などのバージョン違い? → 問い合わせで個別に対応することもある</li>
<li>サポートが終了したものはなるべく引き継がない</li>
<li>CentOS 6? 7? → 7</li>
</ul>


<h2>休憩</h2>

<p><!-- 20:12 から? -->20:16 まで</p>

<h2>ロリポップ！マネージドクラウド FastContainerの裏側</h2>

<ul>
<li>ロリポップ！マネージドクラウドは FastContainer アーキテクチャを採用していて、コンテナエンジンに haconiwa</li>
<li>質問: 価格? → 価格についてはまだ未定</li>
<li>オートスケール</li>
<li>質問: 何をもってマネージド? → コンテナの起動の仕方が特殊 (FastContainer) で、完全に root 権限があるわけではないなど</li>
<li>質問: データベース? → データベースはコンテナで動いていないので、オートスケールではない</li>
<li>質問: オートスケールは php だけ? → apache + php</li>
<li>質問: データベースがオートスケールではないのなら、ユーザーごとのリソース制御? → まだ未確定</li>
<li>質問: 具体的にアクセスが増えると、とは? → 実際は CPU のスロットルタイムをみているので、CPU の負荷が高くなれば。</li>
<li>逆に負荷が下がればコンテナを減らす。</li>
<li>質問: ユーザーごとのリソースの分割? 他のユーザーの影響は受けるのか? → 基本的には影響は受けない。リソースは分離している。ホスト自体が重くなっても負荷分散できるアーキテクチャになっている。</li>
<li>FastContainer とは?</li>
<li>FastCGI のコンテナ版といったイメージ</li>
<li>リクエスト契機で Web アプリのコンテナが起動</li>
<li><p>一度起動したコンテナはその後しばらく使い回して、一定時間が経過したら終了</p></li>
<li><p>利点</p></li>
<li>オートスケール</li>
<li>リクエストがないと停止するのでリソースの節約</li>
<li>いろんなコンテナで色々なアプリを提供</li>
<li>常に最新</li>
<li><p>他のマシンへの載せ替えも楽</p></li>
<li><p>マネージドクラウドの構成</p></li>
<li>CMDB というところでコンテナの情報を管理</li>
<li>質問: 構成が速度に影響があるか? → ある。今は動くものを優先。 nfs が重いというのは多方面から突っ込まれている</li>
<li>質問: 起動していない時と起動している時のパフォーマンスの差? → 確かにたちがっていない状態のアクセスは時間がかかる。調整中</li>
<li>質問: どこが大きくなっていく? compute? → 今のところ compute と datapool が増えるのを想定している。</li>
<li>パフォーマンスは調整していく段階なので、今後機会があれば。</li>
<li>ngx_mruby</li>
<li>haconiwa</li>
<li>コンテナ</li>
<li>基本は1コンテナに1プロセス</li>
<li>ssh も sshd コンテナ経由</li>
<li>FastContainer リクエスト制御フロー</li>
<li>質問 → 今はチューニングがすんでいないので初回は 2,3 秒ぐらいかかる</li>
<li>質問 → ユーザーが予約枠を設定していて、そこまでしか上がらないようにしている</li>
<li><p>予約枠は金額で設定できるようにしたい</p></li>
<li><p>コンテナの死</p></li>
<li>コンテナの寿命: lifetime が設定されていて一定時間経過で自動停止</li>
<li>なぜ寿命?</li>
<li>リソースの節約</li>
<li>新しくなるタイミングでライブラリなども更新されてセキュア</li>
<li>別ホストに移行したい時も CMDB をいじるだけ</li>
<li>compute のメンテも簡単</li>
<li><p>質問: リクエストが有る限り死なない? → lifetime で死ぬ</p></li>
<li><p>オートスケール</p></li>
<li>haconiwa が cgroup から各コンテナの CPU, I/O 負荷を計測・監視</li>
<li>ユーザーはコンテナの予約枠を設定可能</li>
<li>スケールインは CMDB の変更だけで停止は自動停止任せ</li>
<li><p>予約枠を取るだけでオートスケール</p></li>
<li><p>コンテナの種類も増やしていきたい</p></li>
<li><p>質問タイム</p></li>
<li>予約枠? パケット量をみる? → 設計中。基本的には使ったぶんだけ課金する予定?</li>
<li>コンテナのサーバー自体が高負荷になったり物理的な障害が起きても自動でフェイルオーバー? → 自動ではできていない。手動でのせかえることはできる。自動化は可能ではある。</li>
<li>SSL 証明書? Symantec のような台数分の場合とか → あとで</li>
<li>オートスケールをする監視をしている間隔? → 暫定で1秒</li>
<li>オートスケールの課金の指標は? ニュースで取り上げられる予定だから、とか。 → 設計中</li>
<li>聞き逃し</li>
<li>WAN の IP は共有? → 共有</li>
<li>コンテナはドメインでみている</li>
<li>IP アドレス単位で他のユーザーの影響は受ける可能性がある</li>
<li>現状 CMDB はデータベースのフェイルオーバー任せなので、そこが止まると止まる可能性はある</li>
<li>のせるアプリの開発環境? → 将来的には用意したい</li>
<li>聞き逃し → コンテナ単位でどのくらいパフォーマンスが出ているかだそうとか色々話はある</li>
</ul>


<h2>懇親会</h2>

<p>5分休憩の後で懇親会でした。</p>

<h2>感想</h2>

<p>LXD を採用したという話自体は以前に別の勉強会で聞いたことがあったので、それと重複した話もありましたが、もっと技術的につっこんだ話も聞けておもしろかったです。</p>

<p>LXD は他では使っているという話を聞いたことがないので、使っている人はもっと情報を出してくれればいいのに、という気がしています。
個人的には、情報がなくて探しても何もわからないよりは、Docker のように情報がたくさんあって玉石混交で、自分で見極めないといけない、という状態の方が望ましいです。</p>

<p>マネージドクラウドの話は haconiwa って作ってみたというようなものじゃなくて、ちゃんと実用的に使うためのものだったのかというのが驚きました。
FastContainer は用途があえば良さそうな感じなので、機会があれば使ってみたいと思いました。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LILO&東海道らぐオフラインミーティング 2017/08/27 に参加しました]]></title>
    <link href="http://blog.n-z.jp/blog/2017-08-27-lilo-tokaidolug.html"/>
    <updated>2017-08-27T13:33:33+09:00</updated>
    <id>http://blog.n-z.jp/blog/lilo-tokaidolug</id>
    <content type="html"><![CDATA[<p><a href="https://lilo.connpass.com/event/64381/">LILO&amp;東海道らぐオフラインミーティング 2017/08/27</a> に参加しました。</p>

<p>今回もアンカンファレンス形式でした。</p>

<!--more-->


<h2>メモ</h2>

<ul>
<li>会場はいつもの 4 階でした。</li>
<li>ハッシュタグ: <code>#lilo_jp</code> <code>#東海道らぐ</code></li>
<li>登録参加者数 12名</li>
<li>自己紹介から</li>
<li>最初の発表は発表者の希望により非公開</li>
<li>途中からきた人は発表の合間に随時自己紹介</li>
</ul>


<h2>自分の発表</h2>

<ul>
<li>自分の lilo.linux.or.jp の話</li>
<li>発表資料に入れていなかった部分については以下の通り</li>
<li>OGP を入れたきっかけは <a href="https://togetter.com/li/1107707">LILO&amp;東海道らぐオフラインミーティング 2017/05/06の記録 - Togetterまとめ</a> で connpass だけ概要と画像が出ていたため</li>
<li><a href="https://developers.facebook.com/tools/debug/">Open Graph Debugger - Developers Facebook</a> (Facebook アカウントがないと使えない?) は OGP がなくても自動検出した内容で埋められるため、本当に反映されるかどうかの確認には使えなかった覚えがあります</li>
<li><a href="https://ja.osdn.net/projects/clamav-jp/lists/archive/users/2017-August/000280.html">[clamav-jp 281] ウィルスDB更新の異常について（解決済）</a></li>
<li><a href="http://qiita.com/ttdoda/items/f16422d709e264cbb8a1">Postfix 2.12 の compatibility_level</a></li>
<li>dokuwiki は <a href="https://bugs.debian.org/854592">#854592 dokuwiki: Unable to login, missing usr/share/php/Crypt/AES.php</a> で消えていた</li>
</ul>


<h2>休憩</h2>

<h2>GPD-Pocket に Ubuntu 17.04 をインストールした話</h2>

<ul>
<li>東海道らぐ四日市 11/25</li>
<li>GPD-Pocket でも Ubuntu 17.04 が動いた</li>
<li>Kernel 4.13RC + Intel Graphics Driver OSS + 蓋開閉</li>
<li>色々な条件で試してNGだったが、偶然蓋を開けたら画面がうつった</li>
<li>ATOM はバニラカーネルの時点でバグがあるらしい</li>
</ul>


<h2>Fireduck OS</h2>

<ul>
<li>東海道LUG有志によるLinuxディストリビューションプロジェクト</li>
<li>○○焼き → Fire duck (あひる焼き)</li>
<li>タブレット向け</li>
<li><a href="https://github.com/TokaidoLUG/fireduckos">https://github.com/TokaidoLUG/fireduckos</a></li>
<li>アーキテクチャ説明</li>
<li>悩み事</li>
<li>journald が起動したプロセスの出力をファイルに書き込むので重い</li>
<li>OSM のアプリ?</li>
<li>UEFI32 向けに 64 bit 環境で 32 bit 向けのビルドが必要なので multilib を使った</li>
<li><a href="https://github.com/TokaidoLUG/meta-intel-mobile">https://github.com/TokaidoLUG/meta-intel-mobile</a></li>
<li><a href="https://github.com/TokaidoLUG">Tokaido Linux User Group</a></li>
<li>欲しいアプリの話</li>
<li>資料は <a href="https://www.slideshare.net/wata2ki">https://www.slideshare.net/wata2ki</a> に公開予定</li>
</ul>


<h2>休憩</h2>

<ul>
<li>懇親会参加者の確認</li>
</ul>


<h2>つなぎの発表</h2>

<ul>
<li>オープンソースカンファレンス広島の紹介</li>
<li>Allwinner タブレットの実演</li>
<li>firefox を動かして、ネットワークが繋がっていないので about:mozilla とか about:robots とか</li>
</ul>


<h2>State of the Map 2017 に行ってきたよ</h2>

<ul>
<li>Open Street Map の国際会議</li>
<li>日本で国際会議をやるのは珍しい</li>
<li>会津若松市は LibreOffice を使っているので、ついでに話を聞きに行った</li>
<li>写真を見ながら色々な話</li>
<li>Maps With Me というアプリが便利らしい</li>
</ul>


<h2>最後の話</h2>

<p>プロジェクターに映らなかったので、集まって話をきいていました。</p>

<h2>クロージング</h2>

<ul>
<li>今後の予定など</li>
<li>会場費は学生以外が 100 円でした。</li>
</ul>


<h2>発表した内容</h2>

<p>スライドはいつも通り <a href="http://slide.rabbit-shocker.org/authors/znz/lilo-20170827/">Rabbit Slide Show</a> (<a href="https://rubygems.org/gems/rabbit-slide-znz-lilo-20170827">RubyGems</a>), <a href="https://slideshare.net/znzjp/lilolinuxorjp-20178">SlideShare</a>, <a href="https://speakerdeck.com/u/znz/p/lilo-dot-linux-dot-or-dot-jp-falsehua-2017nian-8yue">Speaker Deck</a> にあげています。(ソースは <a href="https://github.com/znz/lilo-20170827">github</a> にあげています。)</p>

<iframe src="https://slide.rabbit-shocker.org/authors/znz/lilo-20170827/viewer.html"
        width="640" height="524"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        scrolling="no"
        style="border: 1px solid #ccc; border-width: 1px 1px 0; margin-bottom: 5px"
        allowfullscreen> </iframe>


<div style="margin-bottom: 5px">
  <a href="https://slide.rabbit-shocker.org/authors/znz/lilo-20170827/" title="lilo.linux.or.jp の話 (2017年8月)">lilo.linux.or.jp の話 (2017年8月)</a>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[第30回シェル芸勉強会　大阪サテライト＠さくらインターネット大阪本社に午後から参加しました]]></title>
    <link href="http://blog.n-z.jp/blog/2017-08-26-usptomo-osaka.html"/>
    <updated>2017-08-26T13:00:00+09:00</updated>
    <id>http://blog.n-z.jp/blog/usptomo-osaka</id>
    <content type="html"><![CDATA[<p><a href="https://atnd.org/events/90102">第30回シェル芸勉強会　大阪サテライト＠さくらインターネット大阪本社</a>に午後から参加しました。</p>

<!--more-->


<h2>会場</h2>

<p>最近よくいっているグランフロントタワーAのさくらインターネットさんでしたが、今回は初めて部屋の中の方に参加しました。</p>

<h2>第30回シェル芸勉強会</h2>

<p>問題は <a href="https://blog.ueda.tech/?p=10188">【問題のみ】jus共催 第30回危念シェル芸勉強会</a> にあります。</p>

<p>主に macOS の環境で確認しました。</p>

<h3>Q1</h3>

<ul>
<li><code>awk '/^Keywords:/{print FILENAME ":" $0;nextfile}' posts/*/*.md</code> としてみた。</li>
<li>nextfile などを調べていたら時間がかかってしまってあまりちゃんとできず。</li>
<li>ファイル名部分のパスなどの掃除が必要と気づいてなかったのでできていなかった。</li>
<li>解答例では <code>grep -m 1</code> を使っていたけど、 macOS の grep (BSD grep) 2.5.1-FreeBSD だと動作が違うようで、最初のファイルで止まってしまって、うまく動かなかった。</li>
</ul>


<p>macOS Sierra 10.12.6 の例:</p>

<pre><code>% grep --version
grep (BSD grep) 2.5.1-FreeBSD
% grep -m 1 : /etc/passwd /etc/group
/etc/passwd:nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false
</code></pre>

<p>Debian GNU/Linux 9.1 (stretch) の例:</p>

<pre><code>$ grep --version
grep (GNU grep) 2.27
Copyright (C) 2016 Free Software Foundation, Inc.
ライセンス GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

作者 Mike Haertel および その他の方々は &lt;http://git.sv.gnu.org/cgit/grep.git/tree/AUTHORS&gt; を参照してください。
$ grep -m 1 : /etc/passwd /etc/group
/etc/passwd:root:x:0:0:root:/root:/bin/bash
/etc/group:root:x:0:
</code></pre>

<h3>Q2</h3>

<ul>
<li><code>perl -pe 's,(href|src)="(?!http|/)(\./)?,$1="/files/,g' url.html</code></li>
<li><code>(?!)</code> を使いたかったので Perl で。</li>
<li>最初に試しに書いたのはゆるすぎていらないところにつきまくっていた。</li>
<li>正規表現が緩いと charset の属性まで変換してしまうという罠があった。</li>
<li>気にせず置き換えてあとで <code>/files/http://</code> などになった場合に戻すという方針の人が多かった。</li>
</ul>


<h3>Q3</h3>

<ul>
<li><code>&lt; list | awk 'BEGIN{print "...";print "..."};/^\* /{print "&lt;li&gt;" $2 "&lt;/li&gt;"};END{print "...";print "..."}'</code></li>
<li>前後の部分の内容を省略するとこんな感じになった。</li>
<li><code>cat list | pandoc -t html5 -s</code> して削るという手もありらしい</li>
<li>Web サーバーにするには list.html の内容だけではなく <code>HTTP/1.1 200 OK</code> の行も追加する必要があった</li>
</ul>


<h3>Q4</h3>

<ul>
<li>hub コマンドを使ってよかったらしい</li>
<li>がんばって API をたたくのもありっぽい</li>
</ul>


<h3>Q5</h3>

<ul>
<li><code>sed -e 's/[ *]//g' -e '1s/^/p /' -e '$!s/$/*/' complex | ruby</code> はかっこ不足だった。(複素数リテラルが優先されると思ってしまっていた。)</li>
<li><code>sed -e 's/[ *]//g' -e '1s/^/p (/' -e '$!s/$/)*(/' -e '$s/$/)/' complex | ruby</code> でうまくいった。</li>
<li>別解として1行ごとに解釈して inject してみた : <code>ruby -e 'p ARGF.each_line.map{|s|eval(s.gsub(/(?&lt;!\d)i/,"1i"))}.inject(:*)' complex</code></li>
</ul>


<h3>Q6</h3>

<ul>
<li>真面目に計算すると <code>ruby -e 'a=[1,1];f=-&gt;(n){a[n]||=f[n-1]+f[n-2]};1.step{|n|if f[n]==6765;p f[n-4];exit;end}'</code> になった。</li>
<li>自分で計算せずに出そうとすると <code>curl https://en.wikipedia.org/wiki/Fibonacci_number | grep -B4 6765 | head -n 1 | grep -Eo '[[:digit:]]+'</code> になった。英語版 Wikipedia を使っているのは URL が短くてわかりやすいからで、日本語版 Wikipedia の URL でも可能でした。</li>
<li>最初、curl のダウンロード状況出力の右に隠れてしまって1行見落としていて <code>grep -B5</code> にしてしまっていましたが、 <code>grep -B4</code> でした。</li>
</ul>


<h3>Q7</h3>

<ul>
<li>zsh の組み込みのみで <code>for n in {00..99}; [[ -z ${(FM)"$(&lt; nums)":#*$n*} ]] &amp;&amp; echo $n</code></li>
<li>解説は <a href="/blog/2014-12-11-zsh-grep.html">zshでgrepのようなことをする</a> を参照</li>
<li>シーケンスは <code>seq -w 0 99</code> とか <code>{0..9}{0..9}</code> とか</li>
<li><code>{00..99}</code> は bash 3 だとダメそうだった。 (0 1 &hellip; になった)</li>
<li><code>grep -o ..</code> は <code>echo 1234 | grep -o ..</code> で 23 が出てこないのでダメ</li>
<li><code>echo 1234 | sed p | sed '1s/.//' | grep -o ..</code> のようにする</li>
<li>解答例: <code>cat nums | sed p | sed '1s/.//' | grep -o .. | cat - &lt;(seq -w 0 99) | sort | uniq -u</code></li>
<li>fold -w 2 とかこういう時に使ってみると良さそうなコマンドは色々あるっぽい</li>
</ul>


<h3>Q8</h3>

<ul>
<li>問題 差し替え <a href="https://twitter.com/ryuichiueda/status/901330659527897088">https://twitter.com/ryuichiueda/status/901330659527897088</a></li>
<li><code>ruby -e 'ARGF.each_line.map{|s|[(s[2].ord-s[0].ord).abs,s]}.max[1].display' alphabet</code></li>
<li><code>z-v</code> という逆順のところも考慮して abs を入れたけどいらなかったかもしれない。</li>
<li>別解で36進数を使ってみた: <code>ruby -e 'ARGF.each_line.map{|s|[eval(s.gsub(/\w+/){$&amp;.to_i(36)}).abs,s]}.max[1].display' alphabet</code></li>
<li>abs の代わりにソートして引くという方法もあるらしい</li>
<li><code>map</code> + <code>max[1]</code> でシュワルツ変換的なことをしなくても <code>max_by</code> でよかったらしい</li>
<li>解答例は bash のブレース展開を使っていた</li>
<li>xxd で変換して計算する解答例も紹介されていた</li>
</ul>


<h2>午後の部終了</h2>

<p>午後の部まで参加の人はここで帰っていました。</p>

<h2>LT 大会</h2>

<p>LT は中継はどうなるんだろうと思っていたら、大阪は大阪で LT をしていました。</p>

<h3>シェル芸思考</h3>

<ul>
<li><a href="https://www.slideshare.net/kunst1080/30lt">第30回シェル芸勉強会LT シェル芸思考</a></li>
<li>問題を解く時にどう考えているのか</li>
<li>1: コマンド一撃でオプションを知っていればすぐにできるようなものかどうか考える</li>
<li>終わりそうにない場合続きを考える</li>
<li>2: 中間データの形式を設計する</li>
<li>3: コマンドを組み合わせて解いていく</li>
<li>メインは 2</li>
<li>設計の考え方</li>
<li>形について考える</li>
<li>例: <a href="https://togetter.com/li/1041621">【ファン迷惑】「響け！ユーフォニアム」という文字列だけで遊ぶシェル芸人達</a></li>
<li>中間データ1: 11回繰り返す</li>
<li>中間データ2: 11文字で折り返す</li>
<li>中間データ3: 10文字で切り出す</li>
</ul>


<h3>FORK 爆弾爆発中のロードアベレージを見る</h3>

<ul>
<li><a href="https://speakerdeck.com/msr_i386/cgroup">https://speakerdeck.com/msr_i386/cgroup</a></li>
<li>前回 SysRq でクラッシュさせてカーネルダンプで見た</li>
<li>今回 実行中にみたい</li>
<li>uptime コマンド, w コマンド, top コマンド, カーネルダンプの解析</li>
<li>カーネルダンプは1回のみでリアルタイムは無理</li>
<li>uptime, w は起動できない</li>
<li>top は反応が止まるので無理</li>
<li>cgroup で制御: cpuset を 0-2 と memory を 1GB に制限</li>
<li>root:bash に制限</li>
<li>forkbomb というグループを用意する</li>
<li>仮想4コア, メモリ16GB の VM でデモ</li>
<li>bash はランダムに kill されるのでデフォルトシェルを zsh にしておいて zsh から bash を起動</li>
<li>キーボード配列がおかしかったのでメモ帳で入力して貼り付けしたら zsh で実行してしまう事故発生</li>
<li>VM 再起動待ち</li>
<li>今度はちゃんと bash で実行</li>
<li>メモリ 1GB だと 11700 個ぐらい bash が起動している</li>
<li>ロードアベレージは 10000 を超えていた</li>
<li>cgconfig.conf は CentOS 7 では非推奨で systemd 経由で使うようになっている</li>
</ul>


<h3>破壊的難読化シェル芸</h3>

<ul>
<li>難読化シェル芸</li>
<li>置換による難読化はあまりにも弱い</li>
<li>難読化シェル芸には新たな武器が必要</li>
<li>武器っぽいコマンド gunzip (ガンジップ)</li>
<li>gun(銃)が弱いわけがない</li>
<li>gzip -cf</li>
<li>入力できない</li>
<li>xxd を通す</li>
<li>xxd -r -p | gunzip</li>
<li>別のアプローチ</li>
<li>gunzip の代わりに cut と組み合わせる</li>
<li>いろいろ探してみつけた例を実行</li>
</ul>


<h3>AWS API リクエストへの署名</h3>

<ul>
<li>REST API</li>
<li>リクエストに access key と secret access key で署名する必要がある</li>
<li>署名バージョン4: AWS4-HMAC-SHA256</li>
<li>署名のテストスイートも公開されている</li>
<li>署名のプロセスをシェル芸で追いかける</li>
<li>CLI / SDK に存在しない API がある: Amazon RDS / DownloadCompleteDBLogFile</li>
<li>CLI / SDK にあるのは download-db-log-file-portion のみで分割ダウンロードされる</li>
<li>例に使うのは AWS IAM / ListUsers</li>
<li>例に使う時刻も固定しておく</li>
<li>署名作成手順の説明</li>
</ul>

]]></content>
  </entry>
  
</feed>
