---
layout: post
title: "slideshareからのメールが届かなかったのでなんとかした"
date: 2014-01-26 22:07:01 +0900
comments: true
categories: mail
---
spam 対策にひっかかって `slideshare.net` からのメールが届いていなかったので、回避策をとって受け取れるようになったという話です。

<!--more-->

## 背景

spam 対策の手段のひとつとして、メールアドレスのドメインに MX レコードだけ設定して A レコードは設定しないという方法があります。

この方法はまともな MTA を使っている送信元なら MX レコードを見てくれるので問題は起きないはずです。

そして、まともでない MTA だと A レコードがみつからないということで送信できずに諦めているのではないかと思います。
その場合はこちらには全くログが残らないので、本当はどういう状況なのかはわからないので、推測しかできません。

メールサーバーのログを `tail -F /var/log/mail.log` で確認しながら `slideshare.net` の確認メールの再送を何度押してもログに出なかったので、もしかしてこの spam 対策にひっかかっているのではないかと推測しました。

## 対処

MX レコードの他に A レコードを追加するという設定はしたくなかったので、
`/etc/postfix/main.cf` の `mydestination` に設定していて
A レコードが存在するサブドメインをメールアドレスのドメインとして
`slideshare.net` のメールアドレスに設定しました。

その結果、確認メールをやっと受け取ることができました。

## まとめ

世界中で使われているようなサービスでも、まともにメール送信できないようなところが存在するようです。

受信側としては Gmail のように IPv6 でも逆引き必須にしているような特殊な設定をしているところもありますが、
Gmail のように利用者が多いところだと送信側が気付きやすいので、対応していることが多いような気がします。

困った時は Gmail などの利用者が多いドメインのメールアドレスを使って送信側の問題かどうか切り分けるというのも有効だと思います。
